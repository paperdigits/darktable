<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE dita
  PUBLIC "-//OASIS//DTD DITA Composite//EN" "../../../../dtd/ditabase.dtd">
<dita>
   <topic xml:lang="en-us" id="darkroom_chapter">
      <title>Darkroom</title>
      
      <prolog>
         
         
         
         
         
         
         <metadata>
            
            
            <keywords>
               <keyword>darkroom</keyword>
               <keyword>view</keyword>
               <indexterm>darkroom</indexterm>
            </keywords>
            
            
         </metadata>
         
      </prolog>
      <body>
         <p>
    The darkroom view is where you develop your image.
  </p>
         <fig id="fig_lxw_kwk_2lb">
            <title>The darkroom view</title>
            <image href="../images/darkroom_view.png" placement="break" id="image_mxw_kwk_2lb"/>
         </fig>
      </body>
      <topic xml:lang="en-us" id="darkroom_overview">
         <title>Overview</title>
         <body>
            <p>
      Darkroom mode is for photographic development of the image that you selected from the
      lighttable. Numerous tools, named modules, are available for processing that image.
    </p>
            <p>
      On the left hand side you have navigation, snapshot, history stack, color picker, tagging,
      image information and mask manager panels, described in <xref href="#darkroom_panels"/>.
      In the right hand panel you can see the histogram and a list of modules available for
      working with the image. At the bottom of the right hand panel you can enable/disable the
      view of individual modules.
    </p>
            <p> You can use <i>middle-click</i> to <indexterm>zoom</indexterm> 1:1. A double
                  <i>middle-click</i> takes you to 2:1. Alternatively you can zoom in and out
               between 1:1 and fit-to-screen by mouse scrolling. Mouse scrolling while holding the
               control key pressed gives an extended zoom range between 2:1 and 1:10. </p>
            <p>
      You normally export multiple images from the lighttable view but you can also export the
      current image directly from the darkroom by using the shortcut
      <i>Ctrl+E</i>. Export parameters are then those currently selected in the
      lighttable.
    </p>
         </body>
         
      </topic>
      <topic xml:lang="en-us" id="darkroom_concepts">
         <title>Darkroom concepts</title>
         <body>
            <p>
    This section tries to explain some of the basic concepts on how darktable develops images in
    the darkroom.
  </p>
            <p>
    The basic element of an image operation in darktable is called a module. darktable comes
    with a rich set of over 60 modules for all kind of image manipulations. In
    <xref href="#modules"/> you will find a description for each of the available modules.
  </p>
         </body>
         <topic xml:lang="en-us" id="pixelpipe">
            <title>Pixelpipe, module order, and history stack</title>
            
            <prolog>
               <metadata>
                  <keywords>
                     <indexterm>pixelpipe</indexterm>
                     <indexterm>module processing order</indexterm>
                     <indexterm>history stack</indexterm>
                  </keywords>
               </metadata>
               
            </prolog>
            <body>
               <p>
    darktable processes images – from input to output – in a so called
    <q>pixelpipe</q>. Within the pixelpipe image processing consists of consecutive
    operations which are implemented as <q>modules</q>.
  </p>
               <p>
    Modules are applied in a fixed order. This differentiates darktable, as a non-destructive
    image editor, from classical image manipulation programs like GIMP. As module order is
    fixed, you are free to activate, deactivate or change the parameters of a module at
    arbitrary points in time; the order of activation in your workflow does not have any impact
    on the outcome.
  </p>
               <p>
    Users frequently ask why the module order is fixed and if there are plans to change that
    restriction. There are several reasons why darktable works in the way described:
    <ul>
                     <li>
                        <p>
        The sequence of modules has been selected with great care in order go give highest
        output quality. Changes to the sequence would generally worsen the result rather than
        improving it.
      </p>
                     </li>
                     <li>
                        <p>
        Certain image processing steps just don't make sense if they are shifted in the
        pixelpipe. To mention just a few: highlight reconstruction needs to be done on raw data
        before demosaicing and the demosaic step needs to be performed before any input color
        profile can be applied.
      </p>
                     </li>
                     <li>
                        <p>
        Most of darktable's modules are designed to work within a specific color model (see
        <xref href="#color_management"/> for more details). Full flexibility would require
        modules to support different parallel algorithms depending on the color space they are
        working in – this would drastically increase complexity.
      </p>
                     </li>
                  </ul>
    That said, the fixed sequence of modules is not likely to change in the near future.
  </p>
               <p>
    Whenever you activate or deactivate a module or go back to a module and change the
    parameters, this adds an item on top of the <q>history stack</q>.
  </p>
               <p>
    For example, when working on a raw file, the history stack on the left panel might say that
    you first enabled <xref href="#denoise_bilateral">
                     <i>bilateral
    filtering</i>
                  </xref>, then disabled <xref href="#base_curve">
                     <i>base
    curve</i>
                  </xref>, then adjusted <xref href="#whitebalance">
                     <i>white
    balance</i>
                  </xref>. But at any time, the processing took the raw image, adjusted
    <xref href="#whitebalance">
                     <i>white balance</i>
                  </xref> on it, then
    <xref href="#demosaic">
                     <i>demosaic</i>
                  </xref>, then
    <xref href="#base_curve">
                     <i>base curve</i>
                  </xref> (if enabled), then
    <xref href="#denoise_bilateral">
                     <i>bilateral filtering</i>
                  </xref> (if
    enabled), as shown bottom to top on the right panel.
  </p>
               <p>
    The history stack records your workflow in the order in which you made changes to the
    pipeline. It allows you to go back to an earlier stage of development if needed. The history
    stack represents your personal workflow and is not to be confused with the sequence in which
    modules are applied in the pixelpipe (see above). For more details on the history stack see
    <xref href="#history"/>.
  </p>
            </body>
            
         </topic>
         <topic xml:lang="en-us" id="interacting">
            <title>Interacting with modules</title>
            
            <prolog>
               <metadata>
                  <keywords>
                     <indexterm>module usage</indexterm>
                  </keywords>
               </metadata>
               
            </prolog>
            <body>
               <p>
    A module has an expander bar
    <image href="../images/darkroom_module_expander.png" align="center"/>
    . Clicking on the name of the module expands the module's GUI with all parameters.
  </p>
               <p>
    In its default setting darktable will only expand one GUI at a time. If you click the
    expander bar of another module, the previous GUI gets collapsed. If you want to see more
    than one GUI expanded, you may expand further modules with <i>Shift+click</i>
     – all previously expanded GUIs remain opened. The expander bar behavior on
    <i>click</i> and <i>Shift+click</i>, respectively, is controlled
    by a preference setting in GUI options (see <xref href="gui_options"/>).
  </p>
               <p>
    Expanding a module does <i>not</i> activate it. You need to click the
    <image href="../images/darkroom_module_icon_enable.png" align="center"/>
    icon to turn a module on or off.
  </p>
               <p>
    Icon
    <image href="../images/darkroom_module_icon_presets.png" align="center"/>
    accesses the module's available presets or creates a new preset from your current settings
    (see <xref href="#module_presets"/>).
  </p>
               <p>
    The
    <image href="../images/darkroom_module_icon_reset.png" align="center"/>
    icon is used to reset the module parameters to their default values.
  </p>
               <p>
    Many of darktable's modules can have multiple instances, each with different settings. Click
    on the
    <image href="../images/darkroom_module_icon_instances.png" align="center"/>
    icon to generate new instances and control existing ones (see
    <xref href="#multiple_instances"/>).
  </p>
               <p>
    The most frequently used control elements of modules are sliders, comboboxes and curves.
  </p>
            </body>
            <topic xml:lang="en-us" id="interacting_sliders">
               <title>Sliders</title>
               
               <prolog>
                  <metadata>
                     <keywords>
                        <indexterm>module usage<indexterm>sliders</indexterm></indexterm>
                        <indexterm>sliders</indexterm>
                     </keywords>
                  </metadata>
                  
               </prolog>
               <body>
                  <p>
      Sliders offer five different ways of interaction, depending on the level of control you
      need.
    </p>
                  <ol>
                     <li> Left-click <p> Click anywhere in the slider area to set the value. You can
                           also click and drag to change it. You don't have to aim for the small
                           triangle or even the line, the whole height including the label works as
                           the active area. </p></li>
                     <li> Mouse wheel <p> Hover over any place on the slider with your mouse, then
                           use your mouse wheel to adjust the value step by step. </p></li>
                     <li> Keyboard arrow keys <p> When the slider has keyboard focus you can hover
                           over any place on the slider with your mouse, then use your keyboard's
                           arrow keys (←/↓ and →/↑) to adjust the value stepwise. In order to give
                           focus to the widget without changing the current value you can
                           right-click, then right-click again. </p></li>
                     <li> Right-click <p> When your mouse is over a slider right-click gives you a
                           multi-functional pop-up below the slider for fine control with your mouse
                           or numerical entry using the keyboard. </p><table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="2">
                              <colspec colwidth="6*"/>
                              <colspec colwidth="4*"/>
                              <tbody>
                                 <row>
                                    <entry> darktable's innovative input method: for both coarse and
                                       fine value adjustments in a single control element combined
                                       with keyboard input. </entry>
                                    <entry>
                                       <image href="images/darkroom_bauhaus.png"
                                          align="center" placement="break"/>
                                    </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table><p> A bent line extending from the triangular marker moves as you
                           move your mouse. The closer your mouse pointer is to the triangular
                           marker the coarser the control; the further away from the triangular
                           marker the finer is your control. Left-click with your mouse to accept
                           the new value and go back to normal control. </p><p> Alternatively you
                           can type in a new value using your keyboard and commit by hitting the
                           enter key. You may even supply the new value in the form of an arithmetic
                           expressions which darktable will calculate for you – the old value is
                           referenced as <q>x</q>. </p></li>
                     <li>
                        <p>
        Double-click
      </p>

                        <p>
        You can double-click on a parameter label to reset its value to default.
      </p>
                     </li>
                  </ol>
                  <p>
      Additionally, the mouse wheel and keyboard arrow keys support two input modifiers:
      <ul>
                        <li> You can hold down the <i>Shift</i> key increasing the stepsize by a
                           factor of 10. You can change this multiplier:
                           <pre>darkroom/ui/scale_rough_step_multiplier=10.0
</pre>
                        </li>
                        <li> You can hold <i>Ctrl</i> key decreasing the stepsize by a factor of 10.
                           You can change this multiplier:
                           <pre>darkroom/ui/scale_precise_step_multiplier=0.1
</pre>
                        </li>
                     </ul>
                  </p>
               </body>
               
            </topic>
            <topic xml:lang="en-us" id="interacting_comboboxes">
               <title>Comboboxes</title>
               
               <prolog>
                  <metadata>
                     <keywords>
                        <indexterm>module usage<indexterm>comboboxes</indexterm></indexterm>
                        <indexterm>comboboxes</indexterm>
                     </keywords>
                  </metadata>
                  
               </prolog>
               <body>
                  <p>
      Clicking on a combobox will open a list of available options. Click on the item you want
      to select. Sometimes the selection list opens close to the bottom or top of the screen and
      only part of the items are visible; scroll with your mouse wheel to bring up the full
      list. Alternatively, you can also use the mouse wheel and keyboard arrow keys to select an
      option.
    </p>
               </body>
               
            </topic>
            <topic xml:lang="en-us" id="interacting_curves">
               <title>Curves</title>
               <body>
                  <p>
      Some modules are controlled by adjusting curves. More detail is given later in this
      chapter when the respective modules are explained.
    </p>
               </body>
               
            </topic>
            <topic xml:lang="en-us" id="interacting_undo_redo">
               <title>Undo/redo</title>
               
               <prolog>
                  <metadata>
                     <keywords>
                        <indexterm>undo</indexterm>
                        <indexterm>redo</indexterm>
                     </keywords>
                  </metadata>
                  
               </prolog>
               <body>
                  <p>
      During editing darktable records all changes made in the history (see
      <xref href="#history"/>). This includes modifications of any parameter in a module
      itself but also if a module instance is added or removed. Thanks to this recording it is
      possible to undo changes or redo them to recover a previous editing state. Note that this
      undo/redo facility is unlimited in the number of steps while editing an image but it is
      reset each time the darkroom is switched to a new image.
    </p>
                  <p>
      The default key shortcuts are:
      <ul>
                        <li>
                           <p>
                              <i>Ctrl+Z</i> : undo last history modification
        </p>
                        </li>
                        <li>
                           <p>
                              <i>Ctrl+Y</i> : redo last undo (does nothing if undo has not been used
          yet)
        </p>
                        </li>
                     </ul>
                  </p>
               </body>
               
            </topic>
         </topic>
         <topic xml:lang="en-us" id="module_presets">
            <title>Module presets</title>
            
            <prolog>
               <metadata>
                  <keywords>
                     <indexterm>presets<indexterm>module presets</indexterm></indexterm>
                     <indexterm>module presets</indexterm>
                  </keywords>
               </metadata>
               
            </prolog>
            <body>
               <p>
    Presets are stored configurations for a module's parameters. Some modules already have
    internal pre-defined presets but you can also define your own. Both internal and
    user-defined presets are displayed by clicking the
    <image href="../images/darkroom_module_icon_presets.png" align="center"/>
    icon with the currently activated preset shown in bold text.
  </p>
               <p>
    The preset system also supports automatic preset selection based on image data such as focal
    length, ISO, camera model and other fields.
  </p>
               <p>
    As a convenience, a preset can be applied to a new module instance by pressing the
    middle-click.
  </p>
            </body>
            <topic xml:lang="en-us" id="module_presets_new">
               <title>Creating a new preset</title>
               <body>
                  <p>
      First configure the module's parameters then click the
      <image href="../images/darkroom_module_icon_presets.png" align="center"/>
      icon and select <q>store new preset</q>. The following dialog will be shown for
      configuring the preset:
    </p>
                  <p>
                     <image href="concepts/images/new_preset.png"
                            align="center"
                            placement="break"/>
                  </p>
                  <p>
      The first two fields are used to name and describe the preset.
    </p>
                  <p>
      In the example above we have also checked the auto apply option. This brings up additional
      selection fields where you can define a filter used to decide if the preset should be
      automatically applied when opening other similar images in darkroom for the first time.
      The example dialog above sets up following rules: if lens name matches and aperture is
      greater or equal to f/8 and focal length is between 24 and 35mm the preset will be
      automatically applied. Also the second checkbox is clicked so this preset will only be
      shown in the preset list if the image matches the rule.
    </p>
                  <p>
      darktable finds this data in your image's Exif information. If you want a preset to be
      applied to all images from a specific camera leave all fields at default values except for
      the model field.
    </p>
                  <p>
      Tip: The <i>image information</i> panel for your image displays your model
      name, use this to ensure you have the correct spelling (see
      <xref href="image_information"/>).
    </p>
               </body>
               
            </topic>
            <topic xml:lang="en-us" id="module_presets_managing">
               <title>Managing Presets</title>
               <body>
                  <p>
      Both user created and pre-defined presets can be viewed and managed from within the
      presets menu (<xref href="presets"/>) in the preferences dialog (see
      <xref href="preferences_chapter"/>).
    </p>
               </body>
               
            </topic>
         </topic>
         <topic xml:lang="en-us" id="multiple_instances">
            <title>Multiple instances</title>
            
            <prolog>
               <metadata>
                  <keywords>
                     <indexterm>multiple instances</indexterm>
                  </keywords>
               </metadata>
               
            </prolog>
            <body>
               <p>
    Many of darktable's modules can be applied multiple times. Each instance of that module
    behaves like any other module, taking its input from the module below in the pixelpipe
    delivering its output to the module above.
  </p>
            </body>
            <topic xml:lang="en-us" id="multiple_instances_use_cases">
               <title>Typical use cases</title>
               <body>
                  <p>
      There are many occasions where it makes sense to have an operation act more than once in
      the pixelpipe. Here are a few use cases.
    </p>
                  <ul>
                     <li>
                        <p>
        Most of our modules are highly versatile and depending on parameters can deliver quite
        varying effects. For example the <i>fill light</i> module
        (<xref href="#fill_light"/>) allows local modification of lightness based on pixel
        values. You might want to do two lightness corrections in your image at the same
        time – one for dark tones and another one for lighter tones.
      </p>
                     </li>
                     <li>
                        <p>
        You might want to apply a denoising module like <i>denoise (profile)</i>
        (<xref href="#denoise_profiled"/>) with two different parameter sets. One to do luma
        denoising and another set of parameters to do chroma denoising. You could do so by
        generating two instances and use the first one only on luma by selecting blend mode
        <q>lightness</q> and use the second one just for chroma by selecting blend mode
        <q>color</q> (see <xref href="#blending_operators"/>).
      </p>
                     </li>
                     <li>
                        <p>
        In an even more elaborate case you could have a module act on different parts of your
        image. As an example you might want to apply a certain gradation curve with module
        <i>tone curve</i> (<xref href="#tone_curve"/>) to your complete image
        and have a second curve being applied specifically to skin tones. All of the controls
        offered by <i>drawn masks</i> (<xref href="#drawn_mask"/>) and
        <i>parametric masks</i> (<xref href="#parametric_mask"/>) may be used to
        select those parts of an image where each of the module instances are applied.
      </p>
                     </li>
                  </ul>
                  <p>
      Please be aware that of course each instance also adds to the workload of your pixelpipe.
      Generating too many instances – especially of the more demanding
      modules – will certainly cause some noticeable slow-down.
    </p>
               </body>
               
            </topic>
            <topic xml:lang="en-us" id="multiple_instances_managing">
               <title>Managing instances</title>
               <body>
                  <table frame="none">
                     <tgroup colsep="0" rowsep="0" cols="2">
                        <colspec colwidth="6*"/>
                        <colspec colwidth="4*"/>
                        
                        <tbody>
                           <row>
                              <entry>
              When clicking on the
              <image href="../images/darkroom_module_icon_instances.png" align="center"/>
              icon a drop-down menu will appear.
            </entry>
                              <entry>
                                 <image href="concepts/images/instances.png"
                                        align="center"
                                        placement="break"/>
                              </entry>
                           </row>
                        </tbody>
                     </tgroup>
                  </table>
                  <p>
      Selecting <q>new instance</q> generates a new module instance above any existing
      ones. All parameters are set to default values. The new instance gets its own complete set
      of GUI controls and a number appended to the base module name for distinction.
    </p>
                  <p>
      Selecting <q>duplicate instance</q> behaves in a similar way. The only difference:
      the new instance will inherit all parameter settings from its parent.
    </p>
                  <p>
      darktable applies all modules in a defined order according to their type. Therefore all
      instances of a particular module will occur together in the pixelpipe. You can however
      decide on the relative order in which the different instances of a module are applied by
      selecting <q>move up</q> or <q>move down</q> to shift the position of the
      instance among its peers.
    </p>
                  <p>
      To delete an instance just press <q>delete</q> from the drop-down menu.
    </p>
                  <p>
      An instance can have any name without influencing the edits. To change the name use the
      <q>rename</q> option. See <xref href="history_stack"/> for more details on how
      the instance name impacts copying and pasting history stacks.
    </p>
               </body>
               
            </topic>
         </topic>
         <topic xml:lang="en-us" id="blending">
            <title>Blending</title>
            
            <prolog>
               <metadata>
                  <keywords>
                     <indexterm>blending</indexterm>
                  </keywords>
               </metadata>
               
            </prolog>
            <topic xml:lang="en-us" id="blending_overview">
               <title>Overview</title>
               <body>
                  <p>
      By default a module takes its input from the preceding module, performs its calculations
      and hands its output over to the next module in the pixelpipe. On demand you can
      activate an additional step where a module's output is reprocessed with its input before
      giving the result to the next module. This additional processing step is called blending.
      Input and output can be processed with different algorithms, called blending operators or
      blend modes.
    </p>
                  <p>
      Each blend mode is further controlled by a parameter called opacity, which can have a
      value between 0% and 100% and defines how input and output image contribute to the final
      result. Typically an opacity value of 0% gives as a result an image that is identical to
      the input image – the module remains without effect. An opacity value of 100%
      delivers the maximum effect of the module with the blend mode chosen.
    </p>
                  <p>
      The opacity value can be the same for all image pixels. In this case blending acts
      uniformily on the image. Alternatively you can make opacity values to vary between
      different image locations or pixel values. This is called a mask and gives fine control
      over what parts of an image are affected by a module and to what extent. At your choice
      you may activate a drawn mask or a parametric mask or a combination of both.
    </p>
               </body>
               
            </topic>
            <topic xml:lang="en-us" id="blending_usage">
               <title>Usage</title>
               <body>
                  <table frame="none">
                     <tgroup colsep="0" rowsep="0" cols="2">
                        <colspec colwidth="6*"/>
                        <colspec colwidth="4*"/>
                        
                        <tbody>
                           <row>
                              <entry>
              Modules with blending support exhibit an additional combobox <q>blend</q>
              at the bottom of their GUI.
            </entry>
                              <entry>
                                 <image href="concepts/images/blending.png"
                                        align="center"
                                        placement="break"/>
                              </entry>
                           </row>
                        </tbody>
                     </tgroup>
                  </table>
               </body>
               <topic xml:lang="en-us" id="blending_usage_blend">
                  <title>blend</title>
                  <body>
                     <p>
        Blending is activated with this combobox. Depending on the value selected additional
        control elements will show up.
      </p>
                  </body>
                  <topic xml:lang="en-us" id="blending_usage_off">
                     <title>off</title>
                     <body>
                        <p>
          module's output is passed to the next module in pixelpipe without additional
          reprocessing. No further controls are displayed.
        </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="blending_usage_uniform">
                     <title>uniformily</title>
                     <body>
                        <p>
          reprocessing takes place with the chosen blend mode and opacity value – the
          same for all pixels. Additional controls to select blend mode and opacity value are
          displayed. The default blend mode is <q>normal</q> with an opacity of 100%.
        </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="blending_usage_drawn_mask">
                     <title>drawn mask</title>
                     <body>
                        <p>
          reprocessing takes place with the chosen blend mode and opacity. Additional controls
          are displayed which allow you to draw a mask. If no mask elements are drawn all pixels
          have the same opacity, defined by the opacity slider. If you draw a mask element, e.g.
          a circle, the inner area of the circle will get maximum opacity, surrounded by a
          transition area or border with a gradual decay of opacity and the remaining image with
          an opacity of 0%. Different graphical shapes can be used. See
          <xref href="#drawn_mask"/> for further details.
        </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="blending_usage_parametric_mask">
                     <title>parametric mask</title>
                     <body>
                        <p>
          reprocessing takes place with the chosen blend mode and opacity. Additional controls
          are displayed which allow you to adjust the opacity on a per-pixel basis determined by
          pixel values. In previous versions of darktable this was called <q>conditional
          blending</q>. See <xref href="#parametric_mask"/> for further details.
        </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="blending_usage_drawn_parametric_mask">
                     <title>drawn and parametric mask</title>
                     <body>
                        <p>
          this option combines drawn and parametric masks and shows the full set of both
          controls. See <xref href="#combined_masks"/> to learn how to best use this
          combination.
        </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="blending_examples">
               <title>Examples</title>
               <topic xml:lang="en-us" id="blending_examples_texturing">
                  <title>Texturing an image</title>
                  <body>
                     <p>
        The watermark module supports SVG files with embedded images that can be used as a
        texture source. Blending operators then allow control of how that texture is expressed.
      </p>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="blending_examples_gritty_details">
                  <title>Gritty details</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
                When blending operators were introduced into darktable, a new module named
                <i>highpass</i> (see <xref href="#highpass"/>) was added. It
                provides a highpass filter of the image to be implicitly used with blending. It
                is used to produce a gritty detailed image and is a method widely used in the
                workflow of other imaging software.
              </entry>
                                 <entry>
                                    <image href="concepts/images/blendop_highpass.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                     <p>
                        <table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="2">
                              <colspec colwidth="4*"/>
                              <colspec colwidth="6*"/>
                              
                              <tbody>
                                 <row>
                                    <entry>
                                       <image href="concepts/images/blendop_highpass_ex1_1.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                                       <p>
                    This is the original image, pretty heavily processed: first
                    <xref href="#monochrome"> 
                                             <i>monochrome</i>
                                          </xref>, then
                    some blue <xref href="#splittoning">
                                             <i>split-toning</i>
                                          </xref> but as you see it lacks pop in
                    details and is a bit out of focus...
                  </p>
                                    </entry>
                                 </row>
                                 <row>
                                    <entry>
                                       <image href="concepts/images/blendop_highpass_ex1_2.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                                       <p>
                    Here we applied the highpass filter with the values shown above. You can now
                    see that the details are greatly boosted and we now have a really gritty
                    detailed image.
                  </p>
                                    </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table>
                     </p>
                  </body>
                  
               </topic>
            </topic>
            <topic xml:lang="en-us" id="blending_operators">
               <title>Blending operators</title>
               
               <prolog>
                  <metadata>
                     <keywords>
                        <indexterm>blending operators</indexterm>
                     </keywords>
                  </metadata>
                  
               </prolog>
               <body>
                  <p>
    There are several blend modes implemented and more might be added in future. For now all of
    the most commonly used ones are included and you will recognize a few of them from other
    imaging software. A good introduction on many common blend modes is given in the
    <xref href="http://docs.gimp.org/2.8/en/gimp-concepts-layer-modes.html"
                           format="html"
                           scope="external"> 
                        <i>GIMP
    Manual (Chapter 8.2, <q>Layer Modes</q>)</i>
                     </xref>. Therefore we only
    discuss a few blend modes here in more detail.
  </p>
               </body>
               <topic xml:lang="en-us" id="blending_operators_modes">
                  <title>blend modes</title>
                  <topic xml:lang="en-us" id="blending_operators_modes_normal">
                     <title>normal</title>
                     <body>
                        <p>
        This will probably be the most used blend mode. It just mixes input and output and,
        depending on the opacity value, it reduces the strength of a module's effect. Generally
        this is also the blend mode of choice if you want to apply a module's effect locally
        using masks.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="blending_operators_modes_bounded">
                     <title>normal bounded</title>
                     <body>
                        <p>
        This blend mode acts similarly to blend mode <q>normal</q>, except that input
        and output data are clamped to a particular min/max value range. Out-of-range values are
        effectively blocked and do not pass to the following modules. Sometimes this helps to
        prevent artifacts. However, in most cases (e.g. highly color saturated extreme
        highlights) it is better to let unbound values travel through the pixelpipe in order to
        properly deal with them at the right place (e.g. in module
        <xref href="#output_color_profile">
                              <i>output color profile</i>
                           </xref>).
        Blend mode <q>normal</q> is most often the preferred choice.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="blending_operators_modes_lightness">
                     <title>lightness</title>
                     <body>
                        <p>
        This blend mode mixes lightness from the input and output images. Color data (chroma and
        hue) are taken unaltered from the input image.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="blending_operators_modes_chroma">
                     <title>chroma</title>
                     <body>
                        <p>
        This blend mode mixes chroma (saturation) from the input and output images. Lightness
        and hue are taken unaltered from the input image.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="blending_operators_modes_hue">
                     <title>hue</title>
                     <body>
                        <p>
        This blend mode mixes hue (color tint) from the input and output images. Lightness and
        chroma are taken unaltered from the input image. Caution: When modules drastically
        modify hue (e.g. when generating complementary colors) this blend mode can result in
        strong color noise.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="blending_operators_modes_color">
                     <title>color</title>
                     <body>
                        <p>
        This blend mode mixes color (chroma and hue) from the input and output images. Lightness
        is taken unaltered from the input image. Caution: When modules drastically modify hue
        (e.g. when generating complementary colors) this blend mode can result in strong color
        noise.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="blending_operators_modes_lab_lightness">
                     <title>Lab lightness</title>
                     <body>
                        <p>
        Only available with modules that work in the Lab color space; this blend mode mixes
        lightness from the input and output images, while color data are taken unaltered from
        the input image. In contrast to blend mode <q>lightness</q> this blend mode does
        not involve any color space conversion and does not clamp any data. In some cases this
        is less prone to artifacts in comparison to <q>lightness</q>.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="blending_operators_modes_lab_color">
                     <title>Lab color</title>
                     <body>
                        <p>
        Only available with modules that work in the Lab color space; this blend mode mixes Lab
        color channels a and b from the input and output images, while lightness data are taken
        unaltered from the input image. In contrast to blend mode <q>color</q> this
        blend mode does not involve any color space conversion and does not clamp any data. In
        some cases this is less prone to artifacts in comparison to <q>color</q>.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="blending_operators_modes_hsv_lightness">
                     <title>HSV lightness</title>
                     <body>
                        <p>
        Only available with modules that work in the RGB color space; this blend mode mixes
        lightness from the input and output images, while color data are taken only from the
        input image. In contrast to blend mode <q>lightness</q> this mode does not
        involve clamping.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="blending_operators_modes_hsv_color">
                     <title>HSV color</title>
                     <body>
                        <p>
        Only available with modules that work in the RGB color space; this blend mode mixes
        color from the input and output images, while lightness data are taken only from the
        input image. In contrast to blend mode <q>color</q> this mode does not involve
        clamping.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="blending_operators_modes_color_adjustment">
                     <title>color adjustment</title>
                     <body>
                        <p>
        Some modules act predominantly on the tonal values of an image but also perform some
        color saturation adjustments, e.g. module
        <xref href="#levels">
                              <i>levels</i>
                           </xref> and
        <xref href="#tone_curve"> 
                              <i>tone curve</i>
                           </xref>. The color adjustment
        blend mode takes the lightness only from output data and mixes colors from input and
        output enabling control of the module's color adjustments.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="drawn_mask">
               <title>Drawn mask</title>
               
               <prolog>
                  <metadata>
                     <keywords>
                        <indexterm>masks</indexterm>
                        <indexterm>masks<indexterm>drawn masks</indexterm></indexterm>
                        <indexterm>local adjustments</indexterm>
                     </keywords>
                  </metadata>
                  
               </prolog>
               <body>
                  <p>
    Drawing a mask represents the simplest approach for limiting the effect of a darktable module to a specific 
    area in the developed image.
  </p>
               </body>
               <topic xml:lang="en-us" id="drawn_mask_overview">
                  <title>Overview</title>
                  <body>
                     <p>
      With the drawn mask feature you can construct a mask by drawing directly on the image
      base. Different drawing operators, called shapes, are available and can be used alone or
      in combination. A flexible editing feature allows you to change single aspects of a shape,
      remove shapes or import shapes already defined in other modules.
    </p>
                     <p>
      Internally shapes are stored as vector graphics and rendered with the needed resolution
      during pixelpipe processing. Shapes are expressed in the coordinate system of the original
      image and transformed with all distorting modules. This way a shape will always work on
      the same image area regardless of warping or other modifications that may be applied.
    </p>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="drawn_mask_usage">
                  <title>Usage</title>
                  <prolog>
                     <metadata>
                        <keywords>
                           <indexterm>mask shapes</indexterm>
                           <indexterm>shapes<index-sort-as>mask shapes</index-sort-as></indexterm>
                        </keywords>
                     </metadata>
                  </prolog>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              To draw a shape you need to click on one of the shape symbols. You will
              automatically be moved into the edit mode in which you generate a new instance of
              the selected shape and afterwards change its properties.
            </entry>
                                 <entry>
                                    <image href="concepts/images/drawn_masks.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                     <p>
      You leave edit mode by clicking on the
      <image href="../images/shape_edit.png" align="center"/>
      symbol. You can at any time go back to edit mode and do further adjustments by clicking
      the edit symbol again. In edit mode you can also remove a shape by right-clicking on
      it – the shape is removed from the current mask but it's still in the list of
      defined shapes.
    </p>
                     <p>
      Independent of the specific shape you can <i>scroll</i> to change the size
      of the shape, <i>shift+scroll</i> to change the feather of the shape and
      <i>Ctrl+scroll</i> to change the opacity of the shape.
    </p>
                     <p>
      If you <i>Ctrl+click</i> on the edit mode symbol you enter a restricted edit
      mode. Certain actions like dragging a complete shape or changing its size are blocked.
      Only finetuning changes like dragging a node are allowed.
    </p>
                     <p>
      Currently five shapes are implemented.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="brush_shape">
                     <title>brush</title>
                     
                     <prolog>
                        <metadata>
                           <keywords>
                              <indexterm>brush</indexterm>
                              <indexterm>mask shapes<indexterm>brush</indexterm></indexterm>
                           </keywords>
                        </metadata>
                        
                     </prolog>
                     <body>
                        <p> Clicking the <image href="../images/shape_brush.png" align="center"/>
                           symbol adds a brush stroke. </p>
                        <p>
        Start drawing by <i>left-clicking</i> into the canvas and moving the mouse
        while keeping the button pressed. The brush stroke is finalized once you release the
        mouse button. Brush size, hardness and opacity can be changed by
        <i>scrolling</i>, <i>shift+scrolling</i>, and
        <i>Ctrl+scrolling</i>, respectively, either before you start drawing or at
        any time during the operation. Likewise you can use keys
        <i>[ | ]</i> to decrease/increase brush size,
        <i>{ | }</i> to decrease/increase hardness, and
        <i>&lt; | &gt;</i> to decrease/increase opacity.
      </p>
                        <p>
        If you have a graphics tablet with pen pressure sensitivity, darktable can apply the
        recorded pen pressure to certain attributes of the brush stroke. See
        <xref href="gui_options"/> for more details.
      </p>
                        <p>
        On lifting the tablet pen or releasing the left mouse button the drawn figure is
        converted into a number of connected nodes which define the shape. A configuration
        option (see <xref href="gui_options"/>) controls how much smoothing is applied. A
        higher level of smoothing leads to less nodes – this eases subsequent editing
        at the expense of a lower initial accuracy.
      </p>
                        <p>
        Nodes and segments of a brush stroke can be modified individually. See the documentation
        on <i>path</i> below for more details.
      </p>
                        <p>
        Rendering a complex brush shape can consume a significant number of CPU cycles; consider
        to revert to the circle, ellipse or path shape if possible.
      </p>
                        <table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="2">
                              <colspec colwidth="6*"/>
                              <colspec colwidth="4*"/>
                              
                              <tbody>
                                 <row>
                                    <entry>
                A brush stroke with controls and activated mask display.
              </entry>
                                    <entry>
                                       <image href="concepts/images/masks_brush_ex1.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="circle_shape">
                     <title>circle</title>
                     
                     <prolog>
                        <metadata>
                           <keywords>
                              <indexterm>circle</indexterm>
                              <indexterm>mask shapes<indexterm>circle</indexterm></indexterm>
                           </keywords>
                        </metadata>
                        
                     </prolog>
                     <body>
                        <p>
        Clicking the
        <image href="../images/shape_circle.png" align="center"/>
        symbol adds a circle shape.
      </p>
                        <p>
                           <i>Click</i> into the canvas to place the circle.
        <i>Left-click</i> and drag the circle to a different position if needed.
        Use the scroll wheel of your mouse while in the circle to change the diameter;
        <i>scroll</i> within the circle border to adjust the width of the gradual
        decay or <i>shift+scroll</i> anywhere in the shape for the same effect.
        With <i>Ctrl+scroll</i> you can adjust the opacity of the
        circle – this is best observed with the mask displayed by pressing the
        <image href="../images/darkroom_module_icon_mask.png" align="center"/>
        button.
      </p>
                        <table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="2">
                              <colspec colwidth="6*"/>
                              <colspec colwidth="4*"/>
                              
                              <tbody>
                                 <row>
                                    <entry>
                A circle shape with controls and activated mask display.
              </entry>
                                    <entry>
                                       <image href="concepts/images/masks_circle_ex1.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="ellipse_shape">
                     <title>ellipse</title>
                     
                     <prolog>
                        <metadata>
                           <keywords>
                              <indexterm>ellipse</indexterm>
                              <indexterm>mask shapes<indexterm>ellipse</indexterm></indexterm>
                           </keywords>
                        </metadata>
                        
                     </prolog>
                     <body>
                        <p>
        Clicking the
        <image href="../images/shape_ellipse.png" align="center"/>
        symbol adds an ellipse shape.
      </p>
                        <p>
        The general principle is the same as for the circle shape. In addition you get four
        nodes on the ellipse line. <i>Click</i> on the nodes to adjust the
        ellipse's eccentricity. <i>Ctrl+click</i> on them to rotate the ellipse
        or, alternatively, use <i>Shift+Ctrl+scroll</i>.
        <i>Shift+click</i> in the shape to toggle the gradual decay between
        equidistant and proportional mode.
      </p>
                        <table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="2">
                              <colspec colwidth="6*"/>
                              <colspec colwidth="4*"/>
                              
                              <tbody>
                                 <row>
                                    <entry>
                An ellipse shape with controls and activated mask display.
              </entry>
                                    <entry>
                                       <image href="concepts/images/masks_ellipse_ex1.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="path_shape">
                     <title>path</title>
                     
                     <prolog>
                        <metadata>
                           <keywords>
                              <indexterm>path</indexterm>
                              <indexterm>mask shapes<indexterm>path</indexterm></indexterm>
                           </keywords>
                        </metadata>
                        
                     </prolog>
                     <body>
                        <p>
        Clicking the
        <image href="../images/shape_path.png" align="center"/>
        symbol adds a shape defined by a user defined closed path.
      </p>
                        <p>
                           <i>Left-click</i> into the canvas to define path nodes; terminate the path
        by <i>right-clicking</i> after having set the last point. Per default
        nodes are connected by smooth lines. If you want a node to define a sharp corner, you
        can do so by creating it with <i>Ctrl+click</i>.
      </p>
                        <p>
        In the edit mode you can convert existing nodes from smooth to sharp corners and vice
        versa by <i>Ctrl+clicking</i> on them. You can insert additional nodes by
        <i>Ctrl+clicking</i> on one of the line segments. Single nodes can be
        deleted by <i>right-clicking</i> on them; make sure that the mouse pointer
        is over the desired node and the node is highlighted, or else you might accidentally
        remove the whole path.
      </p>
                        <p>
        The size of the complete shape can be modified by
        <i>scrolling</i> – analogous to the circle shape. The same
        holds true for the width of the border, i.e. the area with a gradual opacity decay,
        which can be changed by <i>Shift+scroll</i> from anywhere within the shape.
        Single nodes as well as path segments can be moved by mouse <i>dragging</i>.
        If a node is selected by <i>clicking</i> on it, a further control point
        appears – you can move it around to modify the curvature of the line and
        reset to default by <i>right-clicking</i>. <i>Dragging</i>
        one of the control points on the border adjusts the border width just in that part of
        the shape.
      </p>
                        <p>
        Consider to finetune a path in the restricted edit mode (see above), which allows you to
        adjust single nodes and segments without the risk of accidentally shifting or resizing
        the whole shape.
      </p>
                        <table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="2">
                              <colspec colwidth="6*"/>
                              <colspec colwidth="4*"/>
                              
                              <tbody>
                                 <row>
                                    <entry>
                A path shape with controls and activated mask display.
              </entry>
                                    <entry>
                                       <image href="concepts/images/masks_path_ex1.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="gradient_shape">
                     <title>gradient</title>
                     
                     <prolog>
                        <metadata>
                           <keywords>
                              <indexterm>gradient</indexterm>
                              <indexterm>mask shapes<indexterm>gradient</indexterm></indexterm>
                              <indexterm>artifact
                                 mitigation<indexterm>banding</indexterm></indexterm>
                           </keywords>
                        </metadata>
                        
                     </prolog>
                     <body>
                        <p>
        Clicking the
        <image href="../images/shape_gradient.png" align="center"/>
        symbol adds a gradient to the mask. This does not generate a confined shape but produces
        a linear gradient extending the whole image.
      </p>
                        <p>
        Click into the canvas to define the position of the line where opacity is at 50%. The
        line has two anchor nodes which you can drag to change the rotation of the gradient.
      </p>
                        <p>
        Scrolling close to the center line changes the steepness of the gradient. Dotted lines
        indicate the distance beyond which the opacity is 100% and 0%, respectively. Between
        these dotted lines the opacity changes linearly. The gradient is best seen and modified
        when the mask is displayed by pressing the
        <image href="../images/darkroom_module_icon_mask.png" align="center"/>
        button.
      </p>
                        <p>
        Depending on the module and the underlying image using a gradient shape might provoke
        banding artifacts. You should consider to activate the <i>dithering</i>
        module (see <xref href="#dithering"/>)
      </p>
                        <table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="2">
                              <colspec colwidth="6*"/>
                              <colspec colwidth="4*"/>
                              
                              <tbody>
                                 <row>
                                    <entry>
                A gradient with controls and activated mask display.
              </entry>
                                    <entry>
                                       <image href="concepts/images/masks_gradient_ex1.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="drawn_mask_usage_drawn">
                     <title>drawn mask</title>
                     <body>
                        <p>
        The number of shapes that are used in the current mask is displayed in the <q>drawn
        mask</q> field. Clicking on that field opens a dropdown box with all shapes that
        have already been defined in the context of the current image but are not yet used in
        the current mask. You can click on any of these items in order to add it to the current
        mask. The list also contains shapes once generated but no longer in use. This way you
        can even get back a deleted shape.
      </p>
                        <p>
        A polarity button (
        <image href="../images/darkroom_module_icon_polarity_plus.png" align="center"/>
        and
        <image href="../images/darkroom_module_icon_polarity_minus.png" align="center"/>
        , respectively) allows the user to toggle between the normal and the inverted state of
        the drawn mask, i.e. the opacity values get inverted – 100% becomes 0% and
        vice versa. You need this feature when combining drawn and parametric masks (see
        <xref href="#combined_masks"/>).
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="blending_usage_mask_combination_inversion_invert">
                     <title>invert mask</title>
                     <body>
                        <p>
        When <q>drawn mask</q> is selected there is an additional combobox to invert the
        mask by switching mask inversion <q>on</q> or <q>off</q>.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="drawn_mask_usage_manager">
                     <title>mask manager</title>
                     <body>
                        <p>
        More functionality to control the interaction of multiple shapes within a mask can be
        found in the mask manager panel (see <xref href="#mask_manager"/>). Here you can give
        individual names to your shapes which will help you to keep track of your shapes. You
        can also select individual shapes for editing – a helpful feature if your
        masks happens to contain several shapes with overlapping control elements.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="parametric_mask">
               <title>Parametric mask</title>
               
               <prolog>
                  <metadata>
                     <keywords>
                        <indexterm>masks<indexterm>parametric masks</indexterm></indexterm>
                        <indexterm>conditional blending</indexterm>
                     </keywords>
                  </metadata>
                  
               </prolog>
               <body>
                  <p>
    The parametric mask feature, formerly called <q>conditional blending</q>, offers
    fine-grained selective control over how individual pixels are blended. It does so by
    automatically generating an intermediate blend mask from user defined parameters. These
    parameters are color coordinates not the geometrical coordinates used in drawn masks.
  </p>
                  <p>
    The parametric mask is a powerful tool with a certain level of complexity.
  </p>
               </body>
               <topic xml:lang="en-us" id="parametric_mask_overview">
                  <title>Overview</title>
                  <body>
                     <p>
      For each data channel of a module (Lab, RGB) and additionally for several virtual data
      channels (e.g. hue, saturation) users can construct a per-channel opacity function.
      Depending on the pixel's value for this data channel this function determines a blending
      factor between 0 and 1 (or 100%) for that pixel.
    </p>
                     <p>
      Each pixel of an image thus has different blending factors for each of its data channels
      (real and virtual). All blending factors are finally pixel-wise multiplied together with
      the value of the global opacity slider (see <xref href="#blending_operators"/>) to form
      a blend mask for the image.
    </p>
                     <p>
      If for a given pixel the blend mask has a value of 0, the input of the module is left
      unchanged. If for a pixel the blend mask has its maximum value of 1 (or 100%), the module
      has full effect.
    </p>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="parametric_mask_usage">
                  <title>Usage</title>
                  <body>
                     <p>
                        <table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="2">
                              <colspec colwidth="6*"/>
                              <colspec colwidth="4*"/>
                              
                              <tbody>
                                 <row>
                                    <entry>
                When <i>parametric mask</i> is activated in combobox
                <q>blend</q> an additional set of tabbed controls is shown.
              </entry>
                                    <entry>
                                       <image href="concepts/images/blendif_1.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table>
                     </p>
                  </body>
                  <topic xml:lang="en-us" id="parametric_mask_usage_tabs">
                     <title>Channel tabs</title>
                     <body>
                        <p>
        Each tab selects a data channel – real or virtual. Modules acting in Lab
        color space have data channels for L, a, b, C (chroma of LCh) and h (hue of LCh).
        Modules acting in RGB color space have data channels for g (gray), R, G, B, H (hue of
        HSL), S (saturation of HSL), and L (lightness of HSL). Consult for example
        <xref href="http://en.wikipedia.org/wiki/Color_space"
                                 format="html"
                                 scope="external"> Wikipedia's article on color
        spaces</xref> for a deeper look.
      </p>
                        <p>
        Each tab provides two sliders for its data channels: one for the input data that the
        module receives and one for the output data that the module produces prior to blending.
      </p>
                        <p>
        You can inspect the image data corresponding to an individual color channel by holding
        down the <i>Shift</i> key while entering the respective slider with the
        mouse cursor. The center image changes to display the selected color channel either in
        graycale values or in false colors, depending on the corresponding preference setting in
        <q>GUI options</q> (see <xref href="gui_options"/>). You may additionally
        hold down the <i>ctrl</i> key which lets you see the resulting mask
        overlaid to the image. When leaving the slider the image goes back to normal after a
        short delay.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="parametric_mask_usage_sliders">
                     <title>Color channel sliders</title>
                     <body>
                        <p>
        With the color channel slider you construct a trapezoidal opacity function. For this
        purpose there are four markers per slider. Two triangles above the slider mark the range
        of values where opacity is 1. Two triangles below the slider mark the range values where
        opacity is zero. Intermediate points between full and zero opacities are given a
        proportional opacity.
      </p>
                        <p>
        The filled triangles, or inside markers, indicate the closed (mostly narrower) edge of
        the trapezoidal function. The open triangles, or outside markers, indicate the open
        (mostly wider) edge of the trapezoidal function. The sequence of the markers always
        remains unchanged: they can touch but they can not switch position.
      </p>
                        <p>
        A polarity button (
        <image href="../images/darkroom_module_icon_polarity_plus.png" align="center"/>
        and
        <image href="../images/darkroom_module_icon_polarity_minus.png" align="center"/>
        , respectively) to the right of the slider switches between <i>range
        select</i> and <i>range de-select</i> function modes with visual
        confirmation provided by exchanging the upper and the lower triangle markers. These two
        types of trapezoidal functions are represented graphically in the following images.
      </p>
                        <p>
                           <table frame="none">
                              <tgroup colsep="0" rowsep="0" cols="2">
                                 <colspec align="center" colwidth="1*"/>
                                 <colspec align="center" colwidth="1*"/>
                                 
                                 <tbody>
                                    <row>
                                       <entry>
                                          <p>
                    Range select function
                  </p>
                                       </entry>
                                       <entry>
                                          <p>
                    Range de-select function
                  </p>
                                       </entry>
                                    </row>
                                    <row>
                                       <entry>
                                          <image href="concepts/images/blendif_2a.png"
                                                 align="center"
                                                 placement="break"/>
                                       </entry>
                                       <entry>
                                          <image href="concepts/images/blendif_3a.png"
                                                 align="center"
                                                 placement="break"/>
                                       </entry>
                                    </row>
                                    <row>
                                       <entry>
                                          <image href="concepts/images/blendif_2b.png"
                                                 align="center"
                                                 placement="break"/>
                                       </entry>
                                       <entry>
                                          <image href="concepts/images/blendif_3b.png"
                                                 align="center"
                                                 placement="break"/>
                                       </entry>
                                    </row>
                                    <row>
                                       <entry>
                                          <p>
                    A trapezoidal function that selects a narrow range of values for blending.
                  </p>
                                       </entry>
                                       <entry>
                                          <p>
                    A trapezoidal function that de-selects a narrow range of values from
                    blending.
                  </p>
                                       </entry>
                                    </row>
                                 </tbody>
                              </tgroup>
                           </table>
                        </p>
                        <p>
        In their default state all markers are at their extreme positions, maximum left and
        maximum right, respectively. In this state a <i>range select</i> function
        selects the whole range of values giving an <q>all at 100%</q> mask. Starting
        from there one can move the sliders inwards to gradually take out more an more parts of
        the image except of the remaining narrow range.
      </p>
                        <p>
        A <i>range de-select</i> function per default deselects the whole range of
        values, giving an <q>all-zero</q> mask as a starting point. Moving the sliders
        inwards gradually extends the mask more and more except of the remaining narrow range.
      </p>
                        <p>
        For more information on the polarity feature read <xref href="#combined_masks"/>.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="parametric_mask_usage_buttons">
                     <title>Control buttons</title>
                     
                     <prolog>
                        <metadata>
                           <keywords>
                              <indexterm>color picker</indexterm>
                           </keywords>
                        </metadata>
                        
                     </prolog>
                     <body>
                        <p>
        Control buttons help you when designing a parametric mask.
      </p>
                        <p>
        With the color picker button
        <image href="../images/darkroom_module_icon_picker.png" align="center"/>
        you can select a probe from your image. The corresponding values for the real and
        virtual data channels are then displayed within each color channel slider. You can
        switch between point and area sampling mode from within the global color picker panel
        (see <xref href="#global_color_picker"/>).
      </p>
                        <p>
        With the invert button
        <image href="../images/darkroom_module_icon_invert.png" align="center"/>
        you can toggle the polarities of all channels (including a potentially activated drawn
        mask) and change the method how channels are combined into the final mask. More on that
        topic can be found in <xref href="#combined_masks"/>.
      </p>
                        <p>
        With the reset button
        <image href="../images/darkroom_module_icon_reset.png" align="center"/>
        you can put all settings back to their default state.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="blending_usage_mask_combination_inversion_combine">
                     <title>combine masks</title>
                     <body>
                        <p>
        When either a <q>parametric masks</q>, or the combination of <q>drawn and
        parametric mask</q> is active an additional combobox is shown that controls how the
        individual masks are combined to form the final mask. This option also allows to invert
        the final mask. Details on the combination of individual masks can be found in
        <xref href="#combined_masks"/>.
      </p>
                     </body>
                     
                  </topic>
               </topic>
               <topic xml:lang="en-us" id="parametric_mask_examples">
                  <title>Example</title>
                  <topic xml:lang="en-us" id="parametric_mask_examples_colorkey">
                     <title>Colorkey effect</title>
                     <body>
                        <p>
                           <table frame="none">
                              <tgroup colsep="0" rowsep="0" cols="2">
                                 <colspec colwidth="6*"/>
                                 <colspec colwidth="4*"/>
                                 
                                 <tbody>
                                    <row>
                                       <entry>
                                          <p>
                    To create a colorkey effect with this poppy blossom in red and the remainder
                    of the image in monochrome, we could apply module
                    <xref href="#monochrome"> 
                                                <i>monochrome</i>
                                             </xref> to all
                    parts of the image except for of the saturated red petals.
                  </p>

                                          <p>
                    We choose the hue channel to control our mask as hue provides good
                    separation between the petals and background.
                  </p>
                                       </entry>
                                       <entry>
                                          <image href="concepts/images/blendif_4.png"
                                                 align="center"
                                                 placement="break"/>
                                       </entry>
                                    </row>
                                    <row>
                                       <entry>
                                          <p>
                    These settings in hue channel construct a parametric blend mask that
                    excludes the red petals. The small white bar in the gradient was obtained by
                    using the color picker on one of the petals and the markers then closely
                    centered on the indicated hue to increase the selectivity of our mask.
                  </p>
                                       </entry>
                                       <entry>
                                          <image href="concepts/images/blendif_5.png"
                                                 align="center"
                                                 placement="break"/>
                                       </entry>
                                    </row>
                                    <row>
                                       <entry>
                                          <p>
                    The resulting blend mask.
                  </p>
                                       </entry>
                                       <entry>
                                          <image href="concepts/images/blendif_6.png"
                                                 align="center"
                                                 placement="break"/>
                                       </entry>
                                    </row>
                                    <row>
                                       <entry>
                                          <p>
                    The final image after module <i>monochrome</i> is applied.
                  </p>
                                       </entry>
                                       <entry>
                                          <image href="concepts/images/blendif_7.png"
                                                 align="center"
                                                 placement="break"/>
                                       </entry>
                                    </row>
                                 </tbody>
                              </tgroup>
                           </table>
                        </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="raster_mask">
               <title>Raster mask</title>
               
               <prolog>
                  <metadata>
                     <keywords>
                        <indexterm>masks<indexterm>raster masks</indexterm></indexterm>
                     </keywords>
                  </metadata>
                  
               </prolog>
               <body>
                  <p>
    When a <q>drawn mask</q> or a <q>parametric mask</q> is active
    the final mask can be reused in other modules. This works because all the shapes from the drawn mask 
    and all the blend functions from the parametric mask of a module assemble a final mask,
    which internally is stored as a raster image and made accessible to other modules.
  </p>
               </body>
               <topic xml:lang="en-us" id="raster_mask_overview">
                  <title>Overview</title>
                  <body>
                     <p>
      Each individual mask selects a set of pixels and how drastically the effect of the module
      is applied to this selection. Several drawn masks and parametric blend functions can be defined 
      and they all together render the final mask, the final settings of how drastically the effect 
      of the module will be. 
    </p>
                     <p>
      The selection of these masks can be saved as an alpha map, that is an image
      as big as the input image in which for each pixel an intensity value is being stored between zero
      and the maximum alpha value. If the value for a pixel is zero the input of the module is left unchanged, if the 
      value has the maximum intensity the module has full effect and for each alpha value in-between the 
      minimum and the maximum the effect is applied proportionally at that location.
    </p>
                     <p>
      Internally for each module the alpha map is saved and made accessible to other modules in the raster mask button.
      So a mask from any module can be reused from any other module easily.
    </p>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="raster_mask_usage">
                  <title>Usage</title>
                  <topic xml:lang="en-us" id="raster_mask_usage_dropdown">
                     <title>Drop-down menu</title>
                     <body>
                        <p>
        If there is a mask in another module it will appear in the drop-down menu of the raster mask.
        You can easily identify the mask by the name of the module it was defined in.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="combined_masks">
               <title>Combining drawn and parametric masks</title>
               
               <prolog>
                  <metadata>
                     <keywords>
                        <indexterm>masks<indexterm>combined masks</indexterm></indexterm>
                     </keywords>
                  </metadata>
                  
               </prolog>
               <body>
                  <p>
    This section describes how darktable combines individual masks to form the final mask of a
    module. Individual masks are the drawn mask and all the single channels of the parametric
    mask. The topic is rather advanced – if you don't want to go through all the
    theoretical details just jump down where we describe two typical use cases.
  </p>
               </body>
               <topic xml:lang="en-us" id="combined_masks_overview">
                  <title>Overview</title>
                  <body>
                     <p>
      There are two main elements which control how individual masks are combined: the polarity
      setting of each individual mask, defined by the plus or minus buttons, and the setting in
      the <q>combine masks</q> combobox (see
      <xref href="#blending_usage_mask_combination_inversion_combine"/>).
    </p>
                     <p>
      Masks can be regarded as grayscale images which take up values between 0 and 1.0 (or from
      0% to 100%) for each pixel.
    </p>
                     <p>
      A straightforward way to combine masks is by multiplying the individual pixel values. The
      final mask will have a pixel value of 0 whenever one of the individual masks is 0 at that
      pixel location. The final mask can only reach a maximum pixel value of 1.0 if each and
      every of the individual masks has a value of 1.0 at that location. We call this way of
      combination <q>exclusive</q>. Any individual mask can exclude a pixel by setting
      its value to zero, regardless of what the other individual masks do. Once a pixel is
      excluded (its value is 0) by any mask there is no way to include it again by any other
      individual mask.
    </p>
                     <p>
      An alternative way to combine masks is the following: we first invert each individual mask
       – calculating 1.0 minus its value – then we multiply these inverted
      masks and as a last step invert the final mask again. Now if one of the non-inverted
      individual masks has a value of 1.0 at a pixel location the final will also be 1.0. The
      final mask can only reach a pixel value of 0 if all the individual masks have a value of
      0. We call this way of combination <q>inclusive</q>. Any individual mask can
      include a pixel by setting its value to 1.0, regardless of what the other individual masks
      do. Once a pixel is included (its value is 1.0) by any mask there is no way to exclude it
      again by any other individual mask.
    </p>
                     <p>
      These two combination methods alone would still be rather limiting. We gain maximum
      flexibility by allowing an additional inversion step for each individual mask. This is
      governed by the polarity buttons
      <image href="../images/darkroom_module_icon_polarity_plus.png" align="center"/>
      and
      <image href="../images/darkroom_module_icon_polarity_minus.png" align="center"/>
      that you find close to the individual channels. Toggling the polarity button of a mask
      inverts its values, i.e. it recalculates the pixel values to 1.0 minus the original value.
    </p>
                     <p>
      Finally within the <q>combine masks</q> combobox you may once again invert the
      final result to fit your needs by selecting the <i>exclusive &amp;
      inverted</i> or <i>inclusive &amp; inverted</i> options.
    </p>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="combined_masks_usage">
                  <title>Usage</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              You will typically want to combine drawn and parametric masks to first select a
              certain region of your image – either by the drawn or the parametric
              mask – and use the other mask type to finetune your selection.
              Finetuning can either mean that you want to include further parts of the image,
              which are not included in the first place, or you want to exclude parts of the
              image that were previously included.
            </entry>
                                 <entry>
                                    <image href="concepts/images/combined_masks.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                     <p>
      This gives two typical use cases:
    </p>
                  </body>
                  <topic xml:lang="en-us" id="combined_masks_usage_inclusive">
                     <title>Inclusive mode</title>
                     <body>
                        <p>
        For this mode you set the <q>combine masks</q> combobox to
        <i>inclusive</i> and make sure that all polarity buttons of all the
        individual channels and of the drawn mask are set to negative (
        <image href="../images/darkroom_module_icon_polarity_minus.png" align="center"/>
        ). Your starting point is a mask where all pixels have a value of zero, i.e. no pixel is
        selected. You now adjust the parametric mask sliders to bring more and more pixels into
        the selection or you draw shapes on the canvas to select specific areas of your image.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="combined_masks_usage_exclusive">
                     <title>Exclusive mode</title>
                     <body>
                        <p>
        In the opposite case you set the <q>combine masks</q> combobox to
        <i>exclusive</i> and make sure that all polarity buttons are set to
        positive (
        <image href="../images/darkroom_module_icon_polarity_plus.png" align="center"/>
        ). Your starting point is a mask with all values at 1.0, i.e. all pixels selected. You
        now gradually change the parametric mask sliders to exclude parts of your image as
        needed or you directly draw shapes on the canvas to specifically exclude these areas.
      </p>
                        <p>
        For your convenience you find in the parametric masks GUI a
        <image href="../images/darkroom_module_icon_invert.png" align="center"/>
        toggle button that inverts all channel polarities and toggles between inclusive and
        exclusive mode in the <q>combine masks</q> combobox.
      </p>
                        <p>
        For novice users it is recommended to stick to these two use cases. This implies that
        you should decide beforehand how you want to construct your mask. Advanced users will
        find their way to take advantage of the many possible combinations of polarities and
        mask combination modes.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="blending_mask_refinement">
               <title>Mask refinement and additional controls</title>
               <topic xml:lang="en-us" id="blending_mask_refinement_overview">
                  <title>Overview</title>
                  <body>
                     <p>
      When a <q>parametric masks</q>, a <q>drawn mask</q> or a combination of
      both is active several additional sliders are shown that allow for a meticulous refinement
      of the mask.
    </p>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e2377">
                  <title>Usage</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              When blending with a mask there are some additional options to deal with the final
              mask: you may feather the mask, blur the mask, adjust the mask's brightness and
              contrast, temporarily disable the mask, or display it as an overlay image. The
              latter option is particularly useful for examining the effect of the following
              controls.
            </entry>
                                 <entry>
                                    <image href="concepts/images/mask_refinement.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  <topic xml:lang="en-us" id="blending_mask_refinement_feathering_guide">
                     <title>feathering guide</title>
                     <body>
                        <p>
        Mask feathering smoothens a drawn or parametric mask non-uniformly such that the mask's
        edges are adjusted automatically to match the edges of the image. This mask smoothing is
        guided either by the module's input image or by its output (before blending), depending
        on what is selected in the <q>feathering guide</q> combobox. The feathering is
        particularly sensitive to this choice for edge-modifying modules, i.e., modules for
        sharpening or blurring an image.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="blending_mask_refinement_feathering_radius">
                     <title>feathering radius</title>
                     <body>
                        <p>
        The <q>feathering radius</q> slider adjusts the strength of the feathering
        effect. Feathering works best if the drawn and/or parametric mask's edges already match
        approximately some edges in the guiding image. The larger the <q>feathering
        radius</q> the better the feathering algorithm can align mask edges to more distant
        edges of the image. If this radius is too large, however, the feathered mask may
        overshoot. This means it cover regions that the user actually wants to exclude.
        Feathering is turned off if the feathering radius is set to 0.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="blending_mask_refinement_blur">
                     <title>mask blur</title>
                     <body>
                        <p>
        Blurring the mask creates a softer transition between blended and unblended parts of an
        image and avoids artifacts. The mask blur slider controls the radius of a gaussian blur
        applied to the final blend mask. The higher the radius, the stronger the
        blur – or set to 0 for an unblurred mask. Gaussian blur is always applied
        after feathering if both kinds of mask adjustment are activated. This order allows to
        smooth sharp edges or artefacts that may result by feathering.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="blending_mask_refinement_mask_brightness">
                     <title>mask opacity</title>
                     <body>
                        <p>
        The strength of the module's effect is determined by the mask's local opacity.
        Feathering and blurring the mask may result in a mask with reduced opacity, which
        implies a reduced effect. Therefore, the <q>mask opacity</q> slider allows to
        readjust the mask opacity. If the opacity is decreased (negative slider values) least
        opaque parts are affected stronger than most opaque parts. Contrary, if the mask opacity
        is increased (positive slider values) most opaque parts are affected stronger than least
        opaque parts. As a consequence, completely opaque portions of the mask always remain
        opaque and completely transparent portions remain transparent. This is to ensure that
        regions which have been excluded from or included to a module's effect by setting the
        mask's opacity to 0% or 100% remain excluded or included even if the mask opacity is
        adjusted by this slider.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="blending_mask_refinement_mask_contrast">
                     <title>mask contrast</title>
                     <body>
                        <p>
        This slider increases or decreases the mask contrast. This means it allows to modify the
        transition between opaque and transparent mask parts.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="blending_mask_refinement_temp_off">
                     <title>temporarily switch off mask</title>
                     <body>
                        <p>
        Sometimes it is useful to visualize the module's effect without the mask taking action.
        You can do so by clicking on the
        <image href="../images/darkroom_module_icon_eye.png" align="center"/>
        symbol, which will temporarily deactivate the mask – the selected blend mode
        and opacity remain in effect. Switch this button on and off to see if the mask is acting
        on the image as intended.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="blending_mask_refinement_display">
                     <title>display mask</title>
                     <body>
                        <p>
        Clicking on the
        <image href="../images/darkroom_module_icon_mask.png" align="center"/>
        symbol will display the current mask as a yellow overlay over a black-and-white version
        of your image. Solid yellow indicates an opacity of 100%; a fully visible gray
        background image without yellow overlay indicates an opacity of 0%.
      </p>
                     </body>
                     
                  </topic>
               </topic>
               <topic xml:lang="en-us" id="examples.d12e2493">
                  <title>Examples</title>
                  <topic xml:lang="en-us" id="blending_examples_feathering">
                     <title>Feathering a drawn mask</title>
                     <body>
                        <p>
                           <table frame="none">
                              <tgroup colsep="0" rowsep="0" cols="4">
                                 <colspec colwidth="1*"/>
                                 <colspec colwidth="1*"/>
                                 <colspec colwidth="1*"/>
                                 <colspec colwidth="1*"/>
                                 
                                 <tbody>
                                    <row>
                                       <entry>
                                          <image href="concepts/images/feathering_1.png"
                                                 align="center"
                                                 placement="break"/>
                                       </entry>
                                       <entry>
                                          <image href="concepts/images/feathering_2.png"
                                                 align="center"
                                                 placement="break"/>
                                       </entry>
                                       <entry>
                                          <image href="concepts/images/feathering_3.png"
                                                 align="center"
                                                 placement="break"/>
                                       </entry>
                                       <entry>
                                          <image href="concepts/images/feathering_4.png"
                                                 align="center"
                                                 placement="break"/>
                                       </entry>
                                    </row>
                                 </tbody>
                              </tgroup>
                           </table>
                        </p>
                        <p>
        It can be rather tedious to create a drawn mask by hand, which matches precisely a
        particular object or person in an image. In this example, we want to enhance the color
        contrast of the lion sculpture shown in the left image above without affecting the
        background. For this purpose, a rough selection of the sculpture is created by a drawn
        mask. See the second image above, where the <q>displays mask</q> feature is
        active. Note that the mask is rather fuzzy and it does not match precisely the lion
        sculpture. Adjusting the feathering radius, the mask opacity and the mask contrast leads
        to a well matching mask with little effort. In the third image above the feathering
        radius has been adjusted to 50, a blur radius of 5 was chosen to smooth the mask to some
        degree. The mask opacity and the mask contrast have been increased to 0.3 and 0.5,
        respectively, to further enhance the mask. The last image above shows the final result,
        where the color enhancement via the color contrast module (see
        <xref href="#color_contrast"/>) is restricted to the lion sculpture due to the mask.
      </p>
                        <p>
        Mask feathering works in this example particularly well because the sculpture in the
        original image is well separated from the blurry background. The distinct edge at the
        border of the sculpture guides the feathering mask adjustment to match the shape of the
        sculpture. Note that feathering can be applied to drawn masks as well as to parametric
        masks.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
         </topic>
         <topic xml:lang="en-us" id="color_management">
            <title>Color management</title>
            
            <prolog>
               <metadata>
                  <keywords>
                     <indexterm>color management</indexterm>
                  </keywords>
               </metadata>
               
            </prolog>
            <body>
               <p>
    darktable employs a fully color managed workflow:
    <ul>
                     <li>
                        <p>
        Input color specifications are taken from embedded or user supplied ICC profiles
        or – in the case of raw files – from a library of camera specific
        color matrices.
      </p>
                     </li>
                     <li>
                        <p>
        darktable automatically reads the display profile of your monitor (if properly
        configured) for an accurate color rendition on screen. Multi-screen setups are fully
        supported as long as a system service like <i>colord</i> is in place and
        properly set up to inform darktable about the correct monitor profile.
      </p>
                     </li>
                     <li>
                        <p>
        Output files can be encoded in one of darktable's built-in profiles, like
        <xref href="http://en.wikipedia.org/wiki/SRGB"
                                 format="html"
                                 scope="external">sRGB</xref> or
        <xref href="http://en.wikipedia.org/wiki/Adobergb"
                                 format="html"
                                 scope="external">AdobeRGB (compatible)</xref>, or
        into any other output color space that the user supplies to darktable as an ICC profile.
      </p>
                     </li>
                  </ul>
               </p>
            </body>
            <topic xml:lang="en-us" id="display_profile">
               <title>Display profile</title>
               
               <prolog>
                  <metadata>
                     <keywords>
                        <indexterm>color management<indexterm>display
                           profile</indexterm></indexterm>
                        <indexterm>monitor profile</indexterm>
                        <indexterm>display profile</indexterm>
                     </keywords>
                  </metadata>
                  
               </prolog>
               <body>
                  <p>
      In order for darktable to accurately render colors on screen it needs to find the correct
      display profile of your monitor. In general this requires your monitor to be properly
      calibrated and profiled, and it needs the profile to be correctly installed on your
      system. darktable queries your X display server's <i>xatom</i> as well as the
      system service <i>colord</i> (if available) for the right profile. If needed
      you can enforce a specific method in the GUI preferences dialog (see
      <xref href="gui_options"/>).
    </p>
                  <p>
      To investigate your display profile configuration you can call the
      <filepath>darktable-cmstest</filepath> binary (Linux only) which prints out useful information like
      profile name per monitor and tells you if the system is correctly configured (see
      <xref href="darktable_cmstest_commandline_parameters"/>).
    </p>
                  <p>
      In rare cases you may need to manually select the display profile. This is possible from
      the softproof and gamut check option dialogs in the darkroom view (see
      <xref href="#softproof"/> and <xref href="#gamutcheck"/>), and the display profile
      dialog in the lighttable view (see <xref href="lighttable_overview"/>).
    </p>
               </body>
               
            </topic>
            <topic xml:lang="en-us" id="rendering_method">
               <title>Rendering method</title>
               
               <prolog>
                  <metadata>
                     <keywords>
                        <indexterm>color management<indexterm>rendering
                           method</indexterm></indexterm>
                        <indexterm>LittleCMS2</indexterm>
                     </keywords>
                  </metadata>
                  
               </prolog>
               <body>
                  <p>
      A configuration parameter <q>always use LittleCMS 2 to apply output color
      profile</q> in darktable's <i>core options</i> (see
      <xref href="core_options"/>) defines how colors are rendered.
    </p>
                  <p>
      darktable can render colors either with its internal algorithms or by using the external
      library <xref href="http://www.littlecms.com/" format="html" scope="external">
                        <i>LittleCMS2</i>
                     </xref>.
      darktable's internal method is by an order of magnitude faster than the external one. The
      external option gives you a choice of the rendering intent and might offer a slightly
      higher accuracy in some cases.
    </p>
                  <p>
      Note that if the given ICC is LUT-based or contains both, a LUT and a matrix, darktable
      will use LittleCMS 2 to render the colors regardless of that configuration parameter's
      value.
    </p>
               </body>
               
            </topic>
            <topic xml:lang="en-us" id="rendering_intent">
               <title>Rendering intent</title>
               
               <prolog>
                  <metadata>
                     <keywords>
                        <indexterm>color management<indexterm>rendering
                           intent</indexterm></indexterm>
                        <indexterm>rendering intent</indexterm>
                     </keywords>
                  </metadata>
                  
               </prolog>
               <body>
                  <p>
      If rendering with LittleCMS2 is activated (see <xref href="#rendering_method"/>) you can
      define how out-of-gamut colors are handled when converting between color spaces. A
      selection box in the export panel (see <xref href="export_selected"/>), the output
      color profile module (see <xref href="#output_color_profile"/>), and the soft proof
      option (see <xref href="#softproof"/>) gives you a choice of the following rendering
      intents:
      <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="4*"/>
                           <colspec colwidth="6*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
                                    <i>perceptual</i>
                                 </entry>
                                 <entry>
                Suited to pictures as it maintains the relative position of colors. This is
                usually the best choice.
              </entry>
                              </row>
                              <row>
                                 <entry>
                                    <i>relative colorimetric</i>
                                 </entry>
                                 <entry>
                Out-of-gamut colors are converted to colors having the same lightness, but
                different saturation. Other colors remain unmodified.
              </entry>
                              </row>
                              <row>
                                 <entry>
                                    <i>saturation</i>
                                 </entry>
                                 <entry>
                Saturation is kept but lightness is slightly changed.
              </entry>
                              </row>
                              <row>
                                 <entry>
                                    <i>absolute colorimetric</i>
                                 </entry>
                                 <entry>
                Keep the white point.
              </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </p>
               </body>
               
            </topic>
            <topic xml:lang="en-us" id="darktable_color_spaces">
               <title>darktable's color spaces</title>
               
               <prolog>
                  <metadata>
                     <keywords>
                        <indexterm>color spaces</indexterm>
                     </keywords>
                  </metadata>
                  
               </prolog>
               <body>
                  <p>
      darktable's input images are either RGB files (like JPEGs or TIFFs) or camera
      raws – both represent colors by a combination of red, green and blue. Most part
      of our modules act in the <xref href="http://en.wikipedia.org/wiki/Lab_color_space"
                           format="html"
                           scope="external">CIELAB
      color space</xref> (often just called <q>Lab</q>) which describes color as a
      combination of lightness data (L) and a point in the a-b color plane. The final output of
      the image processing pipeline is once again in RGB, either shaped for the monitor display
      or the output file.
    </p>
                  <p>
      This process implies that the pixelpipe has two color conversion steps:
      <xref href="#input_color_profile">
                        <i>input color profile</i>
                     </xref> and
      <xref href="#output_color_profile">
                        <i>output color profile</i>
                     </xref>. In
      addition there is the <xref href="#demosaic">
                        <i>demosaic</i>
                     </xref> step
      for raw images, where the colors of each pixel are reconstructed by interpolation.
    </p>
                  <p>
      Each module has a fixed position in the pixelpipe which tells you which color space the
      module lives in:
    </p>
                  <p>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="3">
                           <colspec colwidth="3.5*"/>
                           <colspec colwidth="0.5*"/>
                           <colspec colwidth="6*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
                up to <i>demosaic</i>
                                 </entry>
                                 <entry/>
                                 <entry>
                Image is in raw data format with only latent colors. Each pixel carries
                lightness and color information for only one base color. Please mind that some
                of the modules in this part can also act on non-raw input images in RGB format
                with full information on all three color channels.
              </entry>
                              </row>
                              <row>
                                 <entry>
                between <i>demosaic</i> and <i>input color
                profile</i>
                                 </entry>
                                 <entry/>
                                 <entry>
                Image is in RGB format within the color space of the specific camera or input
                file.
              </entry>
                              </row>
                              <row>
                                 <entry>
                between <i>input color profile</i> and <i>output color
                profile</i>
                                 </entry>
                                 <entry/>
                                 <entry>
                Image is in Lab format. This is a very huge universal color space which covers
                all colors visible to the human eye (and even more). As darktable processes
                images in 4x32-bit floating point buffers, we can handle the Lab color space
                without risking banding or tonal breaks.
              </entry>
                              </row>
                              <row>
                                 <entry>
                after <i>output color profile</i>
                                 </entry>
                                 <entry/>
                                 <entry>
                Image is in RGB format as defined by the selected display or output ICC profile.
              </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </p>
               </body>
               
            </topic>
            <topic xml:lang="en-us" id="unbounded_colors">
               <title>Unbounded colors</title>
               
               <prolog>
                  <metadata>
                     <keywords>
                        <indexterm>unbounded colors</indexterm>
                     </keywords>
                  </metadata>
                  
               </prolog>
               <body>
                  <p>
      Theoretically the individual components of color data are confined to certain minimum and
      maximum levels. As an example the intensity of an individual red, green or blue color
      channel in RGB can be anything in the range between 0% and 100% (or between 0.0 and 1.0).
      Likewise the L channel in Lab can be anything between 0 (pure black) and 100 (pure white).
    </p>
                  <p>
      In practice sometimes the image processing steps in darktable's modules can lead to values
      which lie outside of these confined ranges. In fact even the well established color
      matrices, which convert from camera RGB to Lab, may sometimes produce pixels with negative
      L values.
    </p>
                  <p>
      Pixels with these kind of values are said to have <q>unbounded colors</q>. One
      could <i>clamp</i> (i.e. confine) those values to the allowed range at every
      processing step. However, it has been found that it is much preferred and less prone to
      artifacts to not clamp in-between unbounded colors, but treat them just like any other
      color data.
    </p>
                  <p>
      In darktable there is no technical requirement for clamping; due to the fact that we are
      using floating point arithmetics for all processing steps, unbounded values can be passed
      along like any other value until the final color conversion module makes sure that they
      are transferred into the most reasonable color within the selected output color space.
      Therefore darktable avoids clamping as far as the underlying algorithms allow.
    </p>
               </body>
               
            </topic>
            <topic xml:lang="en-us" id="possible_color_artifacts">
               <title>Possible color artifacts</title>
               
               <prolog>
                  <metadata>
                     <keywords>
                        <indexterm>artifact mitigation<indexterm>blue light
                           sources</indexterm></indexterm>
                        <indexterm>artifact mitigation<indexterm>black
                           pixels</indexterm></indexterm>
                        <indexterm>gamut clipping</indexterm>
                     </keywords>
                  </metadata>
                  
               </prolog>
               <body>
                  <p>
      That said there are some infrequent situations which still can lead to problematic results
      unless the user takes some action. Some modules in Lab color space, like
      <xref href="#levels">
                        <i>levels</i>
                     </xref> and
      <xref href="#monochrome">
                        <i>monochrome</i>
                     </xref>, need to rely on the
      fact that the L channels carries all lightness information and the a and b channels purely
      represent chroma and hue. Unbounded colors with negative L values are especially
      problematic to these modules and can lead to black pixel artifacts.
    </p>
                  <p>
      It has been found that highly saturated blue light sources in the image frame are hot
      candidates for pixels with negative L values. If you are engaged in stage photography you
      should pay close attention to image areas like that.
    </p>
                  <p>
      In order to mitigate that issue the <i>input color profile</i> module (see
      <xref href="#input_color_profile"/>) has a <i>gamut clipping</i> option.
      It is off by default but can be activated in case you observe artifacts. Depending on the
      settings, colors get confined to one of the offered RGB gamuts. In effect black pixel
      artifacts are prevented at the costs of losing some color dynamics. See
      <xref href="#input_color_profile"/> for an example.
    </p>
               </body>
               
            </topic>
         </topic>
      </topic>
      <topic xml:lang="en-us" id="darkroom_panels">
         <title>Darkroom panels</title>
         
         <prolog>
            <metadata>
               <keywords>
                  <indexterm>darkroom panels</indexterm>
               </keywords>
            </metadata>
            
         </prolog>
         <body>
            <p>
    This section contains documentation for panels that are specific to the darkroom view.
  </p>
         </body>
         <topic xml:lang="en-us" id="infoline">
            <title>Image infos line</title>
            
            <prolog>
               <metadata>
                  <keywords>
                     <indexterm>darkroom panels<indexterm>image infos</indexterm></indexterm>
                     <indexterm>image infos</indexterm>
                  </keywords>
               </metadata>
               
            </prolog>
            <body>
               <table frame="none">
                  <tgroup colsep="0" rowsep="0" cols="2">
                     <colspec colwidth="6*"/>
                     <colspec colwidth="4*"/>
                     
                     <tbody>
                        <row>
                           <entry>
            You can display a line with very important image infos.
          </entry>
                           <entry>
                              <image href="images/infoline.png"
                                     align="center"
                                     placement="break"/>
                           </entry>
                        </row>
                     </tbody>
                  </tgroup>
               </table>
               <p>
    The content of this line can be set in preferences (see <xref href="gui_options"/>).
    Available variables are the same as for the export module (see <xref href="export_selected_usage_filename"/>).
    You can also add new lines by using <codeph>$(NL)</codeph> variable.
  </p>
               <p>
    Position of the infos line can also be set in preferences (see <xref href="gui_options"/>).
  </p>
            </body>
            
         </topic>
         <topic xml:lang="en-us" id="navigation">
            <title>Navigation</title>
            
            <prolog>
               <metadata>
                  <keywords>
                     <indexterm>darkroom panels<indexterm>navigation</indexterm></indexterm>
                     <indexterm>navigation</indexterm>
                     <indexterm>zoom</indexterm>
                  </keywords>
               </metadata>
               
            </prolog>
            <body>
               <table frame="none">
                  <tgroup colsep="0" rowsep="0" cols="2">
                     <colspec colwidth="6*"/>
                     <colspec colwidth="4*"/>
                     
                     <tbody>
                        <row>
                           <entry>
            On the top left hand side the navigation panel displays a full preview of your image
            with a rectangle showing the currently visible zoom area in the central panel. Drag
            the rectangle around to pan the zoomed-in view. The current zoom scale is displayed
            to the right of the preview image. Click on that figure for a quick access to some
            common zoom levels.
          </entry>
                           <entry>
                              <image href="images/panel_navigation.png"
                                     align="center"
                                     placement="break"/>
                           </entry>
                        </row>
                     </tbody>
                  </tgroup>
               </table>
            </body>
            
         </topic>
         <topic xml:lang="en-us" id="snapshots">
            <title>Snapshots</title>
            
            <prolog>
               <metadata>
                  <keywords>
                     <indexterm>darkroom panels<indexterm>snapshots</indexterm></indexterm>
                     <indexterm>snapshots</indexterm>
                  </keywords>
               </metadata>
               
            </prolog>
            <body>
               <table frame="none">
                  <tgroup colsep="0" rowsep="0" cols="2">
                     <colspec colwidth="6*"/>
                     <colspec colwidth="4*"/>
                     
                     <tbody>
                        <row>
                           <entry>
            You can take snapshots of images as you process them. A snapshot is stored as a
            bitmap of the current center view and is kept as long as you stay in the darkroom. A
            snapshot can then be selected and overlaid in the current center view to help you
            with a side by side comparison (left: snapshot, right: active) when you are tuning
            parameters of a module. This can also be combined with history (see
            <xref href="#history"/>) to compare the snapshot against different stages of
            development.
          </entry>
                           <entry>
                              <image href="images/panel_snapshots.png"
                                     align="center"
                                     placement="break"/>
                           </entry>
                        </row>
                     </tbody>
                  </tgroup>
               </table>
               <p>
    You can control the split view by moving the splitline back and forth. If you hover with the
    mouse over the splitline, a small rotation icon will appear on the center of the line. Click
    it to change between vertical and horizontal split view.
  </p>
            </body>
            
         </topic>
         <topic xml:lang="en-us" id="history">
            <title>History stack</title>
            
            <prolog>
               <metadata>
                  <keywords>
                     <indexterm>darkroom panels<indexterm>history stack</indexterm></indexterm>
                     <indexterm>history stack</indexterm>
                  </keywords>
               </metadata>
               
            </prolog>
            <body>
               <table frame="none">
                  <tgroup colsep="0" rowsep="0" cols="2">
                     <colspec colwidth="6*"/>
                     <colspec colwidth="4*"/>
                     
                     <tbody>
                        <row>
                           <entry>
                              <p>
              The history stack lists every change of state (activate/de-activated) for all
              modules. Here you can <i>select</i> a point in the stack to return
              to a point in the development history. If you then activate a new module or change
              a module parameter, all modules above the selected point will be discarded.
            </p>
                           </entry>
                           <entry>
                              <image href="images/panel_history.png"
                                     align="center"
                                     placement="break"/>
                           </entry>
                        </row>
                     </tbody>
                  </tgroup>
               </table>
               <p>
                  <note type="caution">Activating any module action using key accelerators will
                     discard all modules above the currently selected one. It is easy to lose all
                     development work on an image this way!</note>
               </p>
               <p>
    In darktable 2.0 it is safe to quit the program, leave the darkroom mode, or switch to
    another image while having selected some earlier state in the history stack panel. The
    history stack remains unchanged. When returning to the image you will find the history stack
    panel in the state where you left it.
  </p>
               <p>
    Hitting <q>compress history stack</q> generates the shortest history stack that
    produces the current image, i.e. suppressing all obsolete stack items. This also will
    discard all modules above the currently selected one.
  </p>
               <p>
    The button to the right
    <image href="../images/darkroom_styles.png" align="center"/>
    lets you create a new style for applying your history stack to other images. Use the first
    line of the popup dialog window to name your style and the second to add a searchable
    description. You are prompted for which of the current history stack modules to include in
    the style.
  </p>
               <p>
    Once created styles are then managed and applied to other images through lighttable's
    <i>styles</i> panel (see <xref href="stules"/>).
  </p>
            </body>
            
         </topic>
         <topic xml:lang="en-us" id="duplicate">
            <title>Duplicate manager</title>
            
            <prolog>
               <metadata><keywords>
                     <indexterm>darkroom panels<indexterm>duplicate</indexterm></indexterm>
                     <indexterm>duplicate</indexterm>
                  </keywords></metadata>
               
            </prolog>
            <body>
               <table frame="none">
                  <tgroup colsep="0" rowsep="0" cols="2">
                     <colspec colwidth="6*"/>
                     <colspec colwidth="4*"/>
                     
                     <tbody>
                        <row>
                           <entry>
            The duplicate manager lists all versions (see duplicate <xref href="selected_images"/>)
            of your image with their preview thumbnails.
            Single click on a thumbnail to temporarily show the related version inside the center view.
            Double click to completely switch to this version.
            Top-right buttons let you create new duplicates. Either a 'virgin' version, or an
            exact duplicate of the current image.
            For your convenience, you can also set a name to each versions.
          </entry>
                           <entry>
                              <image href="images/panel_duplicate.png"
                                     align="center"
                                     placement="break"/>
                           </entry>
                        </row>
                     </tbody>
                  </tgroup>
               </table>
            </body>
            
         </topic>
         <topic xml:lang="en-us" id="global_color_picker">
            <title>Global color picker</title>
            
            <prolog>
               <metadata><keywords>
                     <indexterm>darkroom panels<indexterm>color picker</indexterm></indexterm>
                     <indexterm>color picker</indexterm>
                  </keywords></metadata>
               
            </prolog>
            <body>
               <table frame="none">
                  <tgroup colsep="0" rowsep="0" cols="2">
                     <colspec colwidth="6*"/>
                     <colspec colwidth="4*"/>
                     
                     <tbody>
                        <row>
                           <entry>
                              <p>
              Using the global color picker you can take color samples from your image, display
              their values in multiple ways and compare colors from different locations. The
              color picker is activated by pressing the
              <image href="../images/darkroom_module_icon_picker.png" align="center"/>
              icon. There are multiple parameters for controlling how the color picker works,
              whose settings remain in effect until you leave the darkroom mode.
            </p>
                           </entry>
                           <entry>
                              <image href="images/panel_colorpicker.png"
                                     align="center"
                                     placement="break"/>
                           </entry>
                        </row>
                     </tbody>
                  </tgroup>
               </table>
               <p>
    Besides the global color picker described here there are also local color pickers in some of
    the modules (eg. <xref href="#tone_curve"> 
                     <i>tone curve</i>
                  </xref>). Global
    and local color pickers are different. The global color picker works in monitor color space
    and takes samples after the complete pixelpipe has been processed. The local color pickers
    run in the color space of the individual module, which is usually Lab; they reflect the
    input and output data of that specific module within pixelpipe.
  </p>
               <p>
    The global color picker can be run in point or area mode. When in point mode only a small
    spot under your cursor is taken as a sample. In area mode you can draw a rectangle and
    darktable samples the area within that rectangle. The combobox to switch between point and
    area mode can also be used to toggle the mode of local color pickers.
  </p>
               <p>
    If samples are taken in area mode, darktable will calculate mean, min and max color channel
    values. A combobox allows you to select which of those are displayed. For obvious
    statistical reasons mean, min and max are identical for the single sample of point mode.
  </p>
               <p>
    A color swatch representing the sampled point or area is displayed. Numerical values are
    shown as well. As said before global color picker works in monitor RGB color space. You can
    also let darktable translate these numerical values into Lab color space. Beware that Lab
    values are approximated here; depending on monitor color profile there can be some
    deviations from the real values.
  </p>
               <p>
    When the checkbox <q>restrict histogram to selection</q> is ticked, only the values
    of your selected area or point are taken into account by the main histogram at the top of
    the right hand panel (see <xref href="#histogram"/>). This is a way to show which tonal
    values are present in a specific area.
  </p>
               <p>
    The sampled colors in either area or point mode can be <q>stored</q> as live samples
    by pressing the <q>add</q> button. darktable will then show a color swatch and
    numerical values for each stored sample. You can once again select which numerical value
    (mean, min, max) is to be displayed and if this is to be done in RGB or Lab color space.
  </p>
               <p>
    Newly created live samples are not locked. If you change your image the changes will be
    reflected in your live samples. Use this if you want see how changing parameters effects
    different parts of an image. Clicking on a live sample's color swatch locks it and a lock
    symbol is displayed. Further image changes will then no longer affect the sample. You can
    for example take two live samples from the same location and lock just one of them to
    provide a before and after sample comparison.
  </p>
               <p>
    Live sample locations are indicated in your image if you check option <q>display sample
    areas on image</q>.
  </p>
            </body>
            
         </topic>
         <topic xml:lang="en-us" id="mask_manager">
            <title>Mask manager</title>
            
            <prolog>
               <metadata><keywords>
                     <indexterm>darkroom panels<indexterm>mask manager</indexterm></indexterm>
                     <indexterm>mask manager</indexterm>
                  </keywords></metadata>
               
            </prolog>
            <topic xml:lang="en-us" id="overview.d12e3447">
               <title>Overview</title>
               <body>
                  <p>
      The masks manager panel is the central place where you manage all masks and shapes within
      the context of the current image. Here you create, delete and change shapes or give them
      unique names. You can add shapes to and remove shapes from a mask, and you define how
      multiple shapes interact within a mask.
    </p>
               </body>
               
            </topic>
            <topic xml:lang="en-us" id="usage.d12e3456">
               <title>Usage</title>
               <body>
                  <table frame="none">
                     <tgroup colsep="0" rowsep="0" cols="2">
                        <colspec colwidth="6*"/>
                        <colspec colwidth="4*"/>
                        
                        <tbody>
                           <row>
                              <entry>
              In the top line of the masks manager panel you find buttons to create new shapes.
              They are the same as in the <i>drawn mask</i> GUI (see
              <xref href="#drawn_mask"/> for more details).
            </entry>
                              <entry>
                                 <image href="images/panel_maskmanager_1.png"
                                        align="center"
                                        placement="break"/>
                              </entry>
                           </row>
                        </tbody>
                     </tgroup>
                  </table>
                  <p>
      The lines below list all masks used and all individual shapes defined. The masks are noted
      with a headline in the form <q>grp levels</q> indicating the module in which they
      are used. The list of masks is followed by a list of all individual shapes which have been
      generated in the context of the given image. If a shape is in use by any of the masks it
      is marked by the
      <image href="../images/masks_used.png" align="center"/>
      symbol to the right of the shape name.
    </p>
               </body>
               
            </topic>
            <topic xml:lang="en-us" id="shapes.d12e3503">
               <title>Shapes</title>
               <body>
                  <p>
      By default shapes receive an automatically generated name, consisting of the shape type
      (<q>brush</q>, <q>circle</q>, <q>ellipse</q>, <q>path</q>,
      <q>gradient</q>) and a number that is incremented automatically. You can replace
      these automatically generated names by more meaningful ones. Double-clicking on the
      existing shape name prompts you for a new one. Giving a meaningful name is a good habit,
      especially if you are going to use the same selection in different masks. A name like
      <q>house front</q> makes it easier to get the right shape, rather than something
      like <q>path #32</q>.
    </p>
                  <p>
      Clicking on the shape name shows the selected shape in the center canvas with all its
      controls. This is a convenient way to edit the properties of a specific shape. Especially
      if there are so many shapes within a mask that their controls overlap and make it
      difficult to hit the right target.
    </p>
                  <p>
      Right-clicking on a shape name gives you a drop-down menu with the options to remove the
      current shape or to remove all shapes currently not in use.
    </p>
                  <p>
      All shapes ever defined for the current image are kept in the list unless you remove them
      explicitly. If you have worked a lot with shapes on one image, this list can get quite
      long. All settings – with all defined shapes – are part of the XMP
      tags of an image and are included in exported files. If the list of shapes is very long
      the needed space to store all shapes might exceed the given limits of certain file
      formats, like JPEG. In that case storing the XMP tags might fail during export. This is
      normally not a problem – however, you can no longer rely on the exported file
      to contain your full history stack (see <xref href="export_selected"/>).
    </p>
               </body>
               
            </topic>
            <topic xml:lang="en-us" id="masks.d12e3546">
               <title>Masks</title>
               <body>
                  <p>
      Clicking on the name of a mask expands a list showing the individual shapes which
      constitute that mask.
    </p>
                  <table frame="none">
                     <tgroup colsep="0" rowsep="0" cols="2">
                        <colspec colwidth="6*"/>
                        <colspec colwidth="4*"/>
                        
                        <tbody>
                           <row>
                              <entry>
              Right-clicking on the shape name opens a drop-down menu. Here you define the way
              that the individual shapes interact to form the mask. You can also remove shapes
              from that mask.
            </entry>
                              <entry>
                                 <image href="images/panel_maskmanager_2.png"
                                        align="center"
                                        placement="break"/>
                              </entry>
                           </row>
                        </tbody>
                     </tgroup>
                  </table>
                  <p>
      Masks are constructed by adding the shapes in the order that they are listed from top to
      bottom. Each shape adds to the mask by using at your choice one out of four logical set
      operators.
    </p>
                  <p>
      As order matters when combining shapes you may move each shape up or down if needed.
    </p>
                  <p>
      Each shape before being added can be inverted and is then depicted by the
      <image href="../images/masks_invert.png" align="center"/>
      symbol.
    </p>
               </body>
               
            </topic>
            <topic xml:lang="en-us" id="setOperators.d12e3594">
               <title>Set operators</title>
               <body>
                  <table frame="none">
                     <tgroup colsep="0" rowsep="0" cols="2">
                        <colspec colwidth="6*"/>
                        <colspec colwidth="4*"/>
                        
                        <tbody>
                           <row>
                              <entry>
              We use as an example a combination of a gradient followed by a path to demonstrate
              the effect of the set operator which we apply to the path shape. As a convention
              we say that a pixel is <q>selected</q> in a mask or shape if it has a
              value higher than zero.
            </entry>
                              <entry>
                                 <image href="images/panel_maskmanager_ex1.png"
                                        align="center"
                                        placement="break"/>
                              </entry>
                           </row>
                           <row>
                              <entry/>
                              <entry>
                                 <image href="images/panel_maskmanager_ex2.png"
                                        align="center"
                                        placement="break"/>
                              </entry>
                           </row>
                        </tbody>
                     </tgroup>
                  </table>
               </body>
               <topic xml:lang="en-us" id="union.d12e3640">
                  <title>union</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
                This is the default set operator. It is depicted by the
                <image href="../images/masks_union.png" align="center"/>
                symbol left to the shape name. The shape adds to the existing mask in such a way
                that the resulting mask contains the pixels that are either selected in the
                existing mask or in the added shape. In overlapping areas the maximum value is
                taken.
              </entry>
                                 <entry>
                                    <image href="images/panel_maskmanager_ex3.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="intersection.d12e3676">
                  <title>intersection</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
                This set operator is depicted by the
                <image href="../images/masks_intersection.png" align="center"/>
                symbol left to the shape name. The shape adds to the existing mask in such a way
                that the resulting mask contains only pixels that are selected in both, the
                existing mask and the added shape. In overlapping areas the minimum value is
                used. In the given example we use this operator to <q>imprint</q> the
                path with a gradient.
              </entry>
                                 <entry>
                                    <image href="images/panel_maskmanager_ex4.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="difference.d12e3715">
                  <title>difference</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
                This set operator is depicted by the
                <image href="../images/masks_difference.png" align="center"/>
                symbol. In the non-overlapping area the existing mask is unchanged. In the
                resulting mask pixels get selected only if they are selected in the existing
                mask but <i>not</i> in the added shape. This set operator can be
                chosen if you want to <q>cut out</q> a region from within an existing
                selection.
              </entry>
                                 <entry>
                                    <image href="images/panel_maskmanager_ex5.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="exclusion.d12e3757">
                  <title>exclusion</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
                This set operator is depicted by the
                <image href="../images/masks_exclusion.png" align="center"/>
                symbol. The resulting mask has all pixels selected that are either selected in
                the existing mask and not in the added shape or vice versa. This is equivalent
                to an <q>exclusive or</q>.
              </entry>
                                 <entry>
                                    <image href="images/panel_maskmanager_ex6.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
            </topic>
         </topic>
         <topic xml:lang="en-us" id="histogram">
            <title>Histogram</title>
            
            <prolog>
               <metadata><keywords>
                     <indexterm>darkroom panels<indexterm>histogram</indexterm></indexterm>
                     <indexterm>histogram</indexterm>
                  </keywords></metadata>
               
            </prolog>
            <body>
               <table frame="none">
                  <tgroup colsep="0" rowsep="0" cols="2">
                     <colspec colwidth="6*"/>
                     <colspec colwidth="4*"/>
                     
                     <tbody>
                        <row>
                           <entry>
                              <p>
              This shows a histogram of the developed image's light levels. In its default state
              curves for all three RGB color channels are displayed. You can toggle the colored
              squares to enable or disable specific color channels. A curve button is also
              provided to toggle between linear view, logarithmic view and waveform view.
            </p>

                              <p>
              The histogram is directly linked to the <i>exposure</i> module
              described in <xref href="#exposure"/>, and you can operate some of the exposure
              module's controls from the histogram. You can left-click towards the right hand
              side of the histogram and then drag right to increase or drag left to decrease the
              exposure. In a similar manner you can control the black level by clicking and
              dragging in the left hand side. Double-clicking in the histogram resets the
              exposure module's parameters to their defaults.
            </p>
                           </entry>
                           <entry>
                              <image href="images/panel_histogram.png"
                                     align="center"
                                     placement="break"/>
                           </entry>
                        </row>
                     </tbody>
                  </tgroup>
               </table>
            </body>
            
         </topic>
         <topic xml:lang="en-us" id="module_groups">
            <title>Module groups</title>
            
            <prolog>
               <metadata><keywords>
                     <indexterm>darkroom panels<indexterm>module groups</indexterm></indexterm>
                     <indexterm>module groups</indexterm>
                  </keywords></metadata>
               
            </prolog>
            <body>
               <table frame="none">
                  <tgroup colsep="0" rowsep="0" cols="2">
                     <colspec colwidth="6*"/>
                     <colspec colwidth="4*"/>
                     
                     <tbody>
                        <row>
                           <entry>
                              <p>
              The module groups button bar gives you quick access to darktable's processing
              modules.
            </p>
                           </entry>
                           <entry>
                              <image href="images/panel_modulegroups.png"
                                     align="center"
                                     placement="break"/>
                           </entry>
                        </row>
                     </tbody>
                  </tgroup>
               </table>
               <p>
    Here follows a description of the module groups available:
  </p>
               <p>
                  <table frame="none">
                     <tgroup colsep="0" rowsep="0" cols="3">
                        <colspec colwidth="2*"/>
                        <colspec colwidth="2*"/>
                        <colspec colwidth="6*"/>
                        
                        <tbody>
                           <row>
                              <entry>
                                 <image href="images/darkroom_group_active.png"
                                        align="center"
                                        placement="break"/>
                              </entry>
                              <entry>
              Active
            </entry>
                              <entry>
              Modules you have activated and are using on the current image.
            </entry>
                           </row>
                           <row>
                              <entry>
                                 <image href="images/darkroom_group_favorites.png"
                                        align="center"
                                        placement="break"/>
                              </entry>
                              <entry>
              Favorites
            </entry>
                              <entry>
              Modules you have marked as favorites using <i>more modules</i> (see
              <xref href="#more_modules"/>).
            </entry>
                           </row>
                           <row>
                              <entry>
                                 <image href="images/darkroom_group_basic.png"
                                        align="center"
                                        placement="break"/>
                              </entry>
                              <entry>
              Basic
            </entry>
                              <entry>
              Modules that are frequently used, such as exposure, temperature etc. (see
              <xref href="#basic_group"/>).
            </entry>
                           </row>
                           <row>
                              <entry>
                                 <image href="images/darkroom_group_tone.png"
                                        align="center"
                                        placement="break"/>
                              </entry>
                              <entry>
              Tone
            </entry>
                              <entry>
              Modules for working with the image's tonal values, e.g. levels, tonemap etc. (see
              <xref href="#tone_group"/>).
            </entry>
                           </row>
                           <row>
                              <entry>
                                 <image href="images/darkroom_group_color.png"
                                        align="center"
                                        placement="break"/>
                              </entry>
                              <entry>
              Color
            </entry>
                              <entry>
              Modules for processing colors, such as color correction, vibrance etc. (see
              <xref href="#color_group"/>).
            </entry>
                           </row>
                           <row>
                              <entry>
                                 <image href="images/darkroom_group_correction.png"
                                        align="center"
                                        placement="break"/>
                              </entry>
                              <entry>
              Correction
            </entry>
                              <entry>
              Modules making corrections to the image, e.g. denoise, CA correction etc. (see
              <xref href="#correction_group"/>).
            </entry>
                           </row>
                           <row>
                              <entry>
                                 <image href="images/darkroom_group_effect.png"
                                        align="center"
                                        placement="break"/>
                              </entry>
                              <entry>
              Effect
            </entry>
                              <entry>
              Modules with a more artistic output, such as vignetting, softening etc. (see
              <xref href="#effect_group"/>).
            </entry>
                           </row>
                        </tbody>
                     </tgroup>
                  </table>
               </p>
               <p>
    Clicking on one of the group symbols will show the modules in that group. If you once again
    click on the symbol, grouping will be de-activated and all non-hidden modules will be shown
    in one long list. This list shows the sequence in which modules are applied from bottom to
    top. As a general principle darktable applies modules in a pre-defined sequence.
  </p>
            </body>
            
         </topic>
         <topic xml:lang="en-us" id="more_modules">
            <title>More modules</title>
            
            <prolog>
               <metadata><keywords>
                     <indexterm>darkroom panels<indexterm>more modules</indexterm></indexterm>
                     <indexterm>more modules</indexterm>
                  </keywords></metadata>
               
            </prolog>
            <body>
               <table frame="none">
                  <tgroup colsep="0" rowsep="0" cols="2">
                     <colspec colwidth="6*"/>
                     <colspec colwidth="4*"/>
                     
                     <tbody>
                        <row>
                           <entry>
            More modules at the bottom of the right panel is used to show the less frequently
            used modules. By default only standard modules are shown to the user but you can use
            this function to make the extra modules visible, or alternatively to hide away
            modules you don't typically use.
          </entry>
                           <entry>
                              <image href="images/panel_moremodules.png"
                                     align="center"
                                     placement="break"/>
                           </entry>
                        </row>
                     </tbody>
                  </tgroup>
               </table>
               <p>
    Each module is shown with a small icon next to its name. Left-click with your mouse to
    toggle the status between visible, hidden and favorite. Favorite modules are indicated by a
    star in front of the icon and in addition to appearing in their normal module group will
    also be visible in the module group
    <xref href="#module_groups">
                     <i>favorites</i>
                  </xref>. This is a good way to
    get fast access to modules that you use very frequently. Visible modules are indicated in
    the list by a light grey background whilst hidden modules have a dark grey background and do
    not display any of their controls.
  </p>
               <p>
    Hiding or un-hiding modules is not meant to be part of your daily workflow, you should only
    occasionally need to review the modules you typically use. However, you may store various
    settings at your choice as presets for later reuse.
  </p>
            </body>
            
         </topic>
         <topic xml:lang="en-us" id="darkroom_bottom_panel">
            <title>Bottom panel</title>
            
            <prolog>
               <metadata><keywords>
                     <indexterm>darkroom panels<indexterm>bottom panel</indexterm></indexterm>
                  </keywords></metadata>
               
            </prolog>
            <body>
               <p>
    The bottom panel provides quick access to apply presets and styles to your image and allows
    to activate over/underexposure warning as well as softproofing and gamut check. You can also
    activate a filmstrip for quick navigation within the current collection.
  </p>
            </body>
            <topic xml:lang="en-us" id="favorite_presets">
               <title>Quick access to favorite presets</title>
               <body>
                  <p>
      Clicking the
      <image href="../images/darkroom_module_icon_presets.png" align="center"/>
      icon opens a combobox that gives you quick access to your favorite module's presets. Click
      on the preset name to apply it to the image.
    </p>
               </body>
               
            </topic>
            <topic xml:lang="en-us" id="darkroom_bottom_panel_styles">
               <title>Quick access to styles</title>
               <body>
                  <p>
      Clicking the
      <image href="../images/darkroom_styles.png" align="center"/>
      icon opens a combobox with your styles. Hovering with the mouse over a style name opens a
      tooltip showing the involved modules. Click on a style name to apply that style to the
      image.
    </p>
               </body>
               
            </topic>
            <topic xml:lang="en-us" id="rawoverexposed">
               <title>Raw overexposed warning</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>darkroom panels<indexterm>raw overexposed
                           warning</indexterm></indexterm>
                        <indexterm>raw overexposed warning</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <body>
                  <p>
      Clicking the
      <image href="../images/darkroom_module_icon_rawoverexposed.png" align="center"/>
      icon warns you about areas of your raw input image with clipped color channels. Clipped
      color channels imply an overexposed image with loss of information in the affected areas.
      You may use the <i>highlight reconstruction</i> module or the
      <i>color reconstruction</i> module in order to reconstruct those areas (see
      <xref href="#highlight_reconstruction"/> and <xref href="#color_reconstruction"/>).
    </p>
                  <table frame="none">
                     <tgroup colsep="0" rowsep="0" cols="2">
                        <colspec colwidth="6*"/>
                        <colspec colwidth="4*"/>
                        
                        <tbody>
                           <row>
                              <entry>
              Right-clicking on the icon opens a dialog with configuration parameters.
            </entry>
                              <entry>
                                 <image href="images/panel_rawoverexposed.png"
                                        align="center"
                                        placement="break"/>
                              </entry>
                           </row>
                        </tbody>
                     </tgroup>
                  </table>
                  <p>
                     <b>mode</b>
                  </p>
                  <p>
      The default <q>mark with CFA color</q> mode displays a pattern of the respective
      primary colors (red, green, and blue) to indicate which color channels are found to be
      clipped. In the <q>mark with solid color</q> mode clipped areas are marked with a
      user defined solid color (see below) independent of the affected color channels. In the
      <q>false color</q> mode clipped color channels are set to zero in the affected
      areas.
    </p>
                  <p>
                     <b>color scheme</b>
                  </p>
                  <p>
      Selects the solid color for the <q>mark with solid color</q> mode.
    </p>
                  <p>
                     <b>clipping threshold</b>
                  </p>
                  <p>
      This slider sets the threshold of what values are considered to be overexposed. You can
      leave it at its default value 1.0 (white level) in most cases.
    </p>
               </body>
               
            </topic>
            <topic xml:lang="en-us" id="overexposed">
               <title>Over/underexposed warning</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>darkroom panels<indexterm>overexposed
                           warning</indexterm></indexterm>
                        <indexterm>darkroom panels<indexterm>underexposed
                           warning</indexterm></indexterm>
                        <indexterm>overexposed warning</indexterm>
                        <indexterm>underexposed warning</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <body>
                  <p>
      By clicking the
      <image href="../images/darkroom_module_icon_overexposed.png" align="center"/>
      icon an over/underexposed warning is toggled on or off. Pixels outside the dynamic range,
      close to pure white or close to pure black, are prominently displayed in a signal color.
      You can also activate the over/underexposure warning with the keyboard shortcut
      <q>O</q>.
    </p>
                  <table frame="none">
                     <tgroup colsep="0" rowsep="0" cols="2">
                        <colspec colwidth="6*"/>
                        <colspec colwidth="4*"/>
                        
                        <tbody>
                           <row>
                              <entry>
              Right-clicking on the icon opens a dialog with configuration parameters.
            </entry>
                              <entry>
                                 <image href="images/panel_overexposed.png"
                                        align="center"
                                        placement="break"/>
                              </entry>
                           </row>
                        </tbody>
                     </tgroup>
                  </table>
                  <p>
                     <b>color scheme</b>
                  </p>
                  <p>
      In the default color scheme underexposed pixels are shown in blue and overexposed pixels
      in red. These colors are easy to identify in most cases. In some cases you may want to
      change the color scheme to <q>black &amp; white</q> or <q>purple &amp;
      green</q>, eg. if you experience overexposed highlights in red blossoms.
    </p>
                  <p>
                     <b>lower threshold</b>
                  </p>
                  <p>
      Sets the threshold for underexposure warning, expressed as a percentage of the maximal
      brightness.
    </p>
                  <p>
                     <b>upper threshold</b>
                  </p>
                  <p>
      Sets the threshold for overexposure warning, expressed as a percentage of the maximal
      brightness.
    </p>
               </body>
               
            </topic>
            <topic xml:lang="en-us" id="softproof">
               <title>Soft proof</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>darkroom panels<indexterm>soft proof</indexterm></indexterm>
                        <indexterm>soft proof</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <body>
                  <p>
      Clicking the
      <image href="../images/darkroom_module_icon_softproof.png" align="center"/>
      icon activates the soft proof display mode of your image. Soft proof allows you to preview
      your image rendered using a printer profile so as to see how colors will end up on the
      final print. You can also activate soft proof with the keyboard shortcut
      <q>Ctrl+S</q>. An information message <q>soft proof</q> on the bottom left
      of your image tells you that you are in soft proof display mode.
    </p>
                  <table frame="none">
                     <tgroup colsep="0" rowsep="0" cols="2">
                        <colspec colwidth="6*"/>
                        <colspec colwidth="4*"/>
                        
                        <tbody>
                           <row>
                              <entry>
              Right-clicking on the icon opens a dialog with configuration parameters.
            </entry>
                              <entry>
                                 <image href="images/panel_softproof.png"
                                        align="center"
                                        placement="break"/>
                              </entry>
                           </row>
                        </tbody>
                     </tgroup>
                  </table>
                  <p>
                     <b>display intent</b>
                  </p>
                  <p>
      Sets the rendering intent for your display – only available if rendering with
      LittleCMS2 is activated. See <xref href="#rendering_intent"/> for available options.
    </p>
                  <p>
                     <b>softproof profile</b>
                  </p>
                  <p>
      Sets the color profile for soft proofing. darktable searches for available profiles in
      <filepath>$DARKTABLE/share/darktable/color/out</filepath> and
      <filepath>$HOME/.config/darktable/color/out</filepath>. <filepath>$DARKTABLE</filepath> is
      used here to represent your chosen darktable installation directory and
      <filepath>$HOME</filepath> your home directory. Typically these profiles are supplied by
      your printer or generated during printer profiling.
    </p>
                  <p>
                     <b>display profile</b>
                  </p>
                  <p> Sets the color profile for the display. The option <q>system display
                        profile</q> is the preferred setting when working with a calibrated display;
                     the profile is taken either from your system's color manager or from your X
                     display server. In <i>GUI options</i> (see <xref href="gui_options"/>) you
                     can specify which method to use. For more information see <xref
                        href="#display_profile"/>. </p>
               </body>
               
            </topic>
            <topic xml:lang="en-us" id="gamutcheck">
               <title>Gamut check</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>darkroom panels<indexterm>gamut check</indexterm></indexterm>
                        <indexterm>gamut check</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <body>
                  <p>
      Clicking the
      <image href="../images/darkroom_module_icon_gamutcheck.png" align="center"/>
      icon activates the gamut check display mode of your image. Gamut check highlights in cyan
      all pixels out of gamut with respect to the selected softproof profile. You can also
      activate gamut check with the keyboard shortcut <q>Ctrl+G</q>. An information
      message <q>gamut check</q> on the bottom left of your image tells you that you are
      in gamut check display mode. Gamut check and soft proof are mutually exclusive modes.
    </p>
                  <p>
      Right-clicking on the icon opens a dialog with configuration parameters – they
      are the same as for the soft proof option (see <xref href="#softproof"/>).
    </p>
               </body>
               
            </topic>
            <topic xml:lang="en-us" id="darkroom_filmstrip">
               <title>Filmstrip</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>darkroom panels<indexterm>filmstrip</indexterm></indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <body>
                  <p>
      The optional filmstrip can be used to quickly switch between images while remaining in the
      darkroom view. The images viewed are the same as the ones in the lighttable view.
    </p>
                  <p>
      The filmstrip can be switched on and off using the shortcut <i>Ctrl+F</i>.
      You can change the height of the filmstrip panel by dragging its top.
    </p>
                  <p>
      You can scroll with your mouse to quickly navigate through the images. You can change the
      photo being processed by double clicking on another picture. You can also use Spacebar to
      process the next photo and use Backspace key to process the previous photo.
    </p>
                  <p>
      The picture currently processed is selected and highlighted; with a single click you can
      select any other picture from the filmstrip without changing the picture currently
      processed. With the <i>Ctrl+A</i> shortcut you select all the pictures of
      the filmstrip. With the shortcut <i>Ctrl+Shift+A</i> you unselect all
      images, and with <i>Ctrl+I</i> you reverse the current selection.
    </p>
                  <p>
      The following shortcuts are available to act on the selected picture(s):
      <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="1*"/>
                           <colspec colwidth="3*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
                                    <i>F1 – F5</i>
                                 </entry>
                                 <entry>
                toggle color label (red, yellow, green, blue, purple)
              </entry>
                              </row>
                              <row>
                                 <entry>
                                    <i>0 – 5</i>
                                 </entry>
                                 <entry>
                set/change image rating
              </entry>
                              </row>
                              <row>
                                 <entry>
                                    <i>R</i>
                                 </entry>
                                 <entry>
                reject image
              </entry>
                              </row>
                              <row>
                                 <entry>
                                    <i>Ctrl+D</i>
                                 </entry>
                                 <entry>
                duplicate image
              </entry>
                              </row>
                              <row>
                                 <entry>
                                    <i>Ctrl+C</i>
                                 </entry>
                                 <entry>
                copy the full history stack
              </entry>
                              </row>
                              <row>
                                 <entry>
                                    <i>Ctrl+V</i>
                                 </entry>
                                 <entry>
                paste all of the copied history stack
              </entry>
                              </row>
                              <row>
                                 <entry>
                                    <i>Alt+Ctrl+C</i>
                                 </entry>
                                 <entry>
                selectively copy the history stack
              </entry>
                              </row>
                              <row>
                                 <entry>
                                    <i>Alt+Ctrl+V</i>
                                 </entry>
                                 <entry>
                selectively paste from the copied history stack
              </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </p>
                  <p>
                     <image href="images/filmstrip.png"
                            align="center"
                            placement="break"/>
                  </p>
               </body>
               
            </topic>
         </topic>
      </topic>
      <topic xml:lang="en-us" id="modules">
         <title>Modules</title>
         
         <prolog>
            <metadata><keywords>
                  <indexterm>modules</indexterm>
               </keywords></metadata>
            
         </prolog>
         <body>
            <p>
    Modules are organized into five functional groups: basic, tone, color, correction and
    effect. You either view all modules in one long list or instead click on a group to just
    display modules belonging to that group.
  </p>
         </body>
         <topic xml:lang="en-us" id="basic_group">
            <title>Basic group</title>
            <body>
               <p>
    The basic group of modules contains the modules for basic development. These are ones you
    probably will use most often, such as exposure, white balance etc.
  </p>
            </body>
            <topic xml:lang="en-us" id="crop_and_rotate">
               <title>Crop and rotate</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>crop and rotate</indexterm></indexterm>
                        <indexterm>crop and rotate</indexterm>
                        <indexterm>cropping an image</indexterm>
                        <indexterm>rotating an image</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e4720">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module is used to crop, rotate and correct perspective distortions of your
              image. You can overlay your image with various helpful guidelines that assist you
              using the tools.
            </entry>
                                 <entry>
                                    <image href="modules/images/crop_and_rotate.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                     <p>
      Some of the tools of this module, namely adjustment of angle and corrections of
      perspective distortion, will require the original image data to be interpolated. For best
      sharpness results set <q>lanczos3</q> as pixel interpolator in <i>core
      options</i> (see <xref href="core_options"/>).
    </p>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e4764">
                  <title>Usage</title>
                  <body>
                     <p>
      Whenever the user interface of this module is in focus, you will see the full uncropped
      image overlaid with handles and guiding lines.
    </p>
                     <p>
      First off, select what aspect ratio you want and size the crop boundaries by dragging
      border and corner handles. Use the button right of the aspect box, to swap between
      portrait and landscape mode. You can move around the crop rectangle by holding down left
      mouse button and move around. When you are done and want to execute the crop, just give
      focus to another module or double-click into the image base. You can at any time change
      your crop area by just revisiting this module.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="flip.d12e4775">
                     <title>flip</title>
                     <body>
                        <p>
        This tool is used to flip the image on the horizontal,vertical or both axis.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="angle.d12e4784">
                     <title>angle</title>
                     <body>
                        <p>
        This tool corrects the rotation angle helping you level an image. You can either set a
        numerical value or use your mouse directly on the image. To use your mouse, right-click,
        hold it down and draw a line along a suited horizontal or vertical feature; as soon as
        you release the mouse button the image is rotated so the line you drew matches the
        horizontal/vertical axis.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="keystone.d12e4793">
                     <title>keystone</title>
                     <body>
                        <p>
        This tool is used to correct perspective distortions in your image. Useful for example
        when you shoot a high building from ground with a short focal length, aiming upwards
        with your camera. The combobox lets you select the type of correction you want to use :
      </p>
                        <p>
                           <table frame="none">
                              <tgroup colsep="0" rowsep="0" cols="2">
                                 <colspec colwidth="3cm"/>
                                 <colspec colwidth="3cm"/>
                                 
                                 <tbody>
                                    <row>
                                       <entry>
                                          <i>vertical</i>
                                       </entry>
                                       <entry>
                  if you want to limit the correction to vertical lines
                </entry>
                                    </row>
                                    <row>
                                       <entry>
                                          <i>horizontal</i>
                                       </entry>
                                       <entry>
                  limit the correction to horizontal lines
                </entry>
                                    </row>
                                    <row>
                                       <entry>
                                          <i>free</i>
                                       </entry>
                                       <entry>
                  if you want to correct horizontal and vertical lines
                </entry>
                                    </row>
                                 </tbody>
                              </tgroup>
                           </table>
                        </p>
                        <p>
                           <table frame="none">
                              <tgroup colsep="0" rowsep="0" cols="3">
                                 <colspec colwidth="6*"/>
                                 <colspec colwidth="2*"/>
                                 <colspec colwidth="2*"/>
                                 
                                 <tbody>
                                    <row>
                                       <entry>
                                          <p>
                    Depending on the selected correction type you will see two or four straight
                    adjustment lines overlaid to your image. Two red circles on every line let
                    you modify the line positions with your mouse. Each line additionally
                    carries a <q>symmetry</q> button. If activated (and highlighted in
                    red) all movements of the affected line will be mirrored by the opposite
                    line.
                  </p>

                                          <p>
                    In order to correct perspective distortions, you need to find suitable
                    horizontal and/or vertical features in your image and align the adjustment
                    lines with them. When done, press the <q>OK</q> button, which is
                    located close to the center of your image. The image will be corrected
                    immediately. You can at any time come back and refine your corrections by
                    selecting <q>correction applied</q> in combobox keystone.
                  </p>
                                       </entry>
                                       <entry>
                                          <image href="modules/images/crop_and_rotate_k_set.png"
                                                 align="center"
                                                 placement="break"/>
                                       </entry>
                                       <entry>
                                          <image href="modules/images/crop_and_rotate_k_applied.png"
                                                 align="center"
                                                 placement="break"/>
                                       </entry>
                                    </row>
                                 </tbody>
                              </tgroup>
                           </table>
                        </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="automaticCropping.d12e4908">
                     <title>automatic cropping</title>
                     <body>
                        <p>
        Use this options to avoid black edges on the image borders. Useful when you rotate the
        image.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="aspect.d12e4917">
                     <title>aspect</title>
                     <body>
                        <p>
        Here you can change what aspect ratio you want to have on the result, thus constraining
        the proportion of width and height of the crop rectangle to the aspect ratio of your
        choice. Many common numerical ratios are pre-defined. A few special aspect ratios
        deserve explanation:
      </p>
                        <p>
                           <table frame="none">
                              <tgroup colsep="0" rowsep="0" cols="2">
                                 <colspec colwidth="3cm"/>
                                 <colspec colwidth="3cm"/>
                                 
                                 <tbody>
                                    <row>
                                       <entry>
                                          <i>free</i>
                                       </entry>
                                       <entry>
                  free forming the rectangle without any ratio restrictions
                </entry>
                                    </row>
                                    <row>
                                       <entry>
                                          <i>image</i>
                                       </entry>
                                       <entry>
                  this option constrains the ratio to be equal to image ratio
                </entry>
                                    </row>
                                    <row>
                                       <entry>
                                          <i>golden cut</i>
                                       </entry>
                                       <entry>
                  this option constrains the ratio to be equal the golden number
                </entry>
                                    </row>
                                    <row>
                                       <entry>
                                          <i>square</i>
                                       </entry>
                                       <entry>
                  this option constrains the ratio to be 1
                </entry>
                                    </row>
                                 </tbody>
                              </tgroup>
                           </table>
                        </p>
                        <p>
        You can also select any other ratio after opening the combobox and typing it in the form
        of <q>x:y</q>. If you want a certain aspect ratio to be added to the pre-defined
        ones you can do so by including a line of the form
      </p>
                        <p>
                           <pre>plugins/darkroom/clipping/extra_aspect_ratios/foo=x:y
</pre>
                        </p>
                        <p>
        into darktable's configuration file
        <filepath>$HOME/.config/darktable/darktablerc</filepath>. Here <q>foo</q>
        defines the name of the new aspect ratio and <q>x</q> and <q>y</q> the
        corresponding numerical values.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="guides.d12e5017">
                     <title>guides</title>
                     <body>
                        <p>
        Many self-explaining guides are available to help you compose your image.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="guidesFlip.d12e5026">
                     <title>guides flip</title>
                     <body>
                        <p>
        In case the chosen guidelines are not symmetrical relative to the image frame, you can
        flip them on the horizontal,vertical or both axis.
      </p>
                     </body>
                     
                  </topic>
               </topic>
               <topic xml:lang="en-us" id="examples.d12e5036">
                  <title>Examples</title>
                  <body>
                     <p>
                        <table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="2">
                              <colspec colwidth="4*"/>
                              <colspec colwidth="6*"/>
                              
                              <tbody>
                                 <row>
                                    <entry>
                                       <image href="modules/images/crop_and_rotate_ex1.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                A cropped image in center view when module crop and rotate is in focus. The
                cropped area is visible as well as some guiding lines.
              </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table>
                     </p>
                  </body>
                  
               </topic>
            </topic>
            <topic xml:lang="en-us" id="orientation">
               <title>Orientation</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>orientation</indexterm></indexterm>
                        <indexterm>orientation</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e5092">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module allows the user to modify the orientation of an image. By default it
              is active for all images and receives its standard settings from the camera's
              orientation flag stored in the Exif data.
            </entry>
                                 <entry>
                                    <image href="modules/images/orientation.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e5124">
                  <title>Usage</title>
                  <topic xml:lang="en-us" id="rotate.d12e5129">
                     <title>rotate</title>
                     <body>
                        <p>
        Clicking on one of the buttons causes a counter-clockwise or clockwise rotation in steps
        of 90 degrees.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="shadows_and_highlights">
               <title>Shadows and Highlights</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>shadows and highlights</indexterm></indexterm>
                        <indexterm>shadows and highlights</indexterm>
                        <indexterm>artifact mitigation<indexterm>halos</indexterm></indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e5169">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              The shadows and highlights module allows adjustment to the tonal range of darker
              parts of an image (shadows) and lighter parts (highlights); it can bring back
              details in shadows and highlights by enhancing local contrast.
            </entry>
                                 <entry>
                                    <image href="modules/images/shadhi.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e5201">
                  <title>Usage</title>
                  <topic xml:lang="en-us" id="shadows.d12e5206">
                     <title>shadows</title>
                     <body>
                        <p>
        This slider controls the effect on shadows; positive values will lighten up shadows
        while negative values will darken them.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="highlights.d12e5215">
                     <title>highlights</title>
                     <body>
                        <p>
        This slider controls the effect on highlights; negative values will darken highlights
        while positive values will lighten them up.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="whitePointAdjustment.d12e5224">
                     <title>white point adjustment</title>
                     <body>
                        <p>
        By default the algorithm of this modules leaves black point and white point untouched.
        In some cases an image might contain tonal variations beyond the white point, i.e. above
        a luminance value of 100. A negative shift in the white point adjustment slider allows
        to bring these values down into the proper range so that further details in the
        highlights get visible.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="softenWith.d12e5233">
                     <title>soften with</title>
                     <body>
                        <p>
        This combobox chooses the underlying blurring filter, gaussian or bilateral. Try
        bilateral filter if you experience halos with gaussian blur.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="radius.d12e5242">
                     <title>radius</title>
                     <body>
                        <p>
        This slider controls the radius of the involved blurring filter. Higher values give
        softer transitions between shadows and highlights but might introduce halos. Lower
        values will reduce the size of halos but may lead to an artificial look. As said,
        bilateral filter is much less prone to halo artifacts.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="compress.d12e5252">
                     <title>compress</title>
                     <body>
                        <p>
        This slider controls how strong the effect extends to midtones; high values reduce the
        effect to the extreme shadows and highlights; low values cause strong adjustments also
        to midtones. You normally only need to touch this parameter if you want to limit the
        effects to the extreme shadows and highlights; increase the value in this case. At 100%
        this module has no visible effect any longer as only absolute black and absolute white
        are affected.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="shadowsColorAdjustment.d12e5261">
                     <title>shadows color adjustment</title>
                     <body>
                        <p>
        This slider controls the color saturation adjustment made to shadows; high values cause
        saturation enhancements on lightened shadows; low values cause desaturation on lightened
        shadows. It is normally safe to leave this at its default of 100%. This gives a natural
        saturation boost on shadows – similar to the one you would also expect in
        nature if shadows would receive more light.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="highlightsColorAdjustment.d12e5270">
                     <title>highlights color adjustment</title>
                     <body>
                        <p>
        This slider controls the color saturation adjustment made to highlights; high values
        cause saturation enhancements on darkened highlights; low values cause desaturation on
        darkened highlights. Often highlights do not contain enough color information to give
        convincing colors when darkened. You might need to play a bit with this parameter in
        order to find the best fitting value depending on your specific image; but be aware that
        sometimes results still might not be fully satisfying.
      </p>
                     </body>
                     
                  </topic>
               </topic>
               <topic xml:lang="en-us" id="examples.d12e5281">
                  <title>Examples</title>
                  <body>
                     <p>
                        <table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="2">
                              <colspec colwidth="4*"/>
                              <colspec colwidth="6*"/>
                              
                              <tbody>
                                 <row>
                                    <entry>
                                       <image href="modules/images/shadhi_ex1.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                Original image exposed for the outer sunlit wall to avoid clipped highlights. As
                a consequence the interior of the barn has pitch black shadows.
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                                       <image href="modules/images/shadhi_ex2.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                Shadows get lightened; highlights are untouched; overall effect toned down a bit
                by <xref href="#blending_operators">
                                          <i>blend mode</i>
                                       </xref>
                                       <q>normal</q> and an opacity of 65%.
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                                       <image href="modules/images/shadhi_ex3.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                Resulting image.
              </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table>
                     </p>
                  </body>
                  
               </topic>
            </topic>
            <topic xml:lang="en-us" id="base_curve">
               <title>Base curve</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>base curve</indexterm></indexterm>
                        <indexterm>base curve</indexterm>
                        <indexterm>exposure fusion</indexterm>
                        <indexterm>exposure bias</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e5382">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              Camera sensors provide data in linear RGB format, the original image appears flat
              and dull. That's the reason why camera manufacturers apply their characteristic
              base curves to the raw data when they generate in-camera JPEG images with better
              colors and contrast.
            </entry>
                                 <entry>
                                    <image href="modules/images/basecurve.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e5415">
                  <title>Usage</title>
                  <body>
                     <p>
      darktable comes with base curve presets that mimic the curves of various manufacturers.
      These are automatically applied to raw images according to the manufacturer ID found in
      Exif data. For several camera models darktable comes with base curves adapted for that
      specific model. A configuration option in the core preferences dialog (see
      <xref href="core_options"/>) defines whether darktable by default should apply the
      per-camera base curve or the manufacturer one.
    </p>
                     <p>
      You can adjust an existing base curve or create a new one. The base curve is defined by
      two or more nodes. You can move any node to modify the curve. You can also create
      additional nodes by <i>clicking</i> on a curve segment between two nodes.
      With <i>Ctrl+click</i> you generate a new node at the x-location of the
      mouse pointer and the corresponding y-location of the current curve – this adds
      a node without risking to accidentally modify the curve. In order to remove a node move it
      outside of the widget area.
    </p>
                     <p>
      Tip: If you intend to take full manual control of the tonal values with the <i>tone
      curve</i> module or the <i>zone system</i> module (see
      <xref href="#tone_curve"/> and <xref href="#zone_system"/>) it may be easier to leave
      the image in linear RGB. Disable the <i>base curve</i> module in this case.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="scale.d12e5450">
                     <title>scale</title>
                     <body>
                        <p>
        This combobox toggles between <q>linear</q> and <q>logarithmic</q> view.
        In the double logarithmic view more space is given to the lower values allowing a more
        fine-grained adjustment of the shadows.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="fusion.d12e5465">
                     <title>fusion</title>
                     <body>
                        <p>
        This control triggers the
        <xref href="https://en.wikipedia.org/wiki/Exposure_Fusion"
                                 format="html"
                                 scope="external">
                              <i>exposure
        fusion</i>
                           </xref> feature. You can choose to merge the image with one or two
        copies of itself after applying the current base curve and boosting its exposure by a
        selectable number of ev units. The resulting image is thus a combination of two or three
        different exposures of the original image. Use this to compress dynamic range for
        extremely underexposed images or for true HDR input. For best results, use the exposure
        module (see <xref href="#exposure"/>) to apply a suitable adjustment for correctly
        exposed highlights.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="exposureShift.d12e5481">
                     <title>exposure shift</title>
                     <body>
                        <p>
        This slider is only visible if the <i>exposure fusion</i> feature is
        activated. It allows you to set the exposure difference between the merged images in ev
        units (default 1).
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="exposureBias.d12e5493">
                     <title>exposure bias</title>
                     <body>
                        <p>
        This slider is only visible if the <i>exposure fusion</i> feature is
        activated. It allows you to chose how the multiple exposures are computed. With a bias
        of 1 (the default), the image is fused with overexposed copies of itself. With a bias of
        -1, it is fused with underexposed copies. A bias of 0 tries to preserve the overall
        lightness of the image by combining both over and under-exposed copies of the image.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="exposure">
               <title>Exposure</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>exposure</indexterm></indexterm>
                        <indexterm>exposure</indexterm>
                        <indexterm>time-lapse photography</indexterm>
                        <indexterm>deflicker</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e5540">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module is used to tweak the exposure. It is directly linked to the histogram
              panel. If you correct exposure graphically, using the <i>histogram
              </i> (see <xref href="#histogram"/>), you automatically activate the
              exposure module. The histogram simply acts as a view for the exposure module.
            </entry>
                                 <entry>
                                    <image href="modules/images/exposure.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                     <p>
      You can activate multiple instances of this module each with different parameters acting
      on different parts of the image which you select by a drawn mask (see
      <xref href="#multiple_instances"/> and <xref href="#drawn_mask"/>). The histogram is
      always linked to the last instance in pixelpipe.
    </p>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e5585">
                  <title>Usage</title>
                  <body>
                     <p>
      This module is responsible for one of the most basic steps in each raw image development.
      An exposure adjustment value allows you – within certain limits – to
      correct for under- or overexposure. A shift by 1EV is equivalent to a change of exposure
      time by a factor of 2.
    </p>
                     <p>
      Positive exposure corrections will make the image brighter. As a side effect noise level
      gets higher. Depending on the basic noise level of your camera and the ISO value of your
      image, positive exposure compensations with up to 1EV or 2EV still give reasonable
      results.
    </p>
                     <p>
      Negative exposure corrections will make the image darker. Given the nature of digital
      images this can not correct for fully blown out highlights but allows to reconstruct data
      in case that only some of the RGB channels are clipped (see also
      <xref href="#highlight_reconstruction"/>).
    </p>
                     <p>
      A black level adjustment is a basic tool to increase contrast and pop of an image. The
      value defines at what threshold dark gray values are cut off to pure black. Use with care
      as the clipped values can not be recovered in other modules further down the pixelpipe.
      Please also have a look at the <i>tone curve</i> module (see
      <xref href="#tone_curve"/>) and the <i>levels</i> module (see
      <xref href="#levels"/>) which can produce similar results with less side effects as they
      come later in pixelpipe.
    </p>
                     <p>
      The exposure module has two modes of operation.
    </p>
                     <p>
      In <q>manual</q> mode you directly define the value for exposure correction that
      you want to apply to your image.
    </p>
                     <p>
      In <q>automatic</q> mode darktable analyses the histogram of your image. You
      select a reference point within the histogram as a <i>percentile</i> and
      define a <i>target level</i> – darktable automatically calculates
      the exposure compensation that is needed to shift the selected position to that target
      value. The computed exposure compensation value is displayed in the module's GUI for your
      information.
    </p>
                     <p>
      The <q>automatic</q> mode has a black level adjustment that works as in manual
      mode.
    </p>
                     <p>
      Automatic adjustment is only available for raw images. A typical use case is deflickering
      of <xref href="http://en.wikipedia.org/wiki/Time-lapse_photography"
                              format="html"
                              scope="external">
                           <i>time-lapse
      photographs</i>
                        </xref>. You apply an automatic exposure correction with the same
      set of parameters to all images of the series – differences in lighting get
      compensated so that the final video sequence does not show any flickering.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="mode.d12e5649">
                     <title>mode</title>
                     <body>
                        <p>
        Defines the mode of operation. Defaults to <q>manual</q>.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="black.d12e5661">
                     <title>black</title>
                     <body>
                        <p>
        Adjust the black level in both <q>manual</q> and <q>automatic</q> mode.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="exposure.d12e5677">
                     <title>exposure</title>
                     <body>
                        <p>
        Adjust the exposure correction [EV] (only available in <q>manual</q> mode).
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="clippingThreshold.d12e5689">
                     <title>clipping threshold</title>
                     <body>
                        <p>
        darktable can calculate correct black level and exposure values for your image based on
        the content of a rectangular area. The adjustment slider lets you define what percentage
        of bright values are to be clipped out in the calculation. Pressing the
        <image href="../images/darkroom_module_icon_picker.png" align="center"/>
        icon starts the calculation and lets you draw a rectangular area of your choice using
        your mouse. This feature is only available in <q>manual</q> mode.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="percentile.d12e5705">
                     <title>percentile</title>
                     <body>
                        <p>
        Defines a location in the histogram for automatic exposure correction. A percentile of
        50% denotes a position in the histogram where 50% of pixel values are below and 50% of
        pixel values are above. For more details see
        <xref href="http://en.wikipedia.org/wiki/Percentile"
                                 format="html"
                                 scope="external">
                              <i>percentile</i>
                           </xref>. Only available in <q>automatic</q> mode.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="targetLevel.d12e5722">
                     <title>target level</title>
                     <body>
                        <p>
        Defines the target level for automatic exposure correction in terms of [EV] relative to
        the white point of the camera. The white point is camera specific and defines the
        highest lightness value that the camera sensor can detect. Only available in
        <q>automatic</q> mode.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="contrast_brightness_saturation">
               <title>Contrast Brightness Saturation</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>contrast brightness
                           saturation</indexterm></indexterm>
                        <indexterm>contrast<index-see-also>tone
                              curve</index-see-also><index-see-also>levels</index-see-also></indexterm>
                        <indexterm>brightness<index-see-also>tone
                              curve</index-see-also><index-see-also>levels</index-see-also></indexterm>
                        <indexterm>saturation<index-see-also>tone
                              curve</index-see-also><index-see-also>color
                              zones</index-see-also><index-see-also>color
                           contrast</index-see-also></indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e5789">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module offers a very basic tool for adjusting an image's contrast, brightness
              and saturation.
            </entry>
                                 <entry>
                                    <image href="modules/images/colisa.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e5822">
                  <title>Usage</title>
                  <body>
                     <p>
      The module has sliders for each of the three affected attributes. In their neutral
      position (zero) the image remains unchanged. Shifting sliders left to negative values
      reduces contrast, brightness and saturation, respectively. Shifting right to positive
      values leads to an increase.
    </p>
                     <p>
      Much more versatility for contrast and brightness adjustment is offered by the
      <i>tone curve</i>, <i>levels</i>, and <i>zone
      system</i> modules (see <xref href="#tone_curve"/>, <xref href="#levels"/>, and
      <xref href="#zone_system"/>). Likewise you may adjust color saturation in a more
      detailed way with the <i>tone curve</i>, <i>color
      contrast</i>, and <i>color zones</i> modules (see
      <xref href="#tone_curve"/>, <xref href="#color_contrast"/>, and
      <xref href="#color_zones"/>).
    </p>
                  </body>
                  <topic xml:lang="en-us" id="contrast.d12e5865">
                     <title>contrast</title>
                     <body>
                        <p>
        This slider adjusts the image's contrast.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="brightness.d12e5874">
                     <title>brightness</title>
                     <body>
                        <p>
        This slider adjusts the image's brightness.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="saturation.d12e5883">
                     <title>saturation</title>
                     <body>
                        <p>
        This slider adjusts the color saturation.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="color_reconstruction">
               <title>Color reconstruction</title>
               <prolog>
                  <metadata>
                     <keywords>
                        <indexterm>modules<indexterm>color reconstruction</indexterm></indexterm>
                        <indexterm>color reconstruction</indexterm>
                        <indexterm>artifact mitigation<indexterm>blown out
                           highlights</indexterm></indexterm>
                     </keywords>
                  </metadata>
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e5923">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              The color reconstruction module is able to bring back color into blown out
              highlights.
            </entry>
                                 <entry>
                                    <image href="modules/images/color_reconstruction.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e5955">
                  <title>Usage</title>
                  <body>
                     <p>
      Due to the nature of digital sensors, overexposed highlights are lacking valid color
      information. Most frequently they appear neutral white or exhibit some color
      cast – depending on which other image processing steps are involved. This
      module can <q>heal</q> overexposed highlights by replacing their colors with
      better fitting ones. The module acts on highlight pixels whose luminance values exceed a
      user defined threshold. Replacement colors are taken from the neighborhood. Both, the
      spatial distance and the luminance distance <i>(range)</i> are taken into
      account for color selection.
    </p>
                     <p>
      As a limitation of the underlying algorithm reconstructed colors may sometimes be
      displayed incorrectly if you zoom into the image in the darkroom view. If this happens you
      might observe a magenta shift in highlight areas close to high contrast edges, or you
      might see colorless highlight areas if you combine this module with the <q>reconstruct
      color</q> method of the <q>highlight reconstruction</q> module (see
      <xref href="#highlight_reconstruction"/>). These artifacts only influence image
      display – the final output remains unaffected. It is recommended that you
      finetune the parameters of this module while viewing the full, not zoomed-in image.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="threshold.d12e5980">
                     <title>threshold</title>
                     <body>
                        <p>
        The color reconstruction module replaces the color of all target pixels characterized by
        luminance values above this threshold. Inversely, only pixels with luminance values
        below this threshold are taken as valid source pixels for replacement colors. Too high
        settings of this parameter will cause the module to have no effect on any pixels. Too
        low values will minimize the <q>pool</q> of replacement colors – if
        no suited ones are available the original colors are maintained. Therefore, this
        parameter exhibits a <q>sweet spot</q> characteristic with an optimum setting
        depending on the individual image.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="spatialExtent.d12e5995">
                     <title>spatial extent</title>
                     <body>
                        <p>
        Defines the spatial distance (x,y-coordinates) that source pixels may have from a target
        pixel in order for them to contribute to color replacement. Higher values cause ever
        more distant pixels to contribute; this increases the chance to find a replacement color
        but makes that color more undefined and less clear.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="rangeExtent.d12e6004">
                     <title>range extent</title>
                     <body>
                        <p>
        Defines the range distance (difference in luminance values) that source pixels may have
        from target pixels in order for them to contribute to color replacement. Higher values
        cause more pixels to contribute even if their luminance differs more strongly from the
        target pixels; this again increases the chance to find a replacement color but at the
        same time increases the risk of unfitting colors creeping in.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="preference.d12e6014">
                     <title>preference</title>
                     <body>
                        <p>
        This combobox defines if certain replacement colors shall take precedence over others.
        In its default setting <q>off </q> all pixels contribute equally. Setting it to
        <q>saturated colors</q> makes pixels contribute according to their
        chromaticity – the higher saturated a color the more it contributes. By
        selecting <q>hue</q> you get a choice of giving precedence to a specific hue.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="hue.d12e6032">
                     <title>hue</title>
                     <body>
                        <p>
        This slider is visible if you set the preference combobox to <q>hue</q>. It
        allows you to select a preferred hue of replacement colors. This only has an effect if
        the preferred hue is actually present within the selected spatial and range distance of
        the target pixels (see above). A typical use case is repairing highlights on human skin
        in situations where diverging colors are in close proximity (e.g. textiles or hair with
        a luminance close to skin). Setting a hue preference on skin tones avoids these other
        colors from creeping in.
      </p>
                     </body>
                     
                  </topic>
               </topic>
               <topic xml:lang="en-us" id="examples.d12e6046">
                  <title>Examples</title>
                  <body>
                     <p>
                        <table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="2">
                              <colspec colwidth="4*"/>
                              <colspec colwidth="6*"/>
                              
                              <tbody>
                                 <row>
                                    <entry>
                                       <image href="modules/images/color_reconstruction_ex1.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                Original image with overexposed highlights on head, arm and shoulder of the
                statue.
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                                       <image href="modules/images/color_reconstruction_ex2.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                Color reconstruction with default settings of all module parameters.
              </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table>
                     </p>
                  </body>
                  
               </topic>
            </topic>
            <topic xml:lang="en-us" id="demosaic">
               <title>Demosaic</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>demosaic</indexterm></indexterm>
                        <indexterm>demosaic</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e6115">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module allows you to control how the demosaic is processed.
            </entry>
                                 <entry>
                                    <image href="modules/images/demosaic.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e6147">
                  <title>Usage</title>
                  <body>
                     <p>
      Demosaic is an essential step of any raw image development process.
    </p>
                     <p>
      A detailed description would be beyond the scope of this manual. In a nutshell, the sensor
      cells of a digital camera are only able to record different levels of lightness, not
      different color. In order to get a color image, each cell is covered by a color filter,
      either in red, green or blue. Due to the color sensitivity of the human vision, there are
      two times more green cells than red or blue. Filters are arranged in a certain mosaic,
      called Bayer pattern. Therefore each pixel of your image originally only has information
      about one color channel. Demosaic reconstructs the missing color channels by interpolation
      with data of the neighboring pixels. For further reading see the Wikipedia article on the
      <xref href="http://en.wikipedia.org/wiki/Bayer_filter"
                              format="html"
                              scope="external">Bayer filter</xref>.
    </p>
                     <p>
      As interpolation is prone to produce artifacts, various different demosaic algorithms have
      been developed in the past. Artifacts would typically be visible as moiré-like
      patterns when you strongly zoom into your image. Currently darktable supports PPG, AMAZE,
      and VNG4. All these algorithms produce high quality output with a low tendency to
      artifacts. AMAZE is reported to sometimes give slightly better results. However, as AMAZE
      is significantly slower, darktable uses PPG as a default. VNG4 produces the softest
      results of the three algorithms, but if you see "maze" artifacts, try VNG4 to eliminate
      them.
    </p>
                     <p>
      There are a few cameras whose sensors do not use a Bayer filter. Cameras with an "X-Trans"
      sensor have their own set of demosaicing algorithms. The default algorithm for X-Trans
      sensors is Markesteijn 1-pass, which produces fairly good results. For a bit better
      quality (at the cost of much slower processing), choose Markesteijn 3-pass. Though VNG
      demosaic is faster than Markesteijn 1-pass on certain computers, it is more prone to
      demosaicing artifacts.
    </p>
                     <p>
      Additionally, darktable supports a special demosaicing algorithm – passthrough
      (monochrome). It is not a general-purpose algorithm that is useful for all the images. It
      is only useful for cameras with the color filter array physically removed from the sensor,
      e.g. physically scratched off. Normally, demosaic reconstructs the missing color channels
      by interpolation with data of the neighboring pixels. But since the color filter array is
      not present, there is nothing to interpolate, so this algorithm simply sets all the color
      channels to the same value, which results in pixels being gray, thus producing a
      monochrome image. This method guarantees that there are no interpolation artifacts that
      would otherwise be present should one of the standard demosaicing algorithm be used.
    </p>
                     <p>
      Some further parameters of this module can activate additional averaging and smoothing
      steps. They might help to reduce remaining artifacts in special cases.
    </p>
                     <p>
      Demosaic is always applied when exporting images. Demosaic is done on monitor display only
      when zoom is greater than 50% or when the according preference setting <q>demosaicing
      for zoomed out darkroom mode</q> (see <xref href="core_options"/>) is set
      accordingly. Else color channels are taken from neighboring pixels without an expensive
      interpolation.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="method.d12e6182">
                     <title>method</title>
                     <body>
                        <p>
        Set the demosaic method. darktable currently supports PPG, AMAZE, and VNG4 for Bayer
        sensors. For X-Trans sensors darktable supports VNG, Markesteijn 1-pass, and Markesteijn
        3-pass.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="edgeThreshold.d12e6191">
                     <title>edge threshold</title>
                     <body>
                        <p>
        Set the threshold for an additional median pass. Defaults to <q>0</q> which
        disables median filtering. This option is not shown for X-Trans sensors.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="colorSmoothing.d12e6203">
                     <title>color smoothing</title>
                     <body>
                        <p>
        Activates a number of additional color smoothing passes. Defaults to <q>off</q>.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="matchGreens.d12e6215">
                     <title>match greens</title>
                     <body>
                        <p>
        In some cameras the green filters have slightly varying properties. This parameter adds
        an additional equalization step to suppress artifacts. Available options are
        <q>disabled</q>, <q>local average</q>, <q>full average</q> and
        <q>full and local average</q>. This option is not shown for X-Trans sensors.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="highlight_reconstruction">
               <title>Highlight reconstruction</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>highlight
                           reconstruction</indexterm></indexterm>
                        <indexterm>highlight reconstruction</indexterm>
                        <indexterm>artifact mitigation<indexterm>magenta
                           highlights</indexterm></indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e6267">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module tries to reconstruct color information that is usually clipped because
              of incomplete information in some of the channels. If you do nothing, your clipped
              areas are often toned to the not clipped channel. For example, if your green and
              blue channels are clipped, then your image will appear red in the clipped areas.
            </entry>
                                 <entry>
                                    <image href="modules/images/highlightreconstruction.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e6299">
                  <title>Usage</title>
                  <body>
                     <p>
      You can choose between three methods for highlight reconstruction.
    </p>
                     <p>
                        <q>Clip highlights</q> just clamps all the pixels to the white level. Effectively
      this converts all clipped highlights to neutral grey tones. This method is most useful in
      cases where clipped highlights occur in non-colored areas like clouds in the sky.
    </p>
                     <p>
                        <q>Reconstruct in LCh</q> analyses each pixel having at least one channel clipped
      and transforms the information in LCh color space in an attempt to correct the clipped
      pixel using the values of the other (3 for Bayer or 8 for X-Trans) pixels in the affected
      sensor block. This method usually does a better job than <q>Clip highlights</q> as
      some details in the clipped areas are preserved. However it is incapable to reconstruct
      any color information  – the reconstructed highlights will all be monochrome,
      but brighter and with more detail than with <q>Clip highlights</q>. This method
      works fairly well with a high-contrast base curve (such as most manufacturers apply to
      their JPEG), which renders highlights desaturated. This method is a good option on
      naturally desaturated objects such as clouds.
    </p>
                     <p>
                        <q>Reconstruct color</q> uses an algorithm that transfers color information from
      the unclipped surroundings into the clipped highlights. This method works very well on
      areas with homogeneous colors and is especially useful on skin tones with smoothly fading
      highlights. It fails in certain cases where it produces maze-like artifacts at highlights
      behind high-contrast edges, such as fine, well-exposed structures in front of overexposed
      background (for instance ship masts or flags in front of the blown-out sky).
    </p>
                     <p>
      Tip: for highlight reconstruction to be effective you need to apply a negative EV
      correction in the exposure module (see <xref href="#exposure"/>). If you want to avoid a
      general darkening of your image you can use darktable's mask feature in that module to
      limit the EV correction to only the highlights (see <xref href="#drawn_mask"/> and
      <xref href="#parametric_mask"/>).
    </p>
                  </body>
                  <topic xml:lang="en-us" id="method.d12e6341">
                     <title>method</title>
                     <body>
                        <p>
        Choose the method for highlight reconstruction.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="clippingThreshold.d12e6350">
                     <title>clipping threshold</title>
                     <body>
                        <p>
        Manually adjust the clipping threshold against magenta highlights. The default is
        usually satisfactory without any need for additional adjustments.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="whitebalance">
               <title>White balance</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>white balance</indexterm></indexterm>
                        <indexterm>white balance</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e6381">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module is used to set the white balance. You have three ways to interact with
              it: (a) Set up tint and temperature, (b) define the value of each channel, or (c)
              choose from predefined white balances.
            </entry>
                                 <entry>
                                    <image href="modules/images/whitebalance.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e6413">
                  <title>Usage</title>
                  <topic xml:lang="en-us" id="tint.d12e6418">
                     <title>tint</title>
                     <body>
                        <p>
        Alter the color tint of the image, from magenta (value &lt; 1) to green (value &gt; 1).
        The channel sliders will be updated when you adjust this parameter.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="temperature.d12e6427">
                     <title>temperature</title>
                     <body>
                        <p>
        Set the color temperature (in Kelvin). The channel sliders will be updated when you
        adjust this parameter. darktable derives the color temperature from the Exif data using
        some model assumptions. The value given is not meant to be authoritative. In the end
        only the updated channel values determine how the image is modified.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="redGreenAndBlueChannels.d12e6436">
                     <title>red, green and blue channels</title>
                     <body>
                        <p>
        Set the channel values on a scale from 0 to 8.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="preset.d12e6445">
                     <title>preset</title>
                     <body>
                        <p>
        Select a preset white balance.
        <table frame="none">
                              <tgroup colsep="0" rowsep="0" cols="2">
                                 <colspec colwidth="4*"/>
                                 <colspec colwidth="6*"/>
                                 
                                 <tbody>
                                    <row>
                                       <entry>
                                          <i>camera white balance (default)</i>
                                       </entry>
                                       <entry>
                  White balance reported by the camera.
                </entry>
                                    </row>
                                    <row>
                                       <entry>
                                          <i>camera neutral</i>
                                       </entry>
                                       <entry>
                  Essentially sets temperature to 6502K. The actual math: it computes such white
                  balance channel multipliers, so that pure white color in camera colorspace is
                  converted into pure white color in sRGB D65. (pure white color here means
                  having the same equal value for each channel = 1.0)
                </entry>
                                    </row>
                                    <row>
                                       <entry>
                                          <i>spot white balance</i>
                                       </entry>
                                       <entry>
                  Select a square area in your image containing mostly grey pixels. The white
                  balance is calculated based on the selected area.
                </entry>
                                    </row>
                                    <row>
                                       <entry>
                                          <i>camera presets</i>
                                       </entry>
                                       <entry>
                  Camera specific white balance presets. Examples: direct sunlight, flash,
                  cloudy, shade and a number of indoor lighting options.
                </entry>
                                    </row>
                                 </tbody>
                              </tgroup>
                           </table>
                        </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="finetune.d12e6515">
                     <title>finetune</title>
                     <body>
                        <p>
        Some cameras offer additional finetuning parameters if one of the camera presets is
        selected. Depending on camera white balance, can be adjusted in steps within a certain
        range. The adjustments are usually towards yellow (value &lt; 1) or blue (value &gt; 1).
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="invert">
               <title>Invert</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>invert</indexterm></indexterm>
                        <indexterm>invert</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e6547">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              The main purpose of this module is to invert scanned negatives.
            </entry>
                                 <entry>
                                    <image href="modules/images/invert.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e6579">
                  <title>Usage</title>
                  <topic xml:lang="en-us" id="colorOfFilmMaterial.d12e6584">
                     <title>color of film material</title>
                     <body>
                        <p>
        The only control element of this module is a color selector which allows to adjust for
        different colors of your film material. Clicking on the colored field will open a color
        selector dialog which offers you a choice of commonly used colors, or allows to define a
        color in RGB color space. You can also activate a color picker by pressing
        <image href="../images/darkroom_module_icon_picker.png" align="center"/>
        and take a color probe from your image – preferably from the unexposed border
        of your negative.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="raw_black_white_point">
               <title>Raw black/white point</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>raw black/white point</indexterm></indexterm>
                        <indexterm>raw black/white point</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e6619">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module is activated automatically for raw images and makes sure that the
              camera specific black and white points are taken into account. Default settings
              are applied for all supported cameras. Changes to the defaults are normally not
              required.
            </entry>
                                 <entry>
                                    <image href="modules/images/raw_black_white.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e6651">
                  <title>Usage</title>
                  <topic xml:lang="en-us" id="blackLevel0To3.d12e6656">
                     <title>black level 0 to 3</title>
                     <body>
                        <p>
        The camera specific black level of the four pixels in the RGGB Bayer pattern. Pixels
        with values lower than that level are considered to contain no valid data.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="whitePoint.d12e6665">
                     <title>white point</title>
                     <body>
                        <p>
        The camera specific white level. All pixels with values above are likely to be clipped
        and handled accordingly in the <i>highlight reconstruction</i> module (see
        <xref href="#highlight_reconstruction"/>). Pixels with values equal to the white level
        are considered to be white.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
         </topic>
         <topic xml:lang="en-us" id="tone_group">
            <title>Tone group</title>
            <body>
               <p>
    This group contains modules that operate on the tonal values of an image, modulating
    brightness while leaving color values intact.
  </p>
            </body>
            <topic xml:lang="en-us" id="fill_light">
               <title>Fill light</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>fill light</indexterm></indexterm>
                        <indexterm>fill light</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e6710">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module allows local modification of the exposure based on pixel lightness.
            </entry>
                                 <entry>
                                    <image href="modules/images/relight.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e6742">
                  <title>Usage</title>
                  <body>
                     <p>
      Pushes exposure by increasing lightness with a Gaussian curve of a specified width,
      centered on a given lightness.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="exposure.d12e6750">
                     <title>exposure</title>
                     <body>
                        <p>
        Sets fill-light exposure in [EV].
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="center.d12e6759">
                     <title>center</title>
                     <body>
                        <p>
        Sets the median lightness impacted by the fill-light. A color picker is activated by
        pressing
        <image href="../images/darkroom_module_icon_picker.png" align="center"/>
        . It shows the picked lightness value in the gradient bar, which helps find the desired
        center value. You can switch between point and area sampling mode from within the global
        color picker panel (see <xref href="#global_color_picker"/>).
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="width.d12e6780">
                     <title>width</title>
                     <body>
                        <p>
        Sets the width of the Gaussian curve. This number is expressed in zones, with the whole
        dynamic range being 10 zones. As the Gaussian curve is symmetric, only even numbers can
        be entered.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="levels">
               <title>Levels</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>levels</indexterm></indexterm>
                        <indexterm>levels</indexterm>
                        <indexterm>artifact mitigation<indexterm>black
                           pixels</indexterm></indexterm>
                        <indexterm>artifact mitigation<indexterm>blue light
                           sources</indexterm></indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e6829">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              A tool for adjusting black, white, and mid-gray points. This module is especially
              useful if the histogram of an image does not span the whole horizontal range, from
              pure black to pure white.
            </entry>
                                 <entry>
                                    <image href="modules/images/levels.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e6862">
                  <title>Usage</title>
                  
                  <prolog>
                     <metadata><keywords>
                           <indexterm>color picker</indexterm>
                        </keywords></metadata>
                     
                  </prolog>
                  <body>
                     <p>
      The levels tool offers two modes of operation: <q>manual</q> and
      <q>automatic</q>.
    </p>
                     <p>
      In <q>manual</q> mode the levels tool shows a histogram of the image, and displays
      three bars with handles. Dragging the handles modifies the tones in the image. Those bars
      control the black, middle gray and white points in absolute values of image lightness (the
      L value from Lab).
    </p>
                     <p>
      You can move the black and white bars to match the left and right borders of the
      histogram, which will make the output image span the full available tonal range. A
      previously flat looking image will get more contrast and pop.
    </p>
                     <p>
      Moving the middle bar will modify the middle gray tones. Shifting it left will make the
      image look brighter, shifting it right will make it darker. This is often referred to as a
      change of image gamma.
    </p>
                     <p>
      There are three color pickers in black, gray, and white, available by pressing the
      respectively colored
      <image href="../images/darkroom_module_icon_picker.png" align="center"/>
      icon. You can use them to sample the corresponding level directly from the image. You can
      switch between point and area sampling mode from within the global color picker panel (see
      <xref href="#global_color_picker"/>).
    </p>
                     <p>
      The <q>auto</q> button autoadjusts the black and white point and puts the gray
      point exactly in the mean between them.
    </p>
                     <p>
      In <q>automatic</q> mode the module automatically analyses the histogram of the
      image, detects the left and right histogram borders, and lets you define the black point,
      the gray point and the white point in terms of
      <xref href="http://en.wikipedia.org/wiki/Percentile"
                              format="html"
                              scope="external">
                           <i>percentiles</i>
                        </xref> relative to these borders.
    </p>
                     <p>
      Tip: Under certain conditions, especially highly saturated blue light sources in the
      frame, the levels module may produce black pixel artifacts. See the <i>gamut
      clipping</i> option (<xref href="#input_color_profile"/>) on how to mitigate this
      issue.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="mode.d12e6929">
                     <title>mode</title>
                     <body>
                        <p>
        Set the mode of operation of this module. Defaults to <q>manual</q>.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="black.d12e6941">
                     <title>black</title>
                     <body>
                        <p>
        Sets the black point in percentiles relative to the left border of the histogram (only
        <q>automatic</q> mode).
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="gray.d12e6954">
                     <title>gray</title>
                     <body>
                        <p>
        Sets the gray point in percentiles relative to the left and right borders of the
        histogram <i>after</i> having applied the black point and white point
        corrections (only <q>automatic</q> mode).
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="white.d12e6969">
                     <title>white</title>
                     <body>
                        <p>
        Sets the white point in percentiles relative to the right border of the histogram (only
        <q>automatic</q> mode).
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="tone_curve">
               <title>Tone curve</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>tone curve</indexterm></indexterm>
                        <indexterm>tone curve</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e7003">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module is a classic digital photography tool. darktable's tone curve
              can work in three different color spaces: RGB, XYZ or Lab.
            </entry>
                                 <entry>
                                    <image href="modules/images/tonecurve.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e7035">
                  <title>Usage</title>
                  
                  <prolog>
                     <metadata><keywords>
                           <indexterm>color picker</indexterm>
                        </keywords></metadata>
                     
                  </prolog>
                  <body>
                     <p>
      In its default state, curves will be straight lines, defined by few anchor nodes. You can
      move the nodes to modify the curve. You can generate new nodes by
      <i>clicking</i> on the curve. With <i>Ctrl+click</i> you
      generate a new node at the x-location of the mouse pointer and the corresponding
      y-location of the current curve – this adds a node without risking to
      accidentally modify the curve. Up to 20 nodes per curve can be defined. To remove a node,
      move it out of the widget area.
    </p>
                     <p>
      A color picker is activated by pressing
      <image href="../images/darkroom_module_icon_picker.png" align="center"/>
      and will show the picked values in the graph. You can switch between point and area
      sampling mode from within the global color picker panel (see
      <xref href="#global_color_picker"/>). Numerical Lab values of input and output (see
      below) at the selected spot or area are shown on top left of the widget.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="colorSpaces.d12e7064">
                     <title>color spaces</title>
                     <body>
                        <p>
        Depending on the desired intent, you can apply the tone curve in three different color spaces:
        <ul>
                              <li>
                                 <p>Lab, linked channels,</p>
                              </li>
                              <li>
                                 <p>Lab, separated channels,</p>
                              </li>
                              <li>
                                 <p>XYZ, linked channels,</p>
                              </li>
                              <li>
                                 <p>RGB, linked channels.</p>
                              </li>
                           </ul>
                        </p>
                        <p>
        Lab is a perceptual color space that is designed to approximate the way human beings
        perceive colors and lightness, and representing the color information independently
        of the the lightness information.
        In <q>Lab, separated channels</q>, you get a fully independent control
        over the chrominance (a/b-channels) and the luminance (L-channel).
        In <q>Lab, linked channels</q>, only the luminance (L-channel) control is
        available. The color saturation correction will be automatically computed, for each pixel,
        from the contrast correction applied to the luminance channel.
        This works better in cases where a subtle contrast correction is applied,
        but gives increasingly inaccurate saturation correction as the contrast gets more
        dramatically enhanced.
      </p>
                        <p>
        XYZ is a linear technical color space designed to link the physiologic light response
        of human eyes to RGB spaces. As Lab, it separates the lightness from the color
        information, but it does so in a way that does not account for the role of the brain
        correction in human perception.
        The <q>XYZ, linked channels,</q> mode offers an alternative for
        <q>Lab, linked channels</q>.
        It works by applying the L-channel curve to all three channels in the XYZ
        color space. Look at blend mode <q>coloradjustment</q> if you want to tune
        the strength of automatic chroma scaling (see <xref href="#blending_operators"/>).
        This mode is known to produce a slight hue shift towards yellow.
      </p>
                        <p>
        RGB spaces are linear color spaces designed to capture and display images in additive
        synthesis. They are related to capture and display media and do not isolate
        color and lightness information.
        The <q>RGB, linked channels,</q> works in ProPhoto RGB and applies the L-channel
        curve to all three channels in the RGB color space. Adding contrast in RGB space
        is known to desaturate highlights and boost saturation in lowlights, but this has proven to
        be the most reliable way to edit contrast, and is the standard way to do it in most
        software. This mode makes the tone curve module behave the same way as the
        basecurve (see <xref href="#base_curve"/>), except the latter one works in camera RGB space.
      </p>
                        <p>
        Notice that the interface is controlled in Lab in all cases. This means that the middle gray
        coordinate is always 50% in the graph, no matter what color space is used. The same applies to
        the inset histogram displayed in the background of the curve. The
        controls are converted to the relevant color space before the corrections are applied –
        in RGB and XYZ, the middle-gray is therefore remapped from 50% to 18%.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="lchannelCurve.d12e7126">
                     <title>L-channel curve</title>
                     <body>
                        <p>
        The tone curve in L-channel works on Lightness. For a better overview a lightness
        histogram is displayed in the diagram. When working in <q>Lab, linked channels</q>,
        <q>RGB, linked channels</q> or <q>XYZ, linked channels</q>, the L-channel
        curve is the only one available.
      </p>
                        <p>
        The horizontal line represents the input image pixels' lightness. The vertical line
        represents the lightness of the output image pixels. A straight line does not change
        anything. A point above the default diagonal increases the lightness, whereas a point
        under decreases it. Shifting the center of the curve upwards will lighten the image,
        shifting it downwards will darken the image. An S-like curve will enhance the contrast
        of the image.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="abchannelCurves.d12e7148">
                     <title>a/b-channel curves</title>
                     <body>
                        <p>
        The curves in the a and b channels work on color values and are available only in
        <q>Lab, separated channels</q> color space.
        The horizontal line represents the color channel value of the
        input image pixels. The vertical line represents the color channel value of the output
        image pixels. Positive a-values correspond to more magenta colors; negative a-values
        correspond to more greenish colors. Positive b-values correspond to more yellowish
        colors; negative b-values correspond to more blueish colors.
      </p>
                        <p>
        A straight line does not change anything. Shifting the center of the curve will give the
        image a color tint: shifting a-channel upwards gives a magenta tint; shifting b-channel
        upwards gives a yellow tint; shifting a-channel downwards gives a green tint; shifting
        b-channel downwards gives a blue tint.
      </p>
                        <p>
        Increasing/decreasing the steepness of the curves, without shifting its center, will
        increase/decrease the color saturation of the respective channel. With properly defined
        curves you can exert fine control on color saturation, depending on the input pixel's
        colors.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="interpolationMethod.d12e7166">
                     <title>interpolation method</title>
                     <body>
                        <p>
        The interpolation is the process by which a continuous curve is derived from a few
        punctual nodes. As this process is never perfect, several methods are offered that
        can alleviate the potential issues you may encounter with some nodes setups.
      </p>
                        <p>
        Arguably, the most visually pleasing method is the <q>cubic spline</q>. Since
        it gives smooth curves, the contrast in the image is better enhanced. However, this
        method is very sensitive to the nodes position, and can produce cusps and oscillations
        when the nodes are too close to each other, or when there are too many of them.
        This method works best when there are only 4 to 5 nodes, evenly spaced.
      </p>
                        <p>
        The <q>centripetal spline</q> is a method designed specifically to avoid
        cusps and oscillations, but as a drawback it will follow the nodes more loosely.
        It is very robust, no matter the number of nodes and their spacing, but will produce
        a more faded and dull contrast.
      </p>
                        <p>
        The <q>monotonic spline</q> is a method designed specifically to give a monotonic
        interpolation, meaning that there will be none of the oscillations the cubic spline may
        produce. This method is very suitable when you try to build an analytical function
        from a node interpolation (for example: exponential, logarithm, power, etc.). Such
        functions are provided as presets. It is a good trade-off between the two
        aforementioned methods.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="scale.d12e7193">
                     <title>scale</title>
                     <body>
                        <p>
        The scale allows you to distort the graph display so that certain graphical
        properties emerge to help you draw meaningful curves. Notice that the scaling
        option only affects the curve display, not the actual parameters.
      </p>
                        <p>
        By default, the <q>linear</q> scale is used. This scale uses evenly spaced
        abscissa and ordinates axes.
      </p>
                        <p>
        The <q>log-log (x, y)</q> scale will compress the high values and dilate
        the low values, on both the abcissa and the axis of ordinates, so that the nodes in lowlights
        get more space on the graph and can be controlled more clearly.
      </p>
                        <p>
        The <q>semi-log (x)</q> is similar to the log-log scale, but the axis of ordinates
        is left linear and only the abcissa is logarithmically scaled. This is useful
        when you want to draw a purely exponential function: in semi-log (x) scale, exponential
        become identity lines.
      </p>
                        <p>
        The <q>semi-log (y)</q> is similar to the log-log scale, but the abscissa
        axis is left linear and only the axis of ordinates is logarithmically scaled. This is useful
        when you want to draw a purely logarithmic function: in semi-log (y) scale, logarithms
        become identity lines.
      </p>
                        <p>
        When using non-linear scales, a <q>base of the logarithm</q> slider appears
        that lets you control the amount of compression/dilatation operated by the logarithmic
        scales. If you draw purely exponential or logarithmic functions from identity lines,
        setting this values defines the base of such functions.
      </p>
                     </body>
                     
                  </topic>
               </topic>
               <topic xml:lang="en-us" id="examples.d12e7234">
                  <title>Examples</title>
                  <body>
                     <p>
                        <table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="2">
                              <colspec colwidth="4*"/>
                              <colspec colwidth="6*"/>
                              
                              <tbody>
                                 <row>
                                    <entry>
                                       <image href="modules/images/tonecurve_ex1.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                Original image
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                                       <image href="modules/images/tonecurve_ex2.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                Tone curve settings. Please note how the center node of our b-curve was shifted
                down to negative values. This gives the image its blue tint.
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                                       <image href="modules/images/tonecurve_ex3.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                Resulting image
              </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table>
                     </p>
                  </body>
                  
               </topic>
            </topic>
            <topic xml:lang="en-us" id="zone_system">
               <title>Zone system</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>zone system</indexterm></indexterm>
                        <indexterm>zone system</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e7316">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module is another way to change the lightness of your image, based on Ansel
              Adams' system. It allows modification of a zone's lightness taking into account
              the effect on the adjacent zones. It divides the lightness range into a
              user-defined number of zones.
            </entry>
                                 <entry>
                                    <image href="modules/images/zonesystem.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e7348">
                  <title>Usage</title>
                  <body>
                     <p>
      Following the concept of Ansel Adams the lightness (based on the L channel from Lab) is
      divided into a number of zones ranging from pure black to pure white. These zones are
      displayed in a zonebar. The number of zones can be changed by mouse-scrolling on that bar
      (defaults to 10 zones).
    </p>
                     <p>
      The zonebar is split horizontally with the upper part showing the zones of the module's
      output and the lower part the according zones of the module's input. In its default state
      both parts are fully aligned. While the output zones are static you can left click and
      drag a control point in the input zones to modify the zonemapping. Shifting a control
      point proportionally expands the zones on one side and compresses the zones on the other
      side. Any already existing control point stays in place, effectively preventing changes to
      the zones beyond. Use right click to remove a control point.
    </p>
                     <p>
      The preview shows the image broken down in zones. When hovering above a zone on the
      zonebar, that zone – either from input or output – is highlighted on
      the preview.
    </p>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="examples.d12e7363">
                  <title>Examples</title>
                  <body>
                     <p>
                        <table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="2">
                              <colspec colwidth="4*"/>
                              <colspec colwidth="6*"/>
                              
                              <tbody>
                                 <row>
                                    <entry>
                                       <image href="modules/images/zonesystem_ex1.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                The original image.
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                                       <image href="modules/images/zonesystem_ex2.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                Here, the darker and lighter zones were compressed to increase contrast, then
                the upper parts of darker zones were expanded to increase their visual impact.
                <image href="modules/images/zonesystem_ex2_settings.png"
                                              placement="break"/>
                                    </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table>
                     </p>
                  </body>
                  
               </topic>
            </topic>
            <topic xml:lang="en-us" id="local_contrast">
               <title>Local contrast</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>local contrast</indexterm></indexterm>
                        <indexterm>local contrast<indexterm>equalizer</indexterm></indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e7440">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module allows enhancing local contrast. It supports two modes of operation:
              the default one uses a local laplacian filter, the other one uses the unnormalized
              bilateral filter. Both work exclusively on the L channel from Lab.
            </entry>
                                 <entry>
                                    <image href="modules/images/localcontrast.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e7472">
                  <title>Usage</title>
                  <body>
                     <p>
      Local contrast boosts details of your image, much like the <i>equalizer</i>
      does (see <xref href="#equalizer"/>). However, it is easier to use as it does not
      require you to work on different frequency bands. The local laplacian filter has been
      designed to be very robust against unwanted halo effects and gradient reversals along
      edges.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="mode.d12e7485">
                     <title>mode</title>
                     <body>
                        <p>
        Choice of "local laplacian filter" or "unnormalised bilateral grid". The options for the
        bilateral grid are: coarseness, contrast, and detail. The local laplacian filter
        supports: detail, highlights, shadows, and midtone range. The local laplacian mode
        supports shadow lifting and highlight compression, similar to the shadows and highlights
        module.
      </p>
                     </body>
                     
                  </topic>
               </topic>
               <topic xml:lang="en-us" id="bilateralGrid.d12e7495">
                  <title>Bilateral grid</title>
                  <topic xml:lang="en-us" id="coarseness.d12e7500">
                     <title>coarseness</title>
                     <body>
                        <p>
        Make the details you want to adjust finer or coarser.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="contrast.d12e7509">
                     <title>contrast</title>
                     <body>
                        <p>
        How strongly the algorithm distinguishes between brightness levels. Increasing the value
        results in a more contrasty look.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="detail.d12e7518">
                     <title>detail</title>
                     <body>
                        <p>
        Add or remove detail. Higher values will increase local contrast.
      </p>
                     </body>
                     
                  </topic>
               </topic>
               <topic xml:lang="en-us" id="localLaplacian.d12e7529">
                  <title>Local laplacian</title>
                  <body>
                     <p>
      To understand the parameters of the local laplacian filter, you can think of it as
      applying a curve to the image, similar to this picture:
      <image href="modules/images/locallaplacian-curve.png"
                               align="center"
                               placement="break"/>
      It will then be applied to the image in a way that works locally and avoids halo
      artifacts.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="detail.d12e7541">
                     <title>detail</title>
                     <body>
                        <p>
        Add or remove detail. Higher values will increase local contrast. This will insert an S
        shaped element in the center of the curve, to increase or decrease local contrast. For
        monochrome images it is often possible to push this parameter to extreme settings
        without ridiculous results or artifacts.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="highlights.d12e7550">
                     <title>highlights</title>
                     <body>
                        <p>
        This affects one end of the curve, effectively increasing or compressing contrast in the
        highlights. A low value will pull the highlights down.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="shadows.d12e7559">
                     <title>shadows</title>
                     <body>
                        <p>
        Similar to the highlights parameter, this affects the other far end of the curve, and
        will increase or decrease contrast in the shadows. A higher value gives more contrast in
        the shadows. A lower value will lift the shadows and can effectively simulate a fill
        light. Note that this is done via local manipulation of the image, however: this means
        that a completely dark image cannot be brightened this way, only dark things in front of
        bright things will be affected.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="midtoneRange.d12e7568">
                     <title>midtone range</title>
                     <body>
                        <p>
        This controls the extent of the S shaped part of the contrast curve. A larger value will
        make the S wider, and thus classify more values to be midtone range and fewer values to
        belong to the highlights and shadows part. In more high dynamic range settings it can be
        useful to reduce this value to achieve stronger range compression by lowering the
        contrast in the highlights and the shadows. Note however that for really strong HDR
        scenarios this may work best in combination with a base curve which pre-compresses the
        range, maybe with an approximately logarithmic base curve. Also the exposure fusion
        feature in the base curve module may lead to more pleasing results at times, but is more
        prone to producing halo effects.
      </p>
                        <p>
        This setting can cause banding artifacts in the image if pushed to extreme values. This
        is due to the way darktable computes the fast approximation of the local laplacian
        filter.
      </p>
                     </body>
                     
                  </topic>
               </topic>
               <topic xml:lang="en-us" id="example.d12e7581">
                  <title>Example</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              Before
            </entry>
                                 <entry>
                                    <image href="modules/images/localcontrast_before.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                              <row>
                                 <entry>
              After, a little overdone to demonstrate the effect. Use this sparingly, to avoid a
              cheap, overprocessed look.
            </entry>
                                 <entry>
                                    <image href="modules/images/localcontrast_after.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
            </topic>
            <topic xml:lang="en-us" id="tonemapping">
               <title>Tonemapping</title>
               <prolog>
                  <metadata>
                     <keywords>
                        <indexterm>modules<indexterm>tonemapping</indexterm></indexterm>
                        <indexterm>tonemapping<index-see-also>global
                           tonemap</index-see-also></indexterm>
                     </keywords>
                  </metadata>
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e7650">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module compresses the tonal range of HDR images, so they fit into the limits
              of a normal, low dynamic range image, using Durand's 2002 algorithm. darktable can
              import HDR images if they come in OpenEXR, RGBE or PFM format or as a DNG
              generated by darktable's HDR creation mechanism (see
              <xref href="selected_images"/>).
            </entry>
                                 <entry>
                                    <image href="modules/images/tonemapping.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e7684">
                  <title>Usage</title>
                  <body>
                     <p>
      The underlying algorithm uses a bilateral filter to decompose an image into a coarse base
      layer and a detail layer. The contrast of the base layer is compressed, while the detail
      layer is preserved, then both layers are re-combined.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="contrastCompression.d12e7692">
                     <title>contrast compression</title>
                     <body>
                        <p>
        Sets the contrast compression level of the base layer. A higher compression will make
        the image fit a lower dynamic range.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="spatialExtent.d12e7701">
                     <title>spatial extent</title>
                     <body>
                        <p>
        Sets the spatial extent of the bilateral filter. Lower values cause the contrast
        compression to have stronger effects on image details.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="global_tonemap">
               <title>Global tonemap</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>global tonemap</indexterm></indexterm>
                        <indexterm>global tonemap</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e7732">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module implements another approach to compressing the tonal range of an HDR
              image into the limited tonal range of a typical LDR output file. It offers several
              implementations of global tonemap operators.
            </entry>
                                 <entry>
                                    <image href="modules/images/global_tonemap.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e7764">
                  <title>Usage</title>
                  <body>
                     <p>
      Global tonemapping processes each pixel of an HDR image, without taking the local
      surrounding into account. This is generally faster than local tonemapping, as implemented
      in the <xref href="#tonemapping">
                           <i>tonemapping</i>
                        </xref> module but
      might lead to less convincing results with very high dynamic scenes. As an enhancement to
      the original operators, darktable can preserve detail of the input image, and transfer it
      back to the output image.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="operator.d12e7776">
                     <title>operator</title>
                     <body>
                        <p>
        Reinhard, Filmic and Drago global tonemap operators are available for use. Depending on
        the selected operator, different parameters can be adjusted. Some operators are fully
        self-adjusting, and do not require specific controls.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="bias.d12e7785">
                     <title>bias</title>
                     <body>
                        <p>
        Only offered for the <i>Drago</i> operator. This parameter influences the
        contrast of the output image. It is an essential parameter for adjusting the compression
        of high values and the visibility of details in dark areas. According to the original
        paper, a value of 0.85 is recommended as a starting point.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="target.d12e7797">
                     <title>target</title>
                     <body>
                        <p>
        Only offered for the <i>Drago</i> operator. This is a scale factor to
        adjust the global image brightness to the brightness of the intended display. It is
        measured in cd/m
        <sup>2</sup>
        , and should match the according value of your output device. Higher values lead to a
        brighter image, while lower values lead to a darker image.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="detail.d12e7812">
                     <title>detail</title>
                     <body>
                        <p>
        Offered as an addition to all operators. This parameter controls how much detail is
        preserved and transferred back into the output image after tonemapping.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="filmic">
               <title>Filmic rgb</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>filmic rgb</indexterm></indexterm>
                        <indexterm>filmic rgb</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e7843">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
                                    <p>
                This module compresses the tonal range of an image by reproducing the tone and
                color response of classic film. Doing so, it protects the colors and the
                contrast in mid-tones, recovers the shadows, and compresses bright highlights.
                It is very suitable in portrait photography, especially in back-lighting
                situations, but needs extra care when details need to be preserved in highlights
                (e.g. clouds).
              </p>

                                    <p>
                The module is derived from the same named module in Blender 3D modeller by T. J.
                Sobotka. While it is primarily intended to recover high-dynamic range from raw
                sensor data, it can be used with any image in replacement of the base curve
                module. The developer provided a detailed explanation of the module in a video
                called
                <xref href="https://www.youtube.com/watch?v=zbPj_TqTF88"
                                             format="html"
                                             scope="external">Filmic
                RGB: remap any dynamic range in darktable 3.0</xref>.
              </p>

                                    <p>
                Filmic rgb is the successor of the filmic module provided in darktable 2.6.x.
                While the underlying principles did not change much, users of the previous
                version should not expect a 1:1 translation of their workflow, and may find
                <xref href="#filmic-rgb-for-26-users"/> useful.
              </p>
                                 </entry>
                                 <entry>
                                    <image href="modules/images/filmic.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="prerequisites.d12e7889">
                  <title>Prerequisites</title>
                  <body>
                     <p>
      In order to get the best out of filmic rgb, images need some preparation:
      <ul>
                           <li>
                              <p>
          In-camera, expose the shot <q>to the right</q>. This implies under exposing
          the shot so that the highlights are at the right of the histogram, just on the verge
          of clipping, but not clipped. It does not matter if the picture preview is very dark
          on your camera screen: as long as highlights are unclipped, filmic rgb should be able
          to recover details from the raw data. Beware that clipped data are not recoverable.
          Some cameras have a clipping alert preview to help you diagnose this, and some even
          have an highlight-priority exposure mode.
        </p>
                           </li>
                           <li>
                              <p>
          In the <xref href="#exposure">
                                    <i>exposure</i>
                                 </xref> module, push the
          exposure until the midtones are clear enough. Do not worry about losing the
          highlights: they will be recovered as part of the filmic rgb processing. However, it
          is important to avoid negative pixels in black areas: the computations done by filmic
          rgb will result in unpredictable results in this case. For some cameras models (Canon,
          mainly), rawspeed (the raw decoding library of darktable), may set an exaggerated
          black level, resulting in crushed blacks and negative values. If so, brighten the
          blacks by setting a negative black level value in the
          <xref href="#exposure">
                                    <i>exposure </i>
                                 </xref> module.
        </p>
                           </li>
                           <li>
                              <p>
          If you plan on using filmic rgb's auto-tuners, use the
          <xref href="#whitebalance">
                                    <i>white
          balance</i>
                                 </xref> module first to correct any color casts and get neutral
          colors. In RGB color spaces, luminance and chrominance are linked, and filmic rgb's
          luminance detection relies on accurate measures of both. If your picture is very
          noisy, add an initial step of denoising to help the black exposure readings, and use a
          high quality demosaicing.
        </p>
                           </li>
                           <li>
                              <p>
          If you plan on using filmic rgb's chrominance preservation mode, avoid using any tone
          mapping module as well as the base curve module. These may produce unpredictable color
          shifts that would make the chrominance preservation useless. Neither of these modules
          is usually needed if you use filmic rgb.
        </p>
                           </li>
                        </ul>
                     </p>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e7932">
                  <title>Usage</title>
                  <body>
                     <p>
      The filmic rgb module aims at mapping the photographed scene (RAW image) dynamic range to
      the (smaller) display dynamic range. This mapping is defined in three steps, each handled
      in a separate tab in the interface:
      <ul>
                           <li>
                              <p>
          The
          <uicontrol>scene</uicontrol>
          tab contains the <q>input</q> settings of the scene: what constitutes middle
          grey, white and black in the photographed scene.
        </p>
                           </li>
                           <li>
                              <p>
          The
          <uicontrol>look</uicontrol>
          tab contains the parameters of the mapping applied to the input parameters defined in
          the
          <uicontrol>scene</uicontrol>
          tab. Notably, this part of the module applies an S-shaped parametric curve to enhance
          the contrast and remap the grey value to the middle grey of the display. This is
          similar to what the base curve or tone curve modules do.
        </p>
                           </li>
                           <li>
                              <p>
          The
          <uicontrol>display</uicontrol>
          tab defined the output settings to map the transformed image to the display. In
          typical use cases, this tab should only be used very rarely.
        </p>
                           </li>
                        </ul>
                     </p>
                     <p>
      The sliders' ranges of filmic rgb are limited to usual and safe values, but values are
      allowed out of these ranges by clicking on the sliders with the right button and inputting
      values on the keyboard. Filmic rgb has no neutral parameters resulting in a no-operation:
      as soon as the module is enabled, the image is always at least slightly affected.
    </p>
                     <p>
      The curves at the top of the module are read-only and serve as a guide for the operations
      performed on the sliders. The bright curve is the tone mapping curve, where the abscissa
      represents the scene exposure, and the ordinate represents the display exposure. The dark
      curve is the desaturation curve, representing the percentage of saturation as function of
      the scene exposure.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="middlegreyLuminanceSceneTab.d12e7976">
                     <title>Middle-grey luminance (<uicontrol>Scene</uicontrol> tab)</title>
                     <body>
                        <p>
        The middle-grey luminance is the luminance in RGB space of the scene referred 18% grey.
        Its color picker tool reads the average luminance over the drawn area. If you happen to
        have a grey card or a color chart (IT8 chart or colorchecker) shot in the scene lighting
        conditions, then the grey color picker tool can be used to quickly sample the luminance
        of the grey patch on the picture. In other situations, the color picker can be used to
        sample the average luminance of the subject.
      </p>
                        <p>
        This setting has an effect on the picture that is analogous to a lightness correction.
        Values close to 100% do not compress the highlights but fail to recover shadows. Values
        close to 0% recover greatly the shadows but compress the highlights more harshly and
        result in local-contrast losses. The standard middle-grey value for linearly encoded
        camera RGB is 18%. Good values of grey are usually the average luminance of the whole
        picture or of the subject. In studio and indoors (low dynamic range scenes), proper grey
        values are found between 15-18%. In high dynamic range scenes (landscapes, back-lit
        portraits), proper grey values lie between 1.25 and 9%.
      </p>
                        <p>
        When modifying the middle-grey luminance, the white and black exposures are
        automatically slid accordingly, to preserve the dynamic range from clipping and to help
        you set the right parameter faster. If you are not happy with the auto adjustment
        performed by the grey slider, you can correct again the white and black exposure
        parameters afterwards.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="whiteRelativeExposureSceneTab.d12e7994">
                     <title>White relative exposure (<uicontrol>Scene</uicontrol> tab)</title>
                     <body>
                        <p>
        The white relative exposure is the number of stops (EV) between pure white and the
        middle grey. It is the right bound of the dynamic range. It should be adjusted to avoid
        highlight clipping. The white exposure color picker tool reads the maximum luminance in
        RGB space over the drawn area, assumes it is pure white, and sets the white exposure
        parameter to remap the reading to 100% luminance.
      </p>
                        <p>
        When the grey is set at 18%, the white exposure will always be around 2.45EV. When the
        grey is set at 100%, the white exposure should be set at 0EV.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="blackRelativeExposureSceneTab.d12e8010">
                     <title>Black relative exposure (<uicontrol>Scene</uicontrol> tab)</title>
                     <body>
                        <p>
        The black relative exposure is the number of stops (EV) between pure black and the
        middle grey. It is the left bound of the dynamic range. The black exposure color-picker
        tool reads the minimum luminance in RGB space over the drawn area, assumes it is pure
        black, and sets the black exposure parameter to remap the minimum reading to 0%
        luminance. The black color picker measurement is very sensitive to noise, and cannot
        identify if the minimum luminance is pure black (actual data) or just noise. It works
        better on low ISO pictures and with high quality demosaicing. When the color picker puts
        the black exposure at -16EV, it is a sign that the measure failed and you need to adjust
        it manually.

      </p>
                        <p>
        The black relative exposure allows you to choose how far you want to recover lowlights.
        Contrarily to the white exposure, it is not always possible to completely avoid clipping
        blacks. Every camera sensor has a maximum physical dynamic range for each ISO value (you
        can find them measured on
        <xref href="https://www.dxomark.com/" format="html" scope="external">
                              <i>DXOmark</i>
                           </xref> or
        <xref href="https://www.dpreview.com/" format="html" scope="external">
                              <i>DPreview</i>
                           </xref>),
        the software dynamic range in filmic rgb (dynamic range = white exposure - black
        exposure) should generally not be greater than the physical dynamic range of the sensor
        (10-14EV in most cases). Note that the dynamic range of the scene can be lower than the
        camera's one, especially indoors.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="dynamicRangeScalingAndAutotuneSceneTab.d12e8035">
                     <title>Dynamic range scaling and auto-tune (<uicontrol>Scene</uicontrol> tab)</title>
                     <body>
                        <p>
        The auto-tune color picker combines all three color pickers above, and allows to set the
        grey, white and black exposures all at once, using the average of the drawn region as
        the grey estimation, the maximum as the white, and the minimum as the black. This gives
        good results in landscape photography but usually fails for portraits and indoor scenes.
      </p>
                        <p>
        When no true white and no true black are available on the scene, the maximum and minimum
        RGB values read on the image are not valid assumptions anymore, so the dynamic range
        scaling symmetrically shrinks or enlarges the detected dynamic range and the current
        parameters. This works with all color pickers, and adjusts the current values of white
        and black relative exposures.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="filmicrgb-contrast">
                     <title>Contrast (<uicontrol>Look</uicontrol> tab)</title>
                     <body>
                        <p>
        The filmic rgb S-curve is created from the user parameters, by computing the position of
        virtual nodes and interpolating them, similarly to the tone curve module (but here, the
        nodes cannot be moved manually). The filmic rgb S-curve is split into three parts: a
        middle linear part, and two extremities that transition smoothly from the slope of the
        middle part to the ends of the exposure range.
      </p>
                        <p>
        The
        <uicontrol>contrast</uicontrol>
        slider controls the slope of the middle part of the curve, as illustrated in the graph
        display.
      </p>
                        <p>
        The contrast parameter drives the slope of the central part of the curve. The larger the
        dynamic range is, the greater the contrast should be set. This parameter mostly affects
        mid-tones.
      </p>
                        <p>
        When the contrast is set to 1, this disables the S-curve.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="latitudeLookTab.d12e8074">
                     <title>Latitude (<uicontrol>Look</uicontrol> tab)</title>
                     <body>
                        <p>
        The latitude is the range between the 2 nodes enclosing the central linear portion of
        the curve, expressed as a percentage of the dynamic range defined in the
        <uicontrol>scene</uicontrol>
        tab (white-relative exposure minus black-relative-exposure). It is the luminance range
        that is remapped in priority, and it is remapped to the luminance interval defined by
        the <xref href="#filmicrgb-contrast">Contrast</xref> parameter. It is usually advised
        to keep the latitude as large as possible, while avoiding clipping. If clipping is
        observed, you can compensate the effects by either decreasing the latitude, shifting the
        latitude interval with the
        <uicontrol>shadow/highlights balance</uicontrol>
        parameter, or by decreasing the contrast.
      </p>
                        <p>
        The latitude also defines the range of luminances that is not desaturated at the
        extremities of the luminance range (see <xref href="#filmicrgb-saturation"/>).
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="shadowshighlightBalanceLookTab.d12e8100">
                     <title>Shadows/highlight balance (<uicontrol>Look</uicontrol> tab)</title>
                     <body>
                        <p>
        By default, the latitude is centered in the middle of the dynamic range. If this
        produces clipping in one part of the other of the curve, the balance parameter allows to
        slide the latitude along the slopes, towards the shadows or towards the highlights. This
        allows more room to be given to one extremity of the dynamic range than to the other, if
        the image properties demand it.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="filmicrgb-saturation">
                     <title>Extreme luminance saturation (<uicontrol>Look</uicontrol> tab)</title>
                     <body>
                        <p>
        The darker curve in the graph of the module shows the desaturation of the extremities of
        the luminance range (black and white): since black and white do not have a color, they
        should normally be associated to 0% saturation. The default saturation is set to 100% in
        the range defined by the latitude, and decreases down to 0% outside of that range. One
        of the advantages of this operations is that, since color components do not clip at the
        same rate in the image, desaturating them avoids fringes around the high exposures.
      </p>
                        <p>
        If the bright colors feel too desaturated, you should check that the white-relative
        exposure setting does not clip the high luminance spots, and if not, increase the
        extreme luminance saturation parameter.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="preserveChrominanceLookTab.d12e8128">
                     <title>Preserve chrominance (<uicontrol>Look</uicontrol> tab)</title>
                     <body>
                        <p>
        The
        <uicontrol>preserve chrominance</uicontrol>
        setting indicates how the chrominance should be handled by filmic rgb: either not at
        all, or using one of the provided three norms.
      </p>
                        <p>
        When applying the S-curve transformation independently on each color, the proportions of
        the colors get modified, which modifies the properties of the underlying spectrum, and
        ultimately the chrominance of the image. This is what happens if you choose
        <i>no</i> in the
        <uicontrol>preserve chrominance</uicontrol>
        parameter. This value may yield seemingly <q>better</q> results than the other
        values, but it may negatively impact later parts of the pipeline, when it comes to
        global saturation for example.
      </p>
                        <p>
        The other values of this parameter all work in a similar way. Instead of applying the
        S-curve to the channels R, G and B independently, filmic rgb uses a norm N, divides all
        the three components by that norm, and applies the S-curve to N. This way, the
        relationship between the channels is preserved.
      </p>
                        <p>
        The different values of the
        <uicontrol>preserve chrominance</uicontrol>
        parameter indicate which norm is used (the value used for N):
        <ul>
                              <li>
                                 <p>
                                    <i>max RGB</i> is the maximum value of the three channels R, G and B.
            It is the behaviour of the previous version of the filmic module. It tends to darken
            the blue, especially skies, and to yield halos/fringes, especially if some channels
            are clipped.
          </p>
                              </li>
                              <li>
                                 <p>
                                    <i>luminance Y</i> is a linear combination of the three channels R, G
            and B. It tends to darkens the reds, and to increase the local contrast in reds.
          </p>
                              </li>
                              <li>
                                 <p>
                                    <i>RGB power norm</i> is the sum of the cubes of the three channels R,
            G, and B, divided by the sum of their squares - that is to say, (R³ + G³ +
            B³)/(R² + G² + B²). It is usally a good compromise between the max RGB and the
            luminance Y values.
          </p>
                              </li>
                           </ul>
                        </p>
                        <p>
        There is no "right" choice for the norm, depending on the picture to which it applies -
        you should experiment and decide for yourself on case by case basis.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="targetBlackLuminanceDisplayTab.d12e8191">
                     <title>Target black luminance (<uicontrol>Display</uicontrol> tab)</title>
                     <body>
                        <p>
        The destination parameters set the target luminance values used to remap the tones
        through filmic rgb. The default parameters will work 99% of the times, the remaining 1%
        being when you output in linear RGB space (REC709, REC2020) for media handling
        log-encoded data. These settings are then to be used with caution because darktable does
        not allow separate pipelines for display preview and for file output.
      </p>
                        <p>
        The target black luminance parameter allows to set the ground-level black of the target
        medium. Set it greater than 0% if you want raised, faded blacks to achieve a retro look.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="targetMiddlegreyDisplayTab.d12e8206">
                     <title>Target middle-grey (<uicontrol>Display</uicontrol> tab)</title>
                     <body>
                        <p>
        This is the middle-grey of the output medium, that is used as a target for the filmic
        rgb S curve central node. On gamma corrected media, the actual grey is computed with the
        gamma correction (middle-grey^(1/gamma)), so a middle-grey parameter of 18% with a gamma
        of 2.2 gives an actual middle-grey target of 45.87%.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="targetWhiteLuminanceDisplayTab.d12e8218">
                     <title>Target white luminance (<uicontrol>Display</uicontrol> tab)</title>
                     <body>
                        <p>
        The target white luminance parameter allows to set the ceiling level white of the target
        medium. Set it lower than 100% if you want dampened, muted whites to achieve a retro
        look.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="targetPowerFactorFunction.d12e8230">
                     <title>Target power factor function</title>
                     <body>
                        <p>
        The power of the output transfer function, often improperly called the gamma (only
        screen have a gamma), is the parameter used to raise or compress the mid-tones to
        account for the display non-linearities or to avoid quantization artifacts when encoding
        in 8 bits file formats. This is a common operation when applying ICC color profiles
        (except for linear RGB spaces, like REC 709 or REC 2020, which have a linear
        <q>gamma</q> of 1.0). However, at the output of filmic rgb, the signal is
        logarithmically encoded, which is not something ICC color profiles know to handle. As a
        consequence, if we let them apply a gamma 1/2.2 on top, it will result in a double up,
        and the middle-grey will be remapped to 76% instead of 45% as it should.
      </p>
                        <p>
        To avoid double ups and washed pictures, filmic rgb applies a <q>gamma</q>
        compression reverting the output ICC gamma correction, so the middle-grey is correctly
        remapped at the end. To remove this compression, set the destination power factor to 1.0
        and the middle-grey destination to 45%.
      </p>
                     </body>
                     
                  </topic>
               </topic>
               <topic xml:lang="en-us" id="workflow.d12e8250">
                  <title>Workflow</title>
                  <body>
                     <p>
      The filmic rgb module can seem pretty complex; here is a proposed workflow for processing
      an image with filmic rgb to obtain a well-exposed picture from a RAW file.
    </p>
                     <ol>
                        <li> Modify the exposure in the <xref href="#exposure">
                              <i>exposure</i>
                           </xref> module so that the midtones are clear enough. Do not worry about
                           losing details in the highlights: they will be recovered by the next
                           steps of the processing. </li>
                        <li> In filmic rgb, start with <q>neutral</q> parameters: set the the middle
                           grey luminance to 18.45% in the <uicontrol>scene</uicontrol> tab, and set
                           the contrast to 1 in the <uicontrol>look</uicontrol> tab. </li>
                        <li> Adjust the white-relative and black-relative exposures in the
                              <uicontrol>scene</uicontrol> tab; set the middle grey luminance as
                           well. </li>
                        <li> In the <uicontrol>look</uicontrol> tab, experiment with the
                              <uicontrol>contrast</uicontrol> parameter. Increase the latitude as
                           much as you can without clipping the curve, slide it with the
                              <uicontrol>shadows/highlights balance</uicontrol> parameter. </li>
                        <li> filmic rgb tends to compress the local contrast - you can compensate
                           for that using the <xref href="#local_contrast">
                              <i>local contrast</i>
                           </xref> module. </li>
                        <li> You may also want to increase the saturation in the <xref
                              href="#color_balance">
                              <i>color balance</i>
                           </xref> module, and adjust settings in the <i>tone equalizer</i> module. </li>
                        <li> Do the last adjustments in filmic rgb, and your picture is now ready
                           for creative processing. </li>
                     </ol>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="filmic-rgb-for-26-users">
                  <title>Filmic rgb for Darktable 2.6 filmic users</title>
                  <body>
                     <p>
      Filmic rgb is a reimplementation of the filmic module, and some adjustments are necessary
      to switch from one version to the other. This last section underlines the most important
      differences; a more comprehensive overview is available as a video called
      <xref href="https://www.youtube.com/watch?v=9awBFYcPgGU"
                              format="html"
                              scope="external">darktable 3.0 filmic
      explained to users of darktable 2.6</xref>. The major differences points when it comes to
      usage are the following:
      <ul>
                           <li> The default parameters of both modules are not comparable:
                              activating the filmic rgb module with default parameters does not
                              yield the same results as the previous filmic module with default
                              parameters. </li>
                           <li> The latitude is now expressed in percentage of the dynamic range
                              instead of absolute EV values. </li>
                           <li> The saturation slider that was present in the previous version of
                              filmic to avoid oversaturation is not necessary anymore since filmic
                              rgb does a much better job at preserving colors. </li>
                           <li> The previous version of filmic was always using the prophoto RGB
                              profile; filmic rgb respects the working color profile defined in the
                                 <xref href="#input_color_profile">
                                 <i>input color profile</i>
                              </xref> module. To keep the same behaviour, you can set the working
                              profile to <i>linear prophoto RGB</i>. </li>
                        </ul>
                     </p>
                     <p>
      To achieve similar results between the previous version of filmic and filmic rgb, the
      following steps are suggested:
      <ol>
                           <li> Transfer the parameters from filmic to filmic rgb. The latitude
                              parameter is now given in percentage of the input dynamic range:
                              compute that percentage from your filmic input values. </li>
                           <li> Lower the contrast. </li>
                           <li> Set the extreme luminance saturation to 50%, unless you are using
                              the chrominance preservation. </li>
                           <li> Adjust the shadows/highlights balance to avoid clipping of the curve </li>
                           <li> Rais the middle grey luminance a bit, set the dynamic range scaling
                              to approximately 6%. </li>
                           <li> The old <i>preserve chrominance</i> setting corresponds to the
                                 <i>max RGB</i> mode; in that case, do not modify the extreme
                              luminance saturation. </li>
                           <li> If you experience weird color shifts, change the working color space
                              to prophoto RGB in the <xref href="#input_color_profile">
                                 <i>input color profile</i>
                              </xref> module. </li>
                        </ol>
                     </p>
                  </body>
                  
               </topic>
            </topic>
         </topic>
         <topic xml:lang="en-us" id="color_group">
            <title>Color group</title>
            <body>
               <p>
    Modules for working specifically on your image's color are found here in the color group.
  </p>
            </body>
            <topic xml:lang="en-us" id="channel_mixer">
               <title>Channel mixer</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>channel mixer</indexterm></indexterm>
                        <indexterm>channel mixer</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e8441">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module is a powerful tool to manage channels. It accepts red, green and blue
              channels as an input. As output it provides red, green, blue, gray, hue,
              saturation and lightness channels.
            </entry>
                                 <entry>
                                    <image href="modules/images/channelmixer.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e8473">
                  <title>Usage</title>
                  <body>
                     <p>
      First select your output channel and then set the amount each input channel feeds into
      that output channel. Among its many uses, this module can be used to see the RGB channels
      individually: use the gray destination and put the value 1 on the input channel you want
      to see and 0 on the others.
    </p>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="examples.d12e8482">
                  <title>Examples</title>
                  <body>
                     <p>
                        <table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="2">
                              <colspec colwidth="4*"/>
                              <colspec colwidth="6*"/>
                              
                              <tbody>
                                 <row>
                                    <entry>
                                       <image href="modules/images/channelmixer_ex1.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                For skin tones the blue channel tends to represent detail, with red tending to
                also have smoother tones than green. Therefore tonal rendering is controlled by
                how we blend of the three input channels.
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                                       <image href="modules/images/channelmixer_ex2.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                Here a monochrome portrait is produced by simply selecting the grey channel as
                output. A smooth skin tone is achieved by reducing the blue channels input and
                also emphasizing the red channels input relative to green. An RGB mix of 0.9,
                0.3, -0.3 was used together with an 0.1 EV exposure increase to lighten the
                image.
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                                       <image href="modules/images/channelmixer_ex3.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                In this example an RGB mix of 0.4, 0.75, -0.15 uses more green than red,
                bringing back some features. We still reduce the blue channel in the mix to
                de-emphasize unwanted skin texture.
              </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table>
                     </p>
                  </body>
                  <topic xml:lang="en-us" id="tableOfMixingValuesForSomeBwFilms.d12e8542">
                     <title>Table of mixing values for some b/w films</title>
                     <body>
                        <p>
        Classic black and white films have different characteristic color responses. Select gray
        as output mixing channel, and try out the values suggested below for your favorite film
        type.
      </p>
                        <table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="4">
                              <colspec colwidth="2*"/>
                              <colspec colwidth="1*"/>
                              <colspec colwidth="1*"/>
                              <colspec colwidth="1*"/>
                              
                              <tbody>
                                 <row>
                                    <entry>
                Film Type
              </entry>
                                    <entry>
                Red
              </entry>
                                    <entry>
                Green
              </entry>
                                    <entry>
                Blue
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                AGFA 200X
              </entry>
                                    <entry>
                0.18
              </entry>
                                    <entry>
                0.41
              </entry>
                                    <entry>
                0.41
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                Agfapan 25
              </entry>
                                    <entry>
                0.25
              </entry>
                                    <entry>
                0.39
              </entry>
                                    <entry>
                0.36
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                Agfapan 100
              </entry>
                                    <entry>
                0.21
              </entry>
                                    <entry>
                0.40
              </entry>
                                    <entry>
                0.39
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                Agfapan 400
              </entry>
                                    <entry>
                0.20
              </entry>
                                    <entry>
                0.41
              </entry>
                                    <entry>
                0.39
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                Ilford Delta 100
              </entry>
                                    <entry>
                0.21
              </entry>
                                    <entry>
                0.42
              </entry>
                                    <entry>
                0.37
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                Ilford Delta 400
              </entry>
                                    <entry>
                0.22
              </entry>
                                    <entry>
                0.42
              </entry>
                                    <entry>
                0.36
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                Ilford Delta 3200
              </entry>
                                    <entry>
                0.31
              </entry>
                                    <entry>
                0.36
              </entry>
                                    <entry>
                0.33
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                Ilford FP4
              </entry>
                                    <entry>
                0.28
              </entry>
                                    <entry>
                0.41
              </entry>
                                    <entry>
                0.31
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                Ilford HP5
              </entry>
                                    <entry>
                0.23
              </entry>
                                    <entry>
                0.37
              </entry>
                                    <entry>
                0.40
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                Ilford Pan F
              </entry>
                                    <entry>
                0.33
              </entry>
                                    <entry>
                0.36
              </entry>
                                    <entry>
                0.31
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                Ilford SFX
              </entry>
                                    <entry>
                0.36
              </entry>
                                    <entry>
                0.31
              </entry>
                                    <entry>
                0.33
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                Ilford XP2 Super
              </entry>
                                    <entry>
                0.21
              </entry>
                                    <entry>
                0.42
              </entry>
                                    <entry>
                0.37
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                Kodak T-Max 100
              </entry>
                                    <entry>
                0.24
              </entry>
                                    <entry>
                0.37
              </entry>
                                    <entry>
                0.39
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                Kodak T-Max 400
              </entry>
                                    <entry>
                0.27
              </entry>
                                    <entry>
                0.36
              </entry>
                                    <entry>
                0.37
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                Kodak Tri-X 400
              </entry>
                                    <entry>
                0.25
              </entry>
                                    <entry>
                0.35
              </entry>
                                    <entry>
                0.40
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                Normal Contrast
              </entry>
                                    <entry>
                0.43
              </entry>
                                    <entry>
                0.33
              </entry>
                                    <entry>
                0.30
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                High Contrast
              </entry>
                                    <entry>
                0.40
              </entry>
                                    <entry>
                0.34
              </entry>
                                    <entry>
                0.60
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                Generic B/W
              </entry>
                                    <entry>
                0.24
              </entry>
                                    <entry>
                0.68
              </entry>
                                    <entry>
                0.08
              </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="color_balance">
               <title>Color balance</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>color balance</indexterm></indexterm>
                        <indexterm>color balance</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e8878">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module offers a versatile tool for adjusting an image's color balance.
              It can be used to revert parasite color casts or to enhance the visual
              atmosphere of a picture using color grading, a popular technique in the cinema
              industry.
            </entry>
                                 <entry>
                                    <image href="modules/images/colorbalance.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e8910">
                  <title>Usage</title>
                  <body>
                     <p>
      The color balance allows you to shift colors selectively by luminance range: shadows,
      mid-tones, and highlights. It does so using two different methods:

      <ul>
                           <li>
                              <p>
                                 <i>lift, gamma, gain</i>, the classic way, that allows a more
          separated control of shadows versus highlights,
        </p>
                           </li>
                           <li>
                              <p>
                                 <i>slope, offset, power</i>, the new standard defined by the
          American Society of Cinematographers Color Decision List <i>(ASC CDL)</i>,
          more suited for scene-referred editing.
        </p>
                           </li>
                        </ul>

                     </p>
                     <p>
      The master settings affect the whole image. They are not available in
      <i>lift, gamma, gain (sRGB)</i> mode. The slider ranges are limited
      to usual values ([50%; 150%] for saturations, [-50%; 50%] for contrast), but higher and lower
      values can be defined from keyboard inputs after a right-click on the corresponding
      slider.
    </p>
                     <p>
      Side note: although this module acts on RGB colors its location in pixelpipe puts it into
      the Lab color space. Accordingly the modules converts from Lab to RGB, does its color
      adjustments, and then converts back to Lab.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="mode.d12e8947">
                     <title>Mode</title>
                     <body>
                        <p>
                           <ul>
                              <li>
                                 <p>
                                    <i>lift, gamma, gain (sRGB)</i> is the legacy mode from darktable
            2.4 and previous. In this mode, the color transformations are applied in sRGB
            color space encoded with the sRGB gamma (average gamma of 2.2).
          </p>
                              </li>
                              <li>
                                 <p>
                                    <i>lift, gamma, gain (ProPhotoRGB)</i> is the same as the previous
            but works in ProPhoto RGB space, encoded linearly. In this mode, the RGB parameters
            are corrected in XYZ luminance (Y channel) internally so they affect only the color,
            and only the <q>factors</q> adjust the luminance.
          </p>
                              </li>
                              <li>
                                 <p>
                                    <i>slope, offset, power (ProPhotoRGB)</i> applies the <i>ASC CDL</i>
            in ProPhoto RGB space, encoded linearly. Similarly to the previous mode, the RGB
            parameters are corrected in XYZ luminance internally. In this mode, the slope
            parameter acts as an exposure compensation, the offset acts as a black level
            correction, and the power acts as a gamma correction. All parameters will have some
            impact on the whole luminance range, but the slope will mostly affect the highlights,
            the offset will mostly affect the shadows, and the power will mostly affect the
            mid-tones.
          </p>
                              </li>
                           </ul>
                        </p>
                        <p>
        For better efficiency, in <i>slope, offset, power</i>, it is recommended
        to set the slope first, then the offset, and finally the power, in this order. The
        name of the mode can be use as a mnemonic to remember the order.
      </p>
                        <p>
        In <i>slope, offset, power</i> mode, the shadows parameter has a far heavier
        effect than in <i>lift, gamma, gain</i>. Switching from the former to
        the latter, you should adapt the saturation in shadows, dividing by around 10.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="colorControlSliders.d12e9001">
                     <title>Color control sliders</title>
                     <body>
                        <p>
        These parameters affect the user interface used for the shadows, mid-tones and highlights
        controls.
      </p>
                        <p>
        The <i>RGBL</i> controls allow direct access of the RGB parameters
        that will be sent to the algorithm and internally adjusted in XYZ luminance,
        depending on the <i>mode</i> used. They are the only ones stored in darktable's
        development history.
      </p>
                        <p>
        The <i>HSL</i> controls allow a more intuitive control, but are only
        an interface: the hues and saturations are computed dynamically from and to the RGB
        parameters and never stored. During the HSL to RGB conversion, the HSL lightness is always
        assumed to be 50%, so the RGB parameters are always balanced to avoid lightness
        changes. However, during the RGB to HSL conversion, the HSL lightness is not corrected.
      </p>
                        <p>
        As a consequence, editing in RGB, then in HSL, then again in RGB will not retain
        the original RGB parameters, but will normalize them so their HSL lightness is 50%.
        The difference is barely noticeable in most cases, especially using the
        modes that already correct the RGB parameters internally in XYZ luminance.
      </p>
                        <p>
        In both modes, additional <q>factor</q> sliders act on all RGB channels at
        once. Their effect is similar to the controls of the <i>levels</i>
        module (see <xref href="#levels"/>) and affect only the luminance.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="inputSaturation.d12e9040">
                     <title>Input saturation</title>
                     <body>
                        <p>
        The input saturation is a saturation correction applied before the color balance.
        It can be used to dampen colors before adjusting the balance, to make difficult
        pictures easier to process.
        When you desaturate entirely the image, it creates a luminance-based monochrome
        picture that can be used as a luminance mask, to create color filters with the
        color balance settings, like split-toning or sepia effect
        (you might want to use blending modes then).
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="outputSaturation.d12e9049">
                     <title>Output saturation</title>
                     <body>
                        <p>
        The output saturation is a saturation correction applied just after the color balance.
        It is useful once you have found a proper hue balance but find the
        effect too heavy, so you can adjust the global saturation at once instead of editing
        each channel saturation separately at the expense of possibly messing the colors.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="contrastAndContrastFulcrum.d12e9058">
                     <title>Contrast and Contrast fulcrum</title>
                     <body>
                        <p>
        The contrast slider allows to increase the luminance separation. The fulcrum value
        defines the luminance value that will not be affected by the contrast correction,
        so the contrast will roll over the fulcrum. Luminance values above the fulcrum
        will be amplified almost linearly. Luminance values below the fulcrum value will
        be compressed with a power function (creating a toe). This correction comes after
        the output saturation and is applied on all RGB channels separately, so hues and saturations
        might not be preserved in case of dramatic settings (shadows might be resaturated,
        highlights might be desaturated, and some color shift is to be expected).
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="shadowsMidtonesHighlights.d12e9067">
                     <title>Shadows, Mid-tones, Highlights</title>
                     <body>
                        <p>
        Depending on the mode set, the shadows settings will control either the lift or the offset,
        the mid-tones ones will control either the gamma or the power, and the highlights
        ones will control either the gain or the slope. Parameters are transferred as is
        when you change the mode.
      </p>
                        <p>
        In RGBL mode, the RGB sliders range is limited to [-0.5; 0.5]. In HSL mode, the
        saturation sliders range is limited to [0%; 25%]. Values outside of these bounds
        can be defined from keyboard input after right-click on the slider.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="optimizeLuma.d12e9079">
                     <title>Optimize luma</title>
                     <body>
                        <p>
        The color-picker close to the <i>optimize luma</i> label will
        select the whole image and optimize the <i>factors</i> for shadows,
        mid-tones and highlights so the average luminance of the picture is 50% Lab,
        the maximum is 100% and the minimum is 0%, at the output of this module. This
        is essentially an histogram normalization, similar to what the levels module can
        achieve. The optimizer is accurate only when used in <i>slope, offset, power</i>
        mode. It works only fairly in the other modes.
      </p>
                        <p>
        In case you want more control, you can define three control patches using the color-pickers
        in front of each factor slider, to sample luminance in selected areas. The shadows
        color-picker samples the minimum luminance, the mid-tones one samples the average,
        and the highlights one samples the maximum luminance.
        The most sensitive parameter is the mid-tones factor,
        since selecting a slightly different area can lead to dramatic parameter changes.
        Using the factors color-pickers alone, without triggering the luma optimization,
        will allow to perform adjustments without general optimization, but each parameter is always
        computed accounting from the two others. Once patches are selected, the label becomes
        <q>optimize luma from patches</q>. To reset one patch, you can just redo the
        selection. Patches are not saved in the parameters and are kept only during the current
        session.
      </p>
                        <p>
        It is important no note that the luminance adjustment performed targets only the
        output of the color balance module and does not account for other luminance adjustments
        performed in modules coming later in the pixelpipe (filmic, tone curve, color zones,
        levels, global tonemapping, etc.). Using the color balance to remap the luminance
        globally on the image is not recommended because it does not preserve the original colors,
        and modules such as tone curves or filmic are better suited for this purpose.
        Luminance adjustments in color balance are better suited for local correction,
        in combination with color adjustments, for color-grading with masks.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="neutralizeColors.d12e9106">
                     <title>Neutralize colors</title>
                     <body>
                        <p>
        In an image where some areas are exposed to direct sunlight and some areas are
        exposed to reflected light (shadows), or when several artificial light sources are present
        simultaneously, shadows and highlights often have different color temperatures.
        These images are particularly difficult to correct since no general white balance will
        match all the colors at once. The color neutralization optimizer aims at helping you find
        the complementary color for shadows, midtones, and highlights so all the color casts
        are reverted, and the average color of the picture is a neutral grey.
      </p>
                        <p>
        Similarly to the luma optimization, the color-picker next to the <i>neutralize colors</i> 
        label will trigger a general optimization over the whole picture. This works fairly in
        landscape photography, or any photography with a full spectrum of colors and
        luminances. For night and events photography, this will most likely fail and you will
        need to input manually the sampling areas with the color-pickers in front of each hue slider.
        For the highlights sample, use a color exposed to spotlights that should be neutral
        white or light grey. For the shadows sample, use a color exposed to ambient light
        that should be neutral black or dark grey. For the mid-tones sample, use a color exposed
        by both ambient and spot lights.
      </p>
                        <p>
        The success of the optimization depends on the quality of the samples. Not every
        set of samples will converge to a good solution, you need to ensure the color
        patches you choose are really neutral color in real life. In many cases the optimizer
        will output the correct hue but an excessive saturation that will need some extra tweaking.
        In some cases, no valid optimization will be delivered and you will need to reset
        the saturation parameters and start over, or simply stop after the patches selection.
        Notice that in the auto-optimization the maximum saturation is 25% which might
        not be enough in very few cases but will avoid inconsistent results in most.
      </p>
                        <p>
        If you select color patches from the hues color-pickers, without triggering the optimization,
        the software will only perform one round of optimization and stop so it allows you
        to control each luminance range separately and avoid divergence of the solution in corner cases.
        The hue and saturation corrections are computed accounting for the two other
        luminance ranges and the three factors, and will always output the complementary color
        of the selected area. If you want to reinforce the color of the area instead, you can then add 180°
        to the computed hue. Once patches are selected the label becomes
        <q>neutralize colors from patches</q>. To reset one patch you can just redo the
        selection. Patches are not saved in the parameters and are kept only during the current
        session. The parameters found by the automatic neutralization are accurate only in
        <i>slope, offset, power</i> mode, but can work to some extent in
        <i>lift, gamma, gain</i> too.
      </p>
                     </body>
                     
                  </topic>
               </topic>
               <topic xml:lang="en-us" id="examples.d12e9137">
                  <title>Examples</title>
                  <body>
                     <p>
      Several presets are provided in the module to help you understand how it can be used.
    </p>
                     <p>
      The teal/orange color-grading preset is a very popular look in cinema and a good showcase model.
      It is meant to be used with two instances and masks: the first instance will exclude
      skin tones and will shift neutral colors toward teal blue. The second will partially revert
      the first one and add more vibrance on skin tones only. Together they will help creating
      separation between subjects and backgrounds. The masking and blending parameters will
      need to be tweaked to suit every picture, though.
    </p>
                     <p>
      Other presets provide Kodak film emulations. In the same way you can recreate any film
      look you like with color balance.
    </p>
                  </body>
                  
               </topic>
            </topic>
            <topic xml:lang="en-us" id="color_look_up_table">
               <title>Color look up table</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>color look up table</indexterm></indexterm>
                        <indexterm>color look up table</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <body/>
               <topic xml:lang="en-us" id="overview.d12e9173">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module implements a generic color look up table in Lab space. The input is a
              list of source and target points, the complete mapping will be interpolated using
              splines. The resulting luts are editable by hand and can be created using the
              <filepath>darktable-chart</filepath> utility to match given input (such as
              hald-cluts and RAW/JPEG with in-camera processing pairs). See
              <xref href="darktable_chart"/> for details.
            </entry>
                                 <entry>
                                    <image href="modules/images/colorchecker.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e9210">
                  <title>Usage</title>
                  <body/>
                  <topic xml:lang="en-us" id="colorBoard.d12e9215">
                     <title>color board</title>
                     <body>
                        <p>
        When you select the module in darkroom mode, it should look something like the image
        above (configurations with more than 24 patches are shown in a 7x7 grid instead). By
        default, it will load the 24 patches of a color checker classic and initialise the
        mapping to identity (no change to the image).
      </p>
                        <p>
        The grid shows a list of colored patches. The colors of the patches are the source
        points. The target color of the selected patch is shown as offsets controlled by sliders
        in the GUI under the grid of patches. An outline is drawn around patches that have been
        altered, i.e. the source and target colors differ.
      </p>
                        <p>
        The selected patch is marked with a white square, and its number is displayed in the
        combo box below. Select a patch by left clicking on it, or using the combo box, or using
        the color picker.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="interaction.d12e9230">
                     <title>interaction</title>
                     
                     <prolog>
                        <metadata><keywords>
                              <indexterm>color picker</indexterm>
                           </keywords></metadata>
                        
                     </prolog>
                     <body>
                        <p>
        To modify the color mapping, you can change source as well as target colors.
      </p>
                        <p>
        The main use case is to change the target colors. You start with an appropriate palette
        of source colors (either from the presets menu or from a style you download). You can
        then change lightness (L), green-red (a), blue-yellow (b), or saturation (C) of the
        patches' target values via sliders.
      </p>
                        <p>
        To change the source color of a patch you select a new color from your image by using
        the color picker, and Shift+click on the patch you want to replace. You can switch
        between point and area sampling mode from within the global color picker panel (see
        <xref href="#global_color_picker"/>).
      </p>
                        <p>
        To reset a patch, double-click it. Right-click a patch to delete it. Shift+click on
        empty space to add a new patch (with the currently picked color as source color).
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="color_contrast">
               <title>Color contrast</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>color contrast</indexterm></indexterm>
                        <indexterm>color contrast</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e9278">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              The color contrast module provides simplified control for changing the contrast or
              separation of colors between either green/magenta or blue/yellow axis.
            </entry>
                                 <entry>
                                    <image href="modules/images/colorcontrast.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e9310">
                  <title>Usage</title>
                  <body>
                     <p>
      Higher values increase color contrast, lower values decrease it. The effect of this
      module's sliders are similar to applying a steepened or flattened a- or b-curve in module
      <i>tone curve</i> (see <xref href="#tone_curve"/>).
    </p>
                  </body>
                  <topic xml:lang="en-us" id="greenVsMagenta.d12e9323">
                     <title>green vs. magenta</title>
                     <body>
                        <p>
        Changes color contrast for green versus magenta.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="blueVsYellow.d12e9332">
                     <title>blue vs. yellow</title>
                     <body>
                        <p>
        Changes color contrast for blue versus yellow.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="color_correction">
               <title>Color correction</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>color correction</indexterm></indexterm>
                        <indexterm>color correction</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e9364">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module can be used to modify the global saturation, give a tint to the image
              or to split tone it.
            </entry>
                                 <entry>
                                    <image href="modules/images/colorcorrection.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e9396">
                  <title>Usage</title>
                  <body/>
                  <topic xml:lang="en-us" id="colorBoard.d12e9401">
                     <title>color board</title>
                     <body>
                        <p>
        For split toning move the white dot to the desired highlight tint and then select a tint
        for shadows with the dark spot. For a simple global tint set both spots to the same
        color.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="saturation.d12e9410">
                     <title>saturation</title>
                     <body>
                        <p>
        Use the saturation slider to correct the global saturation.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="color_zones">
               <title>Color zones</title>
               
               <prolog>
                  <metadata><keywords></keywords></metadata>
                  
               </prolog>
               <body/>
               <topic xml:lang="en-us" id="overview.d12e9441">
                  <title>Overview</title>
                  
                  <prolog>
                     <metadata><keywords>
                           <indexterm>modules<indexterm>color zones</indexterm></indexterm>
                           <indexterm>color zones</indexterm>
                        </keywords></metadata>
                     
                  </prolog>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module selectively modifies the colors in your image. It is highly versatile
              and allows every transformation possible in the LCh colorspace.
            </entry>
                                 <entry>
                                    <image href="modules/images/colorzones.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e9473">
                  <title>Usage</title>
                  <body>
                     <p>
      The horizontal axis represents the range of values you can work on. The vertical axis
      shows the modifications you can apply by designing a curve. For both horizontal and
      vertical axes you can work on lightness, saturation or hue.
    </p>
                     <p>
      You can click on any of the eight nodes on the curve and drag to adjust it vertically. A
      circle indicates how strong adjacent nodes will be affected. Use the scroll wheel of your
      mouse to change the circle diameter. You can also use the eight controlpoints (triangles
      which define the vertical value of the nodes) at the bottom to adjust the curve.
    </p>
                     <p>
      A color picker is activated by pressing
      <image href="../images/darkroom_module_icon_picker.png" align="center"/>
      and will show the picked values in the diagram. You can switch between point and area
      sampling mode from within the global color picker panel (see
      <xref href="#global_color_picker"/>).
    </p>
                  </body>
                  <topic xml:lang="en-us" id="tabbedControls.d12e9499">
                     <title>tabbed controls</title>
                     <body>
                        <p>
        You can define curves for each of the three channels <q>lightness</q>,
        <q>saturation</q>, and <q>hue</q> individually.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="selectBy.d12e9518">
                     <title>select by</title>
                     <body>
                        <p>
        Defines the horizontal axis, i.e. the range of values you work on. You can choose
        between <q>lightness</q>, <q>saturation</q>, and <q>hue</q>
        (default). Changing this parameter resets any defined curve to a straight horizontal
        line.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="mix.d12e9536">
                     <title>mix</title>
                     <body>
                        <p>
        Use this parameter to tune the strength of the overall effect.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="input_color_profile">
               <title>Input color profile</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>input color
                              profile</indexterm></indexterm>
                        <indexterm>input color profile</indexterm>
                        <indexterm>color management<indexterm>input color
                              profile</indexterm></indexterm>
                        <indexterm>artifact mitigation<indexterm>blue light
                              sources</indexterm></indexterm>
                        <indexterm>artifact mitigation<indexterm>black
                              pixels</indexterm></indexterm>
                        <indexterm>gamut clipping</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e9601">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module can be used to override darktable's automatic allocation of input
              color profile if there is an alternative that more closely matches your original
              image's color space.
            </entry>
                                 <entry>
                                    <image href="modules/images/inputcolorprofile.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e9633">
                  <title>Usage</title>
                  <body>
                     <p>
      In this module you define the input color profile, i.e. how colors of your input image are
      to be interpreted. You also have an option to have colors confined to a certain gamut in
      order to mitigate some (infrequent) color artifacts.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="profile.d12e9641">
                     <title>profile</title>
                     <body>
                        <p>
        Choose the profile or color matrix to apply, darktable offers many widespread matrices
        along with an enhanced matrix for some camera models. The enhanced matrices were
        processed by the darktable team in order to provide a look closer to the manufacturer's.
      </p>
                        <p>
        You can also supply your own input ICC profiles and put them into
        $DARKTABLE/share/darktable/color/in or $HOME/.config/darktable/color/in. $DARKTABLE is
        used here to represent darktable's installation directory and $HOME your home directory.
        One common source of ICC profiles is the software that is shipped with your camera; it
        often contains profiles specific to your camera model. You may need to activate module
        <i>unbreak input profile</i> (see <xref href="#unbreak_input_profile"/>)
        to use your extra profiles.
      </p>
                        <p>
        If your input image is a low dynamic range file like JPEG, or a raw in DNG format, it
        might already contain an embedded ICC profile which darktable will use as a default. You
        can always overrule darktable and select a different profile. Select <q>embedded icc
        profile</q> to restore the default.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="gamutClipping.d12e9664">
                     <title>gamut clipping</title>
                     <body>
                        <p>
        This combobox lets you activate a color clipping mechanism. In most cases you can leave
        it at its default <q>off</q> state. However, if your image shows some specific
        features like highly saturated blue light sources, gamut clipping might be useful to
        avoid black pixel artifacts. See <xref href="#possible_color_artifacts"/> for more
        background information.
      </p>
                        <p>
        You can select from a list of RGB profiles. Input colors with a saturation that exceeds
        the permissible range of the selected profile get clipped to a maximum value.
        <q>linear Rec2020 RGB</q> and <q>Adobe RGB (compatible)</q> allow for a
        broader range of unclipped colors, while <q>sRGB</q> and <q>linear Rec709
        RGB</q> produce a tighter clipping. You should select the profile that prevents
        artifacts while still maintaining highest color dynamics.
      </p>
                     </body>
                     
                  </topic>
               </topic>
               <topic xml:lang="en-us" id="examples.d12e9694">
                  <title>Examples</title>
                  <body>
                     <p>
                        <table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="2">
                              <colspec colwidth="4*"/>
                              <colspec colwidth="6*"/>
                              
                              <tbody>
                                 <row>
                                    <entry>
                                       <image href="modules/images/inputcolorprofile_ex1.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                Close-up of a blue light source (LED) with gamut clipping off. The activated
                levels module produces a ring of black pixel artifacts.
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                                       <image href="modules/images/inputcolorprofile_ex2.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                The same image and processing with gamut clipping set to <q>linear Rec2020
                RGB </q>.
              </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table>
                     </p>
                  </body>
                  
               </topic>
            </topic>
            <topic xml:lang="en-us" id="lut3d">
               <title>3D LUT</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>lut3d</indexterm></indexterm>
                        <indexterm>lut3d</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e9766">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
                                    <p>
                A <i>3D LUT</i> is a tridimensional table which allows for
                the transforming any RGB value into another RGB value, normally used for film
                simulation and color grading.
              </p>
                                    <p>
                The module accepts <i>.cube</i> and <i>.png (haldclut)</i> files.
                The 3D LUT data are not saved in database nor in the XMP file, only the 3D LUT file path
                inside the 3D LUT folder is saved (see below).
              </p>
                                 </entry>
                                 <entry>
                                    <image href="modules/images/lut3d-1.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                     <p>
      The module lut3d needs to find the 3D LUT file at the same place in your 3D LUT folder
      to calculate the output image.
      This means you have to backup properly your 3D LUT folder.
      Sharing an image with its XMP is useless if the recipient doesn't have the same 3D LUT file
      in his 3D LUT folder.
    </p>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e9816">
                  <title>Usage</title>
                  <body/>
                  <topic xml:lang="en-us" id="fileSelection.d12e9821">
                     <title>file selection</title>
                     <body>
                        <p>
        File selection is inactive as long as the 3D LUT folder (where you have stored your LUT files)
        is not defined in <i>3D LUT root folder</i> under
        <i>preferences/core options/miscellaneous</i>.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="applicationColorSpace.d12e9836">
                     <title>application color space</title>
                     <body>
                        <p>
        A 3D LUT is relative to a specific color space. You have to select the one for which it has been built.
        Cube files are usually related to <i>REC.709</i> while most of others are
        related to <i>sRGB</i>.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="interpolation.d12e9851">
                     <title>interpolation</title>
                     <body>
                        <p>
        The interpolation method defines how to calculate output colors when input colors are not exactly on a node
        of the RGB cube (described by the 3D LUT).
        There are three interpolation methods available: <i>tetrahedral</i> (the default one),
        <i>trilinear</i> and <i>pyramid</i>.
        Usually you won't see any difference between the interpolation methods except with small size LUTs.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="monochrome">
               <title>Monochrome</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>monochrome</indexterm></indexterm>
                        <indexterm>monochrome</indexterm>
                        <indexterm>artifact mitigation<indexterm>black
                              pixels</indexterm></indexterm>
                        <indexterm>artifact mitigation<indexterm>blue light
                              sources</indexterm></indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e9909">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module is a quick way to convert an image into black and white and provides a
              variable color filter for that conversion.
            </entry>
                                 <entry>
                                    <image href="modules/images/monochrome.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e9942">
                  <title>Usage</title>
                  <body>
                     <p>
      A color picker is activated by pressing
      <image href="../images/darkroom_module_icon_picker.png" align="center"/>
      and will automatically set the position and size of the filter. You can switch between
      point and area sampling mode from within the global color picker panel (see
      <xref href="#global_color_picker"/>).
    </p>
                     <p>
      The default central location of the filter has a neutral effect but dragging it to an
      alternate position applies a filter analogously to taking a b&amp;w photograph through a
      conventional color filter.
    </p>
                     <p>
      As well as position you can change the filter size by scrolling with your mouse wheel.
      This makes the filter's range of hues more or less selective.
    </p>
                     <p>
      Tip: First reduce the filter size to concentrate its effect and move it across the hue
      pallet to find the best filter value for your desired image rendition. Then expand the
      filter to include more hues and thus more natural tonality.
    </p>
                     <p>
      Under certain conditions, especially highly saturated blue light sources in the frame,
      this module may produce black pixel artifacts. See the <i>gamut clipping</i>
      option (<xref href="#input_color_profile"/>) on how to mitigate this issue.
    </p>
                  </body>
                  
               </topic>
            </topic>
            <topic xml:lang="en-us" id="output_color_profile">
               <title>Output color profile</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>output color
                              profile</indexterm></indexterm>
                        <indexterm>output color profile</indexterm>
                        <indexterm>color management<indexterm>output color
                              profile</indexterm></indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e10011">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
                                    <p>
                This module manages the output profiles for export as well as the rendering
                intent to be used when mapping between the different color spaces.
              </p>

                                    <p>
                darktable comes with pre-defined profiles sRGB, AdobeRGB, XYZ and linear RGB but
                you can provide additional profiles by placing these in
                <filepath>$DARKTABLE/share/darktable/color/out</filepath> and
                <filepath>$HOME/.config/darktable/color/out</filepath>.
                <filepath>$DARKTABLE</filepath> is used here to represent your chosen darktable
                installation directory and <filepath>$HOME</filepath> your home directory.
              </p>
                                 </entry>
                                 <entry>
                                    <image href="modules/images/outputcolorprofile.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e10061">
                  <title>Usage</title>
                  <body>
                     <p>
      You can define the output color profile in two different places, either in this module, or
      in the export panel in lighttable mode (see <xref href="export_selected"/>).
    </p>
                  </body>
                  <topic xml:lang="en-us" id="outputIntent.d12e10071">
                     <title>output intent</title>
                     <body>
                        <p>
        Sets the rendering intent for output/export. For more details see
        <xref href="#rendering_intent"/>).
      </p>
                        <p> Only rendering with LittleCMS2 gives you a choice of rendering intent.
                           The option is hidden, if darktable's internal rendering routines are
                           used. Rendering with LittleCMS2 is activated in the preferences dialog
                           (see <xref href="rendering_intent"/>). </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="outputProfile.d12e10087">
                     <title>output profile</title>
                     <body>
                        <p>
        Sets the color profile for output/export, causing darktable to render colors with this
        profile. darktable embeds the profile data into the output file if supported by the file
        format – this allows other applications reading the file to correctly
        interpret its colors.
      </p>
                        <p>
        As not all applications, e.g. image viewers, are aware of color profiles, a general
        recommendation is to stick to <i>sRGB</i> as the default output profile.
        You should only deviate from <i>sRGB</i> if this is really required and if
        you know what you are doing.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="unbreak_input_profile">
               <title>Unbreak input profile</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>unbreak input
                              profile</indexterm></indexterm>
                        <indexterm>unbreak input profile</indexterm>
                        <indexterm>color management<indexterm>unbreak input
                              profile</indexterm></indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <body/>
               <topic xml:lang="en-us" id="overview.d12e10139">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module adds a correction curve to image data, which is required if you have
              selected certain input profiles in module
              <xref href="#input_color_profile">
                                       <i>input color
              profile</i>
                                    </xref>.
            </entry>
                                 <entry>
                                    <image href="modules/images/unbreakinputprofile.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e10175">
                  <title>Usage</title>
                  <body>
                     <p>
      If you decide in module <xref href="#input_color_profile">
                           <i>input color
      profile</i>
                        </xref> to use an ICC profile from the camera manufacturer, a correction
      curve very frequently needs to be pre-applied to image data – or else the final
      output looks much too dark. This extra processing is not required if you use darktable's
      standard or enhanced color matrices. The correction curve is defined with a linear part
      extending from the shadows to some upper limit and a gamma curve covering mid-tones and
      highlights. For further reading please also have a look at darktable's neighbouring
      project <xref href="http://ufraw.sourceforge.net" format="html" scope="external">UFRaw</xref>.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="linear.d12e10190">
                     <title>linear</title>
                     <body>
                        <p>
        Set the upper limit for the region counted as shadows and where no gamma correction is
        performed. Typically values between 0.0 and 0.1 are required by the profile.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="gamma.d12e10199">
                     <title>gamma</title>
                     <body>
                        <p>
        Set the gamma value to compensate your input profile. Often the required value is 0.45
        (the reciprocal of 2.2 gamma used by some manufacturer's profile).
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="velvia">
               <title>Velvia</title>
               <prolog>
                  <metadata>
                     <keywords>
                        <indexterm>modules<indexterm>velvia</indexterm></indexterm>
                        <indexterm>velvia</indexterm>
                     </keywords>
                  </metadata>
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e10230">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              The velvia module enhances image saturation. Its effect is tailored to increase
              saturation less on lower saturated pixels than on highly saturated pixels.
            </entry>
                                 <entry>
                                    <image href="modules/images/velvia.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e10262">
                  <title>Usage</title>
                  <body/>
                  <topic xml:lang="en-us" id="strength.d12e10267">
                     <title>strength</title>
                     <body>
                        <p>
        This slider controls the strength of the effect.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="midtonesBias.d12e10276">
                     <title>mid-tones bias</title>
                     <body>
                        <p>
        Velvia can reduce its effect for mid-tones to avoid unnatural skin tones. The mid-tones
        bias slider controls this selectivity; reducing its value reduces mid-tone protection
        and makes the overall velvia effect stronger.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="vibrance">
               <title>Vibrance</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>vibrance</indexterm></indexterm>
                        <indexterm>vibrance</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e10307">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              Vibrance is a widely used term in image processing but the mechanism and end
              result differ from program to program. Vibrance in darktable saturates and brings
              down the lightness of the most saturated pixels to make the colors more vivid.
            </entry>
                                 <entry>
                                    <image href="modules/images/vibrance.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e10339">
                  <title>Usage</title>
                  <body>
                     <p>
      Vibrance only has one parameter which controls the amount applied.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="vibrance.d12e10347">
                     <title>vibrance</title>
                     <body>
                        <p>
        The amount of vibrance to apply to the image.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
         </topic>
         <topic xml:lang="en-us" id="correction_group">
            <title>Correction group</title>
            <body>
               <p>
    The correction group contains the modules that will correct typical problems in an photo
    such as hotpixels, spot removal, noise, lens correction among others. This group also
    includes the basic sharpening tools.
  </p>
            </body>
            <topic xml:lang="en-us" id="sharpen">
               <title>Sharpen</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>sharpen</indexterm></indexterm>
                        <indexterm>sharpen</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e10387">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This is an standard UnSharp Mask (USM) tool for sharpening the details of an
              image.
            </entry>
                                 <entry>
                                    <image href="modules/images/sharpen.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e10419">
                  <title>Usage</title>
                  <body>
                     <p>
      This module works by enhancing the contrast around edges and thereby enhances the
      impression of sharpness of an image. In darktable this module is only applied to the
      L-channel in Lab color space.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="radius.d12e10427">
                     <title>radius</title>
                     <body>
                        <p>
        USM applies a gaussian blur to your image as part of its algorithm. This controls the
        blur radius which in turn defines the spatial extent of edge enhancement. Too high
        values will lead to ugly over-sharpening.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="amount.d12e10436">
                     <title>amount</title>
                     <body>
                        <p>
        This controls the strength of the sharpening.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="threshold.d12e10445">
                     <title>threshold</title>
                     <body>
                        <p>
        Contrast differences below this threshold are excluded from sharpening. Use this to
        avoid amplification of noise.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="equalizer">
               <title>Equalizer</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>sharpen</indexterm></indexterm>
                        <indexterm>sharpen</indexterm>
                        <indexterm>modules<indexterm>equalizer</indexterm></indexterm>
                        <indexterm>equalizer</indexterm>
                        <indexterm>denoise<indexterm>equalizer</indexterm></indexterm>
                        <indexterm>clarity<index-see>equalizer</index-see></indexterm>
                        <indexterm>artifact
                              mitigation<indexterm>halos</indexterm></indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e10504">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This versatile module can be used to achieve a variety of effects, such as: bloom,
              denoising, clarity, and local contrast enhancement. It works in the wavelet domain
              and parameters can be tuned for each frequency band separately.
            </entry>
                                 <entry>
                                    <image href="modules/images/atrous.png"
                                           align="right"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e10536">
                  <title>Usage</title>
                  <body>
                     <p>
      Each frequency band can be tweaked independently. In particular, you can adjust contrast
      boost and denoise threshold splines for both lightness and chromaticity
      (<q>luma</q> and <q>chroma</q>), as well as the acuteness
      (<q>edges</q>) of the wavelet basis on each frequency scale.
    </p>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              Each spline can be dragged with a proportional edit approach; use the mouse wheel
              to adjust the radius in which your changes will have an effect. The transparent
              area indicates where you would drag the spline with the current mouse position and
              radius. The small little triangles on the x-axis can be moved to alter the
              x-position of the spline nodes.
            </entry>
                                 <entry>
                                    <image href="modules/images/atrous-1.png"
                                           align="right"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              Drag the upper line (bright circles, here for the lightness channel) to affect
              local contrast. Pulling it up, as shown here, will result in a contrast boost for
              that frequency band. Higher frequencies, i.e. smaller details, are to the right of
              the grid. Pulling it down works, too.
            </entry>
                                 <entry>
                                    <image href="modules/images/atrous-2.png"
                                           align="right"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              The bottom spline (black circles) is used to perform denoising. It adjusts the
              wavelet shrinkage threshold for each frequency band. Pull it up to see the effect.
              In this example, the noise which has been amplified by local contrast enhancement
              is removed.
            </entry>
                                 <entry>
                                    <image href="modules/images/atrous-4.png"
                                           align="right"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This screen shows the effect of the edge parameter. It is here pulled down to zero
              for all bands. This is effectively a regular à trous wavelet, without edge
              detection, and results in the characteristic halos around sharp edges in the
              image.
            </entry>
                                 <entry>
                                    <image href="modules/images/atrous-5.png"
                                           align="right"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This image is the other extreme. The wavelet basis now oversharpens, which results
              in ugly gradient reversals near the ridge of the rock.
            </entry>
                                 <entry>
                                    <image href="modules/images/atrous-6.png"
                                           align="right"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                     <p>
      Note that the edge parameter only affects the wavelet basis, not the image directly. You
      will have to change some denoise/contrast boost parameters to see an effect following
      adjustments to the edge parameter.
    </p>
                     <p>
      This module additionally has a <q>mix</q> slider below the spline GUI. Adjusting
      the slider will upscale or downscale the splines on the y-axis. The slider was added as a
      convenience tool to help you modify the strength of the effect. It is not a module
      parameter in itself; when you leave darkroom mode all changes will be consolidated into
      the spline curves.
    </p>
                     <p>
      Have a look at the presets where there are a broad variety of examples that will provide a
      good starting point to gain an intuitive understanding of the controls. Among others there
      is preset to enhance an image's <q>clarity</q>.
    </p>
                  </body>
                  
               </topic>
            </topic>
            <topic xml:lang="en-us" id="denoise_profiled">
               <title>Denoise – profiled</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>denoise -
                              profiled</indexterm></indexterm>
                        <indexterm>denoise<indexterm>profiled</indexterm></indexterm>
                        <indexterm>noise removal<index-see>denoise</index-see></indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e10733">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module offers an easy to use and – at the same time –
              highly efficient denoise operation. Under the hood it applies (your choice of) a
              non-local means or edge-aware wavelet denoise algorithm with parameters
              specifically profiled for certain camera models and ISO settings.
            </entry>
                                 <entry>
                                    <image href="modules/images/denoise_profiled.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e10765">
                  <title>Usage</title>
                  <body>
                     <p>
      The darktable team, with the help of many users, has measured noise profiles for various
      cameras. Differentiated by ISO settings we evaluated how the noise statistics develop with
      brightness for the three color channels. Our set of profiles covers well above 200 popular
      camera models from all major manufacturers.
    </p>
                     <p>
      darktable stores noise profiles in an external json file. This file can be found in
      <filepath>$DARKTABLE/share/darktable/noiseprofile.json</filepath> where
      <filepath>$DARKTABLE</filepath> represents the darktable installation directory. The json
      format is quite straightforward and explained in depth in
      <xref href="http://json.org/" format="html" scope="external">json.org</xref>. You can replace the default noise profiles
      by your own ones and specify that file on the command line when starting darktable. For
      more details see <xref href="darktable_commandline_parameters"/>. If you generate your
      own noise profiles don't forget to share your results with the darktable team!
    </p>
                     <p>
      /!\ WARNING /!\
      The darkroom zoomed out preview is not completely accurate. Always check your result at 100% zoom level!
    </p>
                     <p>
      Note that (almost) all sliders of this module can take values higher than their visible bounds
      by entering values using Right-click and keyboard.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="profile.d12e10793">
                     <title>profile</title>
                     <body>
                        <p>
        Based on Exif data of your raw file, darktable will automatically determine the camera
        model and ISO setting. If found in its database, the corresponding noise profile will be
        used. If your image has an intermediate ISO value, the statistical properties will be
        interpolated between the two closest datasets in the database, and this interpolated
        setting will show up as the first line in the combo box. You also have the option to
        manually overwrite this selection to suit your personal preferences better. The top-most
        entry in the combo box brings you back to the profile darktable deems most suited.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="mode.d12e10803">
                     <title>mode</title>
                     <body>
                        <p>
        This module can eliminate noise by two different core algorithms. Both <q>non-local
        means</q> and <q>wavelet</q> can tackle efficiently luma (lightness) noise
        and chroma (color) noise.  <q>wavelet</q>  mode also lets you adjust the force
        of the denoising depending on the noise coarseness. If needed
        you can apply two instances of this module (see <xref href="#multiple_instances"/>):
        one instance to tackle luma noise with blend mode <q>lightness</q> or <q>HSV
        lightness</q>, and another one to tackle chroma noise with blend mode
        <q>color</q> or <q>HSV color </q>. An example of the use of two
        instances with blending modes is available within the presets of this module. For more
        information on blend modes have a look at <xref href="#blending_operators"/>.
        The module also offers an automatic mode for each algorithm. Automatic modes allow
        to set module's parameters in an easier way, as it guesses several parameters from
        the profile.
        All sliders of this module can take values higher than their bounds if needed using Right-click.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="whitebalanceadaptiveTransform.d12e10838">
                     <title>whitebalance-adaptive transform</title>
                     <body>
                        <p>
        As white-balance amplifies the RGB channels differently, they exhibit
        different noise levels. This checkbox makes the algorithm adaptive to white balance.
        This option should be disabled on the second instance if you use a first instance
        with a color blend mode.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="patchSize.d12e10847">
                     <title>patch size</title>
                     <body>
                        <p>
        This slider is only available if mode <q>non-local means</q> is selected. It
        controls the size of the patches being matched when deciding which pixels to average
        (see also <xref href="#denoise_non_local_means"/>). Set this to higher values as the
        noise gets higher. Beware that high values may smooth out small edges though.
        Processing time will stay about the same.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="searchRadius.d12e10861">
                     <title>search radius</title>
                     <body>
                        <p>
        This slider is only available if mode <q>non-local means</q> is selected. It
        controls how far from a pixel the algorithm will try to find similar patches.
        Increasing the value can give better results for very noisy images when coarse grain
        noise is visible, but you should better use the scattering slider instead.
        The processing time is hugely impacted by this parameter: it depends on the square of the
        parameter. A lower value will make execution faster, a higher value will make it slower.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="scattering.d12e10873">
                     <title>scattering</title>
                     <body>
                        <p>
        This slider is only available if mode <q>non-local means</q> is selected. Like
        the search radius, it controls how far from a pixel the algorithm will try to find similar
        patches, but does this without increasing the number of patches considered. As such,
        processing time will stay about the same. Increasing the value will reduce coarse grain
        noise, but may smooth local contrast. This slider is particularly effective to reduce
        chroma noise.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="centralPixelWeight.d12e10885">
                     <title>central pixel weight</title>
                     <body>
                        <p>
        This slider is only available if mode <q>non-local means</q> or <q>non-local means
        auto</q> is selected. It controls the amount of details which should be preserved by the
        algorithm. It can be used as a way to control the amount of luma noise smoothing: giving a big
        value to this slider will result mostly in chroma noise smoothing with little smoothing of luma
        noise. This slider has no effect if patch-size is set to 0.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="coarsefineCurves.d12e10901">
                     <title>coarse/fine curves</title>
                     <body>
                        <p>
                           <table frame="none">
                              <tgroup colsep="0" rowsep="0" cols="2">
                                 <colspec colwidth="6*"/>
                                 <colspec colwidth="4*"/>
                                 
                                 <tbody>
                                    <row>
                                       <entry>
                  These curves are only available if mode <q>wavelet</q> is selected.
                  The noise of an image is usually not only fine grain, but also more or less
                  coarse grain. These curves allow to denoise more or less depending on the
                  coarseness of the visible noise. The left of the curve will act on very coarse
                  grain noise, while the right of the curve will act on very fine grain noise.
                  Pushing up the curve will result in more smoothing, pulling it down will
                  result in less smoothing. As an example, you can preserve very-fine grain
                  noise by pulling down the rightest point of the curve until the minimum value.
                  As another example, if you are tackling chroma noise with a blend mode, you
                  can push up the right part of the curve, as colors are not supposed to change
                  a lot on fine grain scales: this will help especially if you see some isolated
                  pixel left undenoised.
                </entry>
                                       <entry>
                                          <image href="modules/images/denoise_profiled_ex1.png"
                                                 align="center"
                                                 placement="break"/>
                                       </entry>
                                    </row>
                                 </tbody>
                              </tgroup>
                           </table>
                        </p>
                        <p>
        Considering R, G, and B curves, the best way to use them is to look at one of the
        channel using the channel mixer module in gray mode, denoise this particular channel,
        and then do the same for the other channels. This way, you can take into account the
        fact that some channel may be noisier than others into your denoising. Be aware that
        guessing which channel is noisy without actually seeing the channels individually is not
        straightforward and can be counterintuitive: a pixel which is completely red may not be
        caused by noise on the R channel, but actually by noise on B and G channels.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="strength.d12e10942">
                     <title>strength</title>
                     <body>
                        <p>
        This parameter is here to fine-tune the strength of the denoise effect. The default
        value has been chosen to maximize the peak signal to noise ratio. It's mostly a matter
        of taste if you prefer a rather low noise level at the costs of a higher loss of detail,
        or if you accept more remaining noise in order to have finer structures better preserved
        within your image.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="preserveShadows.d12e10951">
                     <title>preserve shadows</title>
                     <body>
                        <p>
        This option is available in <q>wavelets</q> and <q>non local means</q> modes.
        It allows to denoise more agressively the shadows or the highlights. Lower the value to denoise
        more the shadows than the highlights. Usually, as noise increases, you will need to lower this
        value.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="biasCorrection.d12e10966">
                     <title>bias correction</title>
                     <body>
                        <p>
        This option is available in <q>wavelets</q> and <q>non local means</q> modes.
        It allows to correct the color cast that may appear in the shadows. Increase this value
        if dark shadows appear too greenish, decrease it if they appear purple-ish.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="adjustAutosetParameters.d12e10981">
                     <title>adjust autoset parameters</title>
                     <body>
                        <p>
        This option is available in <q>auto</q> modes. In these modes, darktable tries to
        derive denoising parameters from the camera profile. Depending on your image the automatically
        derived parameters may not be optimal. E.g. if your image is heavily underexposed and you lifted
        the exposure, you will have to increase this parameter to get a proper denoising. This parameter
        should reflect the amplification you add to your image: if you add 1EV of exposure, the signal
        is multiplied by 2, so this parameter should be set to 2.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="denoise_non_local_means">
               <title>Denoise – non local means</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>denoise - non local
                              means</indexterm></indexterm>
                        <indexterm>denoise<indexterm>non local
                           means</indexterm></indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e11018">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This is a denoise algorithm, which will work on chroma and/or luma.
            </entry>
                                 <entry>
                                    <image href="modules/images/denoise_nlm.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e11050">
                  <title>Usage</title>
                  <body>
                     <p>
      This module reduces noise in your image but preserves structures. This is accomplished by
      averaging each pixel with some surrounding pixels in the image. The weight of such a pixel
      in the averaging process depends on the similarity of its neighborhood with the
      neighborhood of the one pixel to be denoised. A patch with a certain size is used to
      measure that similarity. As denoising is a resource hungry process, it slows down
      pixelpipe processing significantly; consider activating this module late in your workflow.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="patchSize.d12e11058">
                     <title>patch size</title>
                     <body>
                        <p>
        The radius of the patch for similarity evaluation.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="strength.d12e11067">
                     <title>strength</title>
                     <body>
                        <p>
        The strength of the denoise. Higher values lead to a stronger effect.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="luma.d12e11076">
                     <title>luma</title>
                     <body>
                        <p>
        Amount of denoise to apply to luma. Select carefully in order not to lose too much
        structure.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="chroma.d12e11085">
                     <title>chroma</title>
                     <body>
                        <p>
        Amount of denoise to apply to chroma. You can be much more aggressive with this
        parameter compared to luma.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="denoise_bilateral">
               <title>Denoise – bilateral</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>denoise -
                              bilateral</indexterm></indexterm>
                        <indexterm>denoise<indexterm>bilateral</indexterm></indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e11120">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module is used to denoise high ISO pictures. It is flagged as a slow module
              due to its high resource consumption, both in terms of CPU cycles and in terms of
              memory usage. Quite counter-intuitively, the greater the values for sliders, the
              lesser resources.
            </entry>
                                 <entry>
                                    <image href="modules/images/denoise_bilateral.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e11152">
                  <title>Usage</title>
                  <body>
                     <p>
      This module reduces noise in your image but preserves sharp edges. This is accomplished by
      averaging pixels with their neighbors, taking into account not only the geometric distance
      but also the distance on the range scale, i.e. differences in the RGB values. As denoising
      is a resource hungry process, it slows down pixelpipe processing significantly; consider
      to activate this module late in your workflow. The module can be really effective if some
      RGB channel is more noisy than the 2 other channels. In such a case, use the channel mixer
      module to see the channels one by one, in order to set the blur intensities accordingly.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="radius.d12e11160">
                     <title>radius</title>
                     <body>
                        <p>
        Set the spatial extent of the gaussian blur.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="red.d12e11169">
                     <title>red</title>
                     <body>
                        <p>
        Blur intensity for red channel.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="green.d12e11178">
                     <title>green</title>
                     <body>
                        <p>
        Blur intensity for green channel.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="blue.d12e11187">
                     <title>blue</title>
                     <body>
                        <p>
        Blur intensity for blue channel.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="liquify">
               <title>Liquify</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>liquify</indexterm></indexterm>
                        <indexterm>liquify</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e11218">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              The liquify module offers a versatile way of moving pixels around by applying free
              style distortions to parts of the image. There are three tools to help doing that:
              points, lines, and curves.
            </entry>
                                 <entry>
                                    <image href="modules/images/liquify.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                     <p>
      Each of liquify's tools is based on nodes. A point is given by a single node, a line or a
      curve consist of a set of nodes defining the path.
    </p>
                     <p>
      There is a limit of 100 nodes in a single liquify instance. For more distortions one can
      use multiple instances of the liquify module. However, take into account that the liquify
      module requires a lot of computing resources.
    </p>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e11256">
                  <title>Usage</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              The basic elements of all tools in liquify are nodes.
            </entry>
                                 <entry>
                                    <image href="modules/images/liquify_ex1.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                     <p>
      You can drag the central point of a node to move the node around. The radius describes the
      area of the applied effect: the distortion occurs only inside this radius. To change the
      radius drag the handle at the circumference. A strength vector starting from the center
      describes the direction of the distortion, and its strength is depicted by the length of
      the vector. You change the vector by dragging its arrowhead.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="warpsAndNodesCount.d12e11290">
                     <title>warps and nodes count</title>
                     <body>
                        <p>
        This information field displays the number of warps (individual distortion object)
        and nodes currently used.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="pointTool.d12e11299">
                     <title>point tool</title>
                     <body>
                        <p>
        Click the
        <image href="../images/darkroom_module_liquify_point.png" align="center"/>
        icon to activate the point tool and left-click on the image to place it.
      </p>
                        <p>
        A point is formed by a single node. In a point the strength vector has three different
        modes which are toggled using Ctrl+click over the arrowhead of the strength vector:
        <table frame="none">
                              <tgroup colsep="0" rowsep="0" cols="3">
                                 <colspec colwidth="2*"/>
                                 <colspec colwidth="4*"/>
                                 <colspec colwidth="4*"/>
                                 
                                 <tbody>
                                    <row>
                                       <entry>
                                          <i>linear</i>
                                       </entry>
                                       <entry>
                  The linear mode produces a linear distortion inside the circle. Starting from
                  the opposite side of the strength vector and following the strength vector's
                  direction. This is the default mode.
                </entry>
                                       <entry>
                                          <image href="modules/images/liquify_ex1.png"
                                                 align="center"
                                                 placement="break"/>
                                       </entry>
                                    </row>
                                    <row>
                                       <entry>
                                          <i>radial growing</i>
                                       </entry>
                                       <entry>
                  In this mode the strength vector's effect is radial, starting with a strength
                  of 0% in the center and growing when going away from the center. This mode is
                  depicted by an additional circle with the arrow pointing outwards.
                </entry>
                                       <entry>
                                          <image href="modules/images/liquify_ex4.png"
                                                 align="center"
                                                 placement="break"/>
                                       </entry>
                                    </row>
                                    <row>
                                       <entry>
                                          <i>radial shrinking</i>
                                       </entry>
                                       <entry>
                  In this mode the strength vector's effect is radial, starting with a strength
                  of 100% in the center and shrinking when going away from the center. This mode
                  is depicted by an additional circle with the arrow pointing inwards.
                </entry>
                                       <entry>
                                          <image href="modules/images/liquify_ex3.png"
                                                 align="center"
                                                 placement="break"/>
                                       </entry>
                                    </row>
                                 </tbody>
                              </tgroup>
                           </table>
                        </p>
                        <p>
        Note that the strength by default varies linearly from 0% to 100% between the center and
        the radius of the control point. It is possible to modify the feathering effect by
        clicking on the center of the circle:
        <table frame="none">
                              <tgroup colsep="0" rowsep="0" cols="3">
                                 <colspec colwidth="2*"/>
                                 <colspec colwidth="4*"/>
                                 <colspec colwidth="4*"/>
                                 
                                 <tbody>
                                    <row>
                                       <entry>
                                          <i>default</i>
                                       </entry>
                                       <entry>
                  Linear from the center to the radius.
                </entry>
                                       <entry>
                                          <image href="modules/images/liquify_ex1.png"
                                                 align="center"
                                                 placement="break"/>
                                       </entry>
                                    </row>
                                    <row>
                                       <entry>
                                          <i>feathered</i>
                                       </entry>
                                       <entry>
                  Two control circles are displayed and can be modified independently to feather
                  the strength of the effect. Note that clicking again the center of the circle
                  only hides the feathering controls but does not return to the default.
                </entry>
                                       <entry>
                                          <image href="modules/images/liquify_ex2.png"
                                                 align="center"
                                                 placement="break"/>
                                       </entry>
                                    </row>
                                 </tbody>
                              </tgroup>
                           </table>
                        </p>
                        <p>
        A point can be removed by right-clicking on the center.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="lineTool.d12e11446">
                     <title>line tool</title>
                     <body>
                        <p>
        Click the
        <image href="../images/darkroom_module_liquify_line.png" align="center"/>
        icon to activate the line tool and left-click on the image to place the first point,
        move and left-click to place another point and start forming the path. To end the line
        just right-click anywhere.
      </p>
                        <p>
                           <table frame="none">
                              <tgroup colsep="0" rowsep="0" cols="2">
                                 <colspec colwidth="6*"/>
                                 <colspec colwidth="4*"/>
                                 
                                 <tbody>
                                    <row>
                                       <entry>
                  A line is a set of points. The points are linked together, the effect is
                  interpolated by a set of strength vectors.
                </entry>
                                       <entry>
                                          <image href="modules/images/liquify_ex5.png"
                                                 align="center"
                                                 placement="break"/>
                                       </entry>
                                    </row>
                                 </tbody>
                              </tgroup>
                           </table>
                        </p>
                        <p>
        It is possible to add a control point on a line by Ctrl+Click on a segment. You may
        remove a control point from a line by Ctrl+right click on the node center.
      </p>
                        <p>
        A right-click on a segment will remove the shape completely.
      </p>
                        <p>
        A Ctrl+Alt+click on a segment will change it to a curve segment.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="curveTool.d12e11498">
                     <title>curve tool</title>
                     <body>
                        <p>
        Click the
        <image href="../images/darkroom_module_liquify_curve.png" align="center"/>
        icon to activate the curve tool and left-click on the image to place the first point,
        move and left-click to place another point and start forming the path. To end the line
        just right-click anywhere.
      </p>
                        <p>
                           <table frame="none">
                              <tgroup colsep="0" rowsep="0" cols="2">
                                 <colspec colwidth="6*"/>
                                 <colspec colwidth="4*"/>
                                 
                                 <tbody>
                                    <row>
                                       <entry>
                  A curve is a set of points. The points are linked together, the effect is
                  interpolated as a bezier curve by a set of strength vectors.
                </entry>
                                       <entry>
                                          <image href="modules/images/liquify_ex6.png"
                                                 align="center"
                                                 placement="break"/>
                                       </entry>
                                    </row>
                                 </tbody>
                              </tgroup>
                           </table>
                        </p>
                        <p>
        It is possible to add a control point on a curve by Ctrl+click on a segment. You may
        remove a control point from a curve by Ctrl+right click on the node center.
      </p>
                        <p>
        A right-click on a segment will remove the shape completely.
      </p>
                        <p>
        A Ctrl+Alt+click on a segment will change it to a line segment.
      </p>
                        <p>
        It is possible to change the way the points of the curve are linked together by using
        Ctrl+click on the center. There are four modes which correspond to different ways of
        handling the steepness of the bezier curve by control handles:
        <table frame="none">
                              <tgroup colsep="0" rowsep="0" cols="2">
                                 <colspec colwidth="4*"/>
                                 <colspec colwidth="6*"/>
                                 
                                 <tbody>
                                    <row>
                                       <entry>
                                          <i>autosmooth</i>
                                       </entry>
                                       <entry>
                  This is the default mode in which the control handles are not displayed as
                  they are automatically computed to always give a smooth curve.
                </entry>
                                    </row>
                                    <row>
                                       <entry>
                                          <i>cusp</i>
                                       </entry>
                                       <entry>
                  Control handles can be moved independently. This mode is depicted by a
                  triangle symbol in the node center.
                </entry>
                                    </row>
                                    <row>
                                       <entry>
                                          <i>smooth</i>
                                       </entry>
                                       <entry>
                  Control handles are always giving a smooth curve. This mode is depicted by a
                  diamond symbol in the node center.
                </entry>
                                    </row>
                                    <row>
                                       <entry>
                                          <i>symmetrical</i>
                                       </entry>
                                       <entry>
                  Control handles are always moved together. This mode is depicted by a square
                  symbol in the node center.
                </entry>
                                    </row>
                                 </tbody>
                              </tgroup>
                           </table>
                        </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="nodeEditTool.d12e11614">
                     <title>node edit tool</title>
                     <body>
                        <p>
        Clicking the
        <image href="../images/darkroom_module_liquify_edit.png" align="center"/>
        icon activates or deactivates the node edit tool displaying all defined distortion
        objects and their controls. Alternatively you can at any time right-click on the image
        for the same effect.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="perspective_correction">
               <title>Perspective correction</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>perspective
                              correction</indexterm></indexterm>
                        <indexterm>perspective correction</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e11649">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module is designed to automatically correct for converging lines, a form of
              perspective distortions frequently seen in architectural photographs. The
              underlying mechanism is inspired by Markus Hebel's
              <xref href="http://www.shiftn.de/" format="html" scope="external">
                                       <i>ShiftN</i>
                                    </xref> program.
            </entry>
                                 <entry>
                                    <image href="modules/images/ashift.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                     <p>
      Perspective distortions are a natural effect when projecting a three dimensional scene
      onto a two dimensional plane and cause objects close to the viewer to appear larger than
      objects further away. Converging lines are a special case of perspective distortions
      frequently seen in architectural photographs. Parallel lines when photographed at an angle
      get transformed into converging lines that meet at some vantage point within or outside
      the image frame.
    </p>
                     <p>
      This module is able to correct converging lines by warping the image in such a way that
      the lines in question become parallel to the image frame. Corrections can be applied in
      vertical and horizontal direction, either separately or in combination. In order to
      perform an automatic correction the module analyzes the image for suitable structural
      features consisting of line segments. Based on these line segments a fitting procedure is
      started that determines the best values of the module parameters.
    </p>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e11691">
                  <title>Usage</title>
                  <body>
                     <p>
      Clicking the <q>get structure</q> icon (
      <image href="../images/darkroom_module_ashift_structure.png" align="center"/>
      ) causes darktable to analyze the image for structural elements. Line segments are
      detected and evaluated. Only lines that form a set of either vertical or horizontal lines
      are used for further processing steps. The line segments are displayed as overlays on the
      image base. A color code describes what type of line darktable has found:
      <table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="2">
                              <colspec colwidth="1*"/>
                              <colspec colwidth="4*"/>
                              
                              <tbody>
                                 <row>
                                    <entry>
                                       <i>green</i>
                                    </entry>
                                    <entry>
                lines that are selected as relevant vertical converging lines
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                                       <i>red</i>
                                    </entry>
                                    <entry>
                lines that are vertical but are not part of the set of converging lines
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                                       <i>blue</i>
                                    </entry>
                                    <entry>
                lines that are selected as relevant horizontal converging lines
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                                       <i>yellow</i>
                                    </entry>
                                    <entry>
                lines that are horizontal but are not part of the set of converging lines
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                                       <i>grey</i>
                                    </entry>
                                    <entry>
                other lines identified but not of interest to this module
              </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table>
                     </p>
                     <p>
      Lines marked in red or yellow are regarded as outliers and are not taken into account for
      the automatic fitting step. This outlier elimination involves a statistical process with
      random sampling so that each time you press the <q>get structure</q> button the
      color pattern of the lines will look a bit different. You can manually change the status
      of line segments: left-clicking on a line selects it (turns the color to green or blue)
      while right-clicking deselects it (turns the color to red or yellow). Keeping the mouse
      button pressed allows for a sweeping action to select/deselect multiple lines in a row;
      the size of the select/deselect brush can be changed with the mouse wheel. Holding down
      the <i>Shift</i> key and keeping the left or right mouse button pressed
      while dragging selects or deselects all lines in the chosen rectangular area.
    </p>
                     <p>
      Clicking one of the <q>automatic fit</q> icons (see below) starts an optimization
      process which finds the best suited parameters. The image and the overlaid lines are then
      displayed with perspective corrections applied.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="rotation.d12e11794">
                     <title>rotation</title>
                     <body>
                        <p>
        This parameter controls a rotation of the image around its center and can correct for a
        skewed horizon.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="lensShiftHorizontal.d12e11803">
                     <title>lens shift (horizontal)</title>
                     <body>
                        <p>
        This parameter corrects converging lines horizontally.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="lensShiftVertical.d12e11813">
                     <title>lens shift (vertical)</title>
                     <body>
                        <p>
        This parameter corrects converging lines vertically. In some cases you get a more
        naturally looking image if you correct vertical distortions not to their full extent but
        rather at an 80 to 90% level. If desired just reduce the value after having performed
        the automatic correction.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="shear.d12e11822">
                     <title>shear</title>
                     <body>
                        <p>
        This parameter shears the image along one of its diagonals and is needed when correcting
        vertical and horizontal perspective distortions simultaneously.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="guides.d12e11831">
                     <title>guides</title>
                     <body>
                        <p>
        If activated a number of guide lines is laid over the image to help you judge the
        quality of the correction.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="automaticCropping.d12e11840">
                     <title>automatic cropping</title>
                     <body>
                        <p>
        When activated the automatic cropping feature clips the image to get rid of any black
        corners. At your choice you can either clip to the <q>largest area</q> or to the
        largest rectangle maintaining the original aspect ratio (<q>original
        format</q>). In the latter case you can manually adjust the automatic cropping result: 
        left click into to clip region and move it around. The size of the region gets modified
        automatically excluding any black corners.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="lensModel.d12e11855">
                     <title>lens model</title>
                     <body>
                        <p>
        This parameter controls how lens and camera specifics are taken into account. If set to
        <q>generic</q> a focal length of 28mm on a full-format camera is assumed. If set
        to <q>specific</q>, focal length and crop factor can be set manually.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="focalLength.d12e11870">
                     <title>focal length</title>
                     <body>
                        <p>
        The focal length of the lens used. The default value is taken from the Exif data of your
        image. This parameter is only effective and visible if the <q>specific</q> lens
        model has been selected.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="cropFactor.d12e11883">
                     <title>crop factor</title>
                     <body>
                        <p>
        The crop factor of the camera used. You will typically need to set this value manually.
        This parameter is only effective and visible if the <q>specific</q> lens model
        has been selected.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="aspectAdjust.d12e11895">
                     <title>aspect adjust</title>
                     <body>
                        <p>
        If the <q>specific</q> lens model has been selected this parameter allows for a
        free manual adjustment of the image's aspect ratio.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="automaticFit.d12e11907">
                     <title>automatic fit</title>
                     <body>
                        <p>
        Clicking on one of the icons starts an automatic fitting of the module parameters based
        on the selected vertical and/or horizontal lines. You can choose to correct only
        vertical distortions (
        <image href="../images/darkroom_module_ashift_vertical.png" align="center"/>
        ), only horizontal distortions (
        <image href="../images/darkroom_module_ashift_horizontal.png" align="center"/>
        ), or both types of distortions simultaneously (
        <image href="../images/darkroom_module_ashift_both.png" align="center"/>
        ). <i>Ctrl+clicking</i> on either icon only fits rotation.
        <i>Shift+clicking</i> on either icon only fits vertical and/or horizontal
        lens shift.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="getStructure.d12e11934">
                     <title>get structure</title>
                     <body>
                        <p>
        Clicking on the
        <image href="../images/darkroom_module_ashift_structure.png" align="center"/>
        icon causes the image to be (re-)analyzed for suitable line segments.
        <i>Shift+clicking</i> applies a prior contrast enhancement step,
        <i>Ctrl+clicking</i> applies an edge enhancement step. Both variations can
        be used alone or in combination if the default is not able to detect a sufficient number
        of lines. Clicking on the
        <image href="../images/darkroom_module_ashift_clear.png" align="center"/>
        icon discards all collected structural data. By clicking on the
        <image href="../images/darkroom_module_ashift_eye.png" align="center"/>
        icon you can switch the overlay display of line segments on and off.
      </p>
                     </body>
                     
                  </topic>
               </topic>
               <topic xml:lang="en-us" id="examples.d12e11962">
                  <title>Examples</title>
                  <body>
                     <p>
                        <table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="2">
                              <colspec colwidth="4*"/>
                              <colspec colwidth="6*"/>
                              
                              <tbody>
                                 <row>
                                    <entry>
                                       <image href="modules/images/ashift_ex1.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                An input image with a skewed horizon and converging lines caused by directing
                the camera upwards.
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                                       <image href="modules/images/ashift_ex2.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                The image after having corrected for vertical and horizontal perspective
                distortions. Note the framing by the automatic cropping feature and the still
                visible overlay of structural lines.
              </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table>
                     </p>
                  </body>
                  
               </topic>
            </topic>
            <topic xml:lang="en-us" id="lens_correction">
               <title>Lens correction</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>lens
                           correction</indexterm></indexterm>
                        <indexterm>lens correction</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e12031">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module is able to correct certain lens flaws, namely distortions, transversal
              chromatic aberrations (TCA) and vignetting. It relies on the external library
              <xref href="http://lensfun.sourceforge.net/"
                                          format="html"
                                          scope="external">lensfun</xref>, which comes with
              correction profiles for many (but not all) common cameras and lenses.
            </entry>
                                 <entry>
                                    <image href="modules/images/lenscorrection.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e12066">
                  <title>Usage</title>
                  <body>
                     <p>
      In order to perform lens corrections the module uses Exif data of your image to identify
      the specific camera/lens combination and collects the needed correction parameters from a
      profile in lensfun's database.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="camera.d12e12074">
                     <title>camera</title>
                     <body>
                        <p>
        The camera make and model as determined by Exif data. You can override this manually and
        select your camera from a hierarchical menu.
      </p>
                        <p>
        Only lenses with correction profiles matching the selected camera will be shown.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="lens.d12e12086">
                     <title>lens</title>
                     <body>
                        <p>
        The lens make and model as determined by Exif data. You can override this manually and
        select your lens from a hierarchical menu. This is mainly needed for pure mechanical
        lenses, but may also be needed for off-brand / third party lenses.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us"
                         id="photometricParametersFocalLengthApertureFocalDistance.d12e12095">
                     <title>photometric parameters: focal length, aperture, focal distance</title>
                     <body>
                        <p>
        Corrections additionally depend on certain photometric parameters that are read from
        Exif data: focal length (needed for distortion, TCA, vignetting), aperture (needed for
        TCA, vignetting) and focal distance (needed for vignetting). Many cameras do not record
        focal distance in their Exif data; most likely you need to set this manually.
      </p>
                        <p>
        You can manually override all automatically selected parameters. Either take one of the
        predefined values from the pull-down menu; or – with the pull-down menu still
        open – just type in your own value.
      </p>
                        <p>
        If your system's lensfun library has no correction profile for the automatically
        identified camera/lens combination the controls for the three photometric parameters are
        not displayed, and you get a warning message instead. You may try to find the right
        profile yourself by searching for it in the menu. If you can't find your lens, check if
        it is in the <xref href="http://lensfun.sourceforge.net/lenslist/"
                                 format="html"
                                 scope="external">list of currently
        supported lenses</xref>, and refer to the
        <xref href="http://lensfun.sourceforge.net/manual/lensfun-update-data.html"
                                 format="html"
                                 scope="external">
        lensfun-update-data tool</xref>. If there is no matching profile for your lens, please
        visit <xref href="https://www.darktable.org/2013/07/have-your-lens-calibrated/"
                                 format="html"
                                 scope="external">this
        lens calibration service</xref> offered by Torsten Bronger, one of darktable's users.
        Alternatively you may go to <xref href="http://lensfun.sourceforge.net/"
                                 format="html"
                                 scope="external">lensfun's home
        page</xref> and learn how to generate your own set of correction parameters. Don't
        forget to share your profile with the lensfun team!
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="corrections.d12e12122">
                     <title>corrections</title>
                     <body>
                        <p>
        This combobox gives you a choice about which corrections (out of distortion, TCA and
        vignetting) darktable shall apply. Change this from its default <q>all</q>, if
        your camera has already done some internal corrections (e.g. of vignetting), or if you
        plan to do certain corrections with a separate program.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="geometry.d12e12135">
                     <title>geometry</title>
                     <body>
                        <p>
        In addition to the correction of lens flaws, this module can change the projection type
        of your image. Set this combobox to the aimed projection type, like
        <q>rectilinear</q>, <q>fish-eye</q>, <q>panoramic</q>,
        <q>equirectangular</q>, <q>orthographic</q>,
        <q>stereographic</q>, <q>equisolid angle</q>, <q>thoby
        fish-eye</q>.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="scale.d12e12169">
                     <title>scale</title>
                     <body>
                        <p>
        This slider allows you to adjust the scaling factor of your image. Pressing the auto
        scale button (right to the slider) will let darktable find the best fit to avoid black
        corners.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="mode.d12e12178">
                     <title>mode</title>
                     <body>
                        <p>
        The default behavior of this module is to correct lens flaws. Switch this combobox to
        <q>distort</q> in order to simulate the behavior of a specific lens (inverted
        effect).
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="tcaRed.d12e12190">
                     <title>TCA red</title>
                     <body>
                        <p>
        This slider allows to override the correction parameter for TCA. You can also use this
        slider to manually set the parameter in case the lens profile does not contain TCA
        correction. Look out for colored seams at features with high contrast edges and adjust
        this parameter and the following one to minimize those seams.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="tcaBlue.d12e12199">
                     <title>TCA blue</title>
                     <body>
                        <p>
        This slider allows to override the correction parameter for TCA. You can also use this
        slider to manually set the parameter in case the lens profile does not contain TCA
        correction.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="correctionsDone.d12e12208">
                     <title>corrections done</title>
                     <body>
                        <p>
        You will sometimes observe that for a given camera/lens combination only part of the
        possible corrections (distortion, TCA, vignetting) are supported by lensfun's profiles.
        This message box will tell you what corrections have actually been applied.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="scale_pixels">
               <title>Scale pixels</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>scale
                           pixels</indexterm></indexterm>
                        <indexterm>scale pixels</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e12239">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              Some cameras like the Nikon D1X have rectangular instead of the usual square
              sensor cells. Without correction this would lead to distorted images. This module
              applies the needed scaling.
            </entry>
                                 <entry>
                                    <image href="modules/images/scalepixels.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e12271">
                  <title>Usage</title>
                  <body>
                     <p>
      darktable detects images that need correction by their Exif data and automatically
      activates this module. For other images the module always remains disabled. The modules
      has no parameters.
    </p>
                  </body>
                  
               </topic>
            </topic>
            <topic xml:lang="en-us" id="rotate_pixels">
               <title>Rotate pixels</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>rotate
                           pixels</indexterm></indexterm>
                        <indexterm>rotate pixels</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e12301">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              The sensors of some cameras like the Fujifilm FinePix S2Pro, F700, and E550 have a
              diagonally oriented Bayer pattern instead of the usual orthogonal layout. Without
              correction this would lead to a tilted image with black corners. This module
              applies the needed rotation.
            </entry>
                                 <entry>
                                    <image href="modules/images/rotatepixels.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e12333">
                  <title>Usage</title>
                  <body>
                     <p>
      darktable detects images that need correction by their Exif data and automatically
      activates this module. For other images the module always remains disabled. The modules
      has no parameters.
    </p>
                  </body>
                  
               </topic>
            </topic>
            <topic xml:lang="en-us" id="spot_removal">
               <title>Spot removal</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>spot
                           removal</indexterm></indexterm>
                        <indexterm>spot removal</indexterm>
                        <indexterm>cloning</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e12370">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              Spot removal allows you to correct an area in your image by using another area as
              model.
            </entry>
                                 <entry>
                                    <image href="modules/images/spotremoval.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e12402">
                  <title>Usage</title>
                  <body>
                     <p>
      This module uses some of the shapes that are offered in drawn masks, namely circles,
      ellipses and path shapes. The user interface and the controls are the same as in drawn
      mask and explained in more detail in <xref href="#drawn_mask"/>.
    </p>
                     <p>
      Select the desired shape by clicking the corresponding icon, then click on the canvas to
      choose the area to be healed, i.e. the target area. A cross is displayed where the source
      area will be positioned.
    </p>
                     <p>
      The source positioning has two modes: absolute or relative. To set the absolute mode,
      while creating a shape, <i>Shift+Ctrl+click</i> on the desired position.
      From now on, all new shapes will have the source created at that position. To set the
      relative mode, still while creating a shape, <i>Shift+click</i> on the
      desired position. The current shape will have the source created at that position and the
      subsequent ones will have the source created at the same relative position.
    </p>
                     <p>
      After creation source area and target area can be shifted independently until the result
      matches your expectations. An arrow helps to tell source from target area.
    </p>
                     <p>
      Use the shape specific controls to adjust its size, its border width, and other
      attributes.
    </p>
                     <p>
      Right-click on a shape to delete it.
    </p>
                     <p>
      Collapse the module to complete the changes.
    </p>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="examples.d12e12439">
                  <title>Examples</title>
                  <body>
                     <p>
                        <table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="2">
                              <colspec colwidth="4*"/>
                              <colspec colwidth="6*"/>
                              
                              <tbody>
                                 <row>
                                    <entry>
                                       <image href="modules/images/spotremoval_ex1_1.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                Let's use this portrait as example; we want to remove some dirt and unwanted
                catchlight from camera popup strobe.
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                                       <image href="modules/images/spotremoval_ex1_2.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                I have marked all the spots that I want to remove from the image with circle
                shapes and appropriately selected source areas.
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                                       <image href="modules/images/spotremoval_ex1_3.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                And here is the result image of the spotremoval.
              </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table>
                     </p>
                  </body>
                  
               </topic>
            </topic>
            <topic xml:lang="en-us" id="retouch">
               <title>Retouch</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>retouch</indexterm></indexterm>
                        <indexterm>retouch</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e12521">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              Retouch allows to heal, clone, fill and blur certain areas of the image. It can
              perform a wavelet decomposition which separates the image into different frequency
              scales, from fine to coarse, and apply retouch operations to each wavelet scale
              individually.
            </entry>
                                 <entry>
                                    <image href="modules/images/retouch.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e12553">
                  <title>Usage</title>
                  <body>
                     <p>
      For a basic use, with default parameters, add the shapes to the image like with the spot
      removal module (see <xref href="#spot_removal"/>). To use the wavelet decompose first
      select one of the scales as the current scale (see below) and then add the shapes.
    </p>
                     <p>
      The GUI is divided in three main sections: wavelet decompose, retouch tools and shapes.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="waveletDecomposeSection.d12e12566">
                     <title>wavelet decompose section</title>
                     <body>
                        <p>
        The wavelet decompose toolbar controls the wavelet decompose algorithm. It has a central
        area divided in boxes and two sliders. The first box, scale zero, represents the
        original image, the second is the wavelet scale 1, and so on.
      </p>
                        <p>
        The bottom slider adjusts the number of scales, zero means no wavelet decompose is done.
        The maximum number of scales depends on the image size, but any number can be selected.
        If the image is not big enough for the selected number of scales the maximum number of
        scales for this image size is used and the rest of the scales are ignored.
      </p>
                        <p>
        The image is decomposed to the selected number of scales plus the residual image, so if
        5 is selected as the number of scales, scale zero is the original image, scales 1 to 5
        are the detail scales, and scale 6 is the residual image. As a visual aid, the original
        image is always represented by a black box, detail scales are light gray, residual image
        white and inactive scales dark gray.
      </p>
                        <p>
        The central area allows to select the current scale on which the user can then apply
        retouch tools by left clicking any of the boxes. The selected scale is marked by a red
        frame. Any scale can be selected as the current scale, even if it is greater than the
        number of scales. If a shape is added to a scale greater than the residual image it will
        be ignored, as the scale is not processed.
      </p>
                        <p>
        Only the shapes on the current scale are displayed, when the current scale is changed
        shapes will be displayed accordingly.
      </p>
                        <p>
        A green line on top of each box indicates that the scale has shapes associated with it.
      </p>
                        <p>
        Fine detail scales can only be seen at certain zoom level, a light gray line on top of
        each box will indicate that the scale is visible at current zoom level.
      </p>
                        <p>
        The top slider adjusts the <i>merge scale</i> feature. This setting allows
        to apply a common edit on multiple consecutive scales within a group starting from the
        highest scale (not including the residual image) down to the one selected by this
        slider. If the slider is set to 3 and the maximum scale is 5 then all edits that are
        added to scale 5 will be applied to scales 3 to 5. Edits added to scale 4 will be
        applied to scales 3 and 4, and edits added to scale 3 will be applied only to scale 3.
        <i>Merged scales</i> are represented by a green-yellow color. A value of
        zero means that the merge feature is not used.
      </p>
                        <p>
        The display wavelet scale button (
        <image href="../images/darkroom_module_retouch_display_scale.png" align="center"/>
        ) allow to view the current wavelet scale. The module's blend feature is temporary
        disabled when this option is set. If blending in the module is active and the option to
        display masks is active this option cannot be set. When this option is active a new
        section, <q>preview single scale</q>, will be displayed, allowing to adjust the
        levels for the displayed image. This is purely a convenience feature so you can adjust
        wavelet scale display to your needs. It does not have an effect on the final output
        image. An auto levels button (
        <image href="../images/darkroom_module_retouch_auto_levels.png" align="center"/>
        ) is also available; it works on the displayed image, so different results can be
        expected depending on the image displayed when zoomed in/out. Levels are only applied to
        detail scales, not the original or residual image.
      </p>
                        <p>
        The cut and paste buttons allow to move all the shapes from one scale to another. In
        order to do this first select the current scale, click the cut button (
        <image href="../images/darkroom_module_retouch_cut.png" align="center"/>
        ), select the destination scale and click paste (
        <image href="../images/darkroom_module_retouch_paste.png" align="center"/>
        ). This can be useful when there are edits on the residual image and one has to change
        the number of scales; since the residual image is changed, shapes need to be moved to
        the new one.
      </p>
                        <p>
        The switch off shapes button (
        <image href="../images/darkroom_module_retouch_switch.png" align="center"/>
        ) temporarily disables the processing of all shapes for a simple before/after
        comparison.
      </p>
                        <p>
        The display masks button (
        <image href="../images/darkroom_module_retouch_mask.png" align="center"/>
        ) works similar to the one on the blend module, but it will display only the shapes on
        the current scale. This option and display mask on the blend module cannot be set at the
        same time.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="retouchToolsSection.d12e12643">
                     <title>retouch tools section</title>
                     <body>
                        <p>
        The shapes toolbar allows to add new shapes to the image. Shapes creation/editing
        behaves like in the spot removal module. In addition, by Ctrl+click on any shape button,
        the <i>continuous add mode</i> is activated. Once a shape is added,
        darktable will remain in creation mode, allowing to add another shape of the same type.
        To change the shape type to be added Ctrl+click on a different shape button to continue
        on continuous add mode or plain click to add a single shape. To leave the continuous add
        mode right click on any clear area of the image.
      </p>
                        <p>
        The algorithms toolbar allows to select between heal (
        <image href="../images/darkroom_module_retouch_heal.png" align="center"/>
        ), clone (
        <image href="../images/darkroom_module_retouch_clone.png" align="center"/>
        ), fill (
        <image href="../images/darkroom_module_retouch_fill.png" align="center"/>
        ) and blur (
        <image href="../images/darkroom_module_retouch_blur.png" align="center"/>
        ) algorithms. Before actually creating a shape the algorithm must be
        selected – once a shape is created the algorithm cannot be changed.
      </p>
                        <p>
        Any combination of shape type and algorithm can be added to the image.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="shapesSection.d12e12677">
                     <title>shapes section</title>
                     <body>
                        <p>
        The shape selected field displays the selected shape (if any). To select a shape click
        on it, to deselect click on a free area on the image.
      </p>
                        <p>
        Mask opacity is displayed when a shape is selected. It displays/sets the opacity of the
        mask. Opacity is a property of the currently selected shape and won't be used as default
        value for newly added shapes.
      </p>
                        <p>
        Different properties will be displayed depending on the selected algorithm:
        <table frame="none">
                              <tgroup colsep="0" rowsep="0" cols="2">
                                 <colspec colwidth="1*"/>
                                 <colspec colwidth="4*"/>
                                 
                                 <tbody>
                                    <row>
                                       <entry>
                                          <i>fill algorithm</i>
                                       </entry>
                                       <entry>
                                          <dl>
                                             <dlentry>
                                                <dt>fill mode</dt>
                                                <dd>
                                                   <p>
                        Can be erase or color. Erase is used to delete details from a wavelet
                        scale. Color allows to select a color to fill the area defined by the
                        shape.
                      </p>
                                                </dd>
                                             </dlentry>
                                             <dlentry>
                                                <dt>brightness</dt>
                                                <dd>
                                                   <p>
                        Adds the selected value to the color, allowing to make it brighter or
                        darker. Works the same with both fill modes.
                      </p>
                                                </dd>
                                             </dlentry>
                                          </dl>
                                       </entry>
                                    </row>
                                    <row>
                                       <entry>
                                          <i>blur algorithm</i>
                                       </entry>
                                       <entry>
                                          <dl>
                                             <dlentry>
                                                <dt>blur type</dt>
                                                <dd>
                                                   <p>
                        Can be gaussian or bilateral.
                      </p>
                                                </dd>
                                             </dlentry>
                                             <dlentry>
                                                <dt>blur radius</dt>
                                                <dd>
                                                   <p>
                        Sets the blur radius.
                      </p>
                                                </dd>
                                             </dlentry>
                                          </dl>
                                       </entry>
                                    </row>
                                 </tbody>
                              </tgroup>
                           </table>
        The value set on each one of these properties is used as a default when a new shape is
        created.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="raw_denoise">
               <title>Raw denoise</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>raw
                           denoise</indexterm></indexterm>
                        <indexterm>denoise<indexterm>raw</indexterm></indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e12800">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              Raw denoise allows you to perform denoising on the data before it gets demosaiced.
              It is ported from
              <xref href="http://www.cybercom.net/~dcoffin/dcraw/"
                                          format="html"
                                          scope="external">
                                       <i>dcraw</i>
                                    </xref>.
            </entry>
                                 <entry>
                                    <image href="modules/images/rawdenoise.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e12836">
                  <title>Usage</title>
                  <body/>
                  <topic xml:lang="en-us" id="noiseThreshold.d12e12841">
                     <title>noise threshold</title>
                     <body>
                        <p>
        Set the threshold for noise detection. Higher values lead to stronger noise removal and
        higher loss of image detail.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="coarsefineCurves.d12e12850">
                     <title>coarse/fine curves</title>
                     <body>
                        <p>
        The noise of an image is usually not only fine grain, but also more or less coarse grain.
        These curves allow to denoise more or less depending on the coarseness of the visible noise.
        The left of the curve will act on very coarse grain noise, while the right of the curve will
        act on very fine grain noise. Pushing up the curve will result in more smoothing, pulling it
        down will result in less smoothing. As an example, you can preserve very-fine grain noise by
        pulling down the rightest point of the curve until the minimum value. As another example, if
        you are tackling chroma noise with a blend mode, you can push up the right part of the curve,
        as colors are not supposed to change a lot on fine grain scales: this will help especially if
        you see some isolated pixel left undenoised.
        Considering R, G, and B curves, the best way to use them is to look at one of the channel using
        the channel mixer module in gray mode, denoise this particular channel, and then do the same for
        the other channels. This way, you can take into account the fact that some channel may be noisier
        than others into your denoising. Be aware that guessing which channel is noisy without actually
        seeing the channels individually is not straightforward and can be counterintuitive: a pixel
        which is completely red may not be caused by noise on the R channel, but actually by noise on
        B and G channels.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="dithering">
               <title>Dithering</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>dithering</indexterm></indexterm>
                        <indexterm>dithering</indexterm>
                        <indexterm>banding</indexterm>
                        <indexterm>artifact
                              mitigation<indexterm>banding</indexterm></indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e12896">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module eliminates some of the typical banding artifacts which can occur, when
              darktable's internal 32-bit floating point data are transferred into a discrete
              8-bit or 16-bit integer output format for display or file export.
            </entry>
                                 <entry>
                                    <image href="modules/images/dithering.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                     <p>
      Banding is a problem which can arise, when an image is downsampled into a lower bit-depth.
      Downsampling happens regularly, when darktable displays or exports the results of a
      pixelpipe. In order to avoid banding, you may activate this module. As dithering consumes
      significant resources this module is disabled by default.
    </p>
                     <p>
      Although banding is not an inherent problem of any of darktable's modules, some operations
      may provoke it as they produce a lightness gradient in the image. To mitigate possible
      artifacts you should consider to activate dithering when using the
      <i>vignette</i> and the <i>graduated density</i> module,
      respectively (see <xref href="#vignetting"/> and <xref href="#graduated_density"/>).
      This is especially relevant for images with extended homogeneous areas like cloudless sky.
      Also when using a <i>gradient mask</i> (see
      <xref href="#gradient_shape"/>) you should watch out for possible banding artifacts.
    </p>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e12951">
                  <title>Usage</title>
                  <body>
                     <p>
      Viewing from some distance an image dithered into a very low bit depth (like
      <q>floyd-steinberg 1-bit b&amp;w</q>) will give the impression of a homogeneous
      grayscale image. We try to mimic this impression in darktable when you look at zoomed-out
      images in the center view, in the navigation window and for thumbnails. This is
      accomplished by dithering those images into a higher number of grayscale levels. Note that
      as a consequence the histogram – which is derived from the navigation
      window – will show this increased number of levels and is no longer a full
      match of the output image.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="method.d12e12962">
                     <title>method</title>
                     <body>
                        <p>
        This combobox sets the dithering method. Floyd-Steinberg error diffusion –
        with some typical output bit depths – and random noise dithering are both
        supported. Floyd-Steinberg systematically distributes quantization errors over
        neighboring pixels, whereas random dithering just adds some level of randomness to break
        sharp tonal value bands. The default setting is <q>floyd-steinberg auto</q>,
        which automatically adapts to the desired output format.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="damping.d12e12974">
                     <title>damping</title>
                     <body>
                        <p>
        This slider is only displayed if you choose method <q>random</q>. It controls
        the level of added random noise expressed as a damping factor in a 10*log
        <sub>2</sub>
        basis. A value of -80 is a good fit for 8-bit output formats and -160 for 16-bit ones.
      </p>
                     </body>
                     
                  </topic>
               </topic>
               <topic xml:lang="en-us" id="examples.d12e12990">
                  <title>Examples</title>
                  <body>
                     <p>
      The visibility of the following examples depends on the quality of your monitor or the
      print quality.
    </p>
                     <p>
                        <table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="2">
                              <colspec colwidth="4*"/>
                              <colspec colwidth="6*"/>
                              
                              <tbody>
                                 <row>
                                    <entry>
                                       <image href="modules/images/dithering_ex1.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                Banding artifact caused by vignetting (100% crop of a 8-bit PNG; effect heavily
                exaggerated by strong contrast enhancement).
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                                       <image href="modules/images/dithering_ex2.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                The same image area, processed as above but with activated Floyd-Steinberg
                dithering.
              </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table>
                     </p>
                  </body>
                  
               </topic>
            </topic>
            <topic xml:lang="en-us" id="hotpixels">
               <title>Hotpixels</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>hotpixels</indexterm></indexterm>
                        <indexterm>hotpixels</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e13062">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module is able to automatically detect and eliminate hotpixels. Hotpixels are
              pixels which failed to record light level correctly. Detected hotpixels are
              replaced by an average value of their neighbors.
            </entry>
                                 <entry>
                                    <image href="modules/images/hotpixels.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e13094">
                  <title>Usage</title>
                  <body>
                     <p>
      You control the detection sensitivity with the threshold parameter and the level of
      elimination with the strength parameter.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="threshold.d12e13102">
                     <title>threshold</title>
                     <body>
                        <p>
        The threshold of the detection, i.e. how strong a pixel's value needs to deviate from
        its neighbors to be regarded as a hotpixel.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="strength.d12e13111">
                     <title>strength</title>
                     <body>
                        <p>
        The strength of blending hotpixels with their surrounding.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="detectBy3Neighbours.d12e13120">
                     <title>detect by 3 neighbours</title>
                     <body>
                        <p>
        This will extend the detection of hotpixels, it will even regard a pixel as hot if a
        minimum of only three (instead of four) neighbor pixels deviate by more than the
        threshold level.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="markFixedPixels.d12e13129">
                     <title>mark fixed pixels</title>
                     <body>
                        <p>
        This options will mark the pixels that have been corrected. It also displays the count
        of detected and fixed pixels.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="chromatic_aberrations">
               <title>Chromatic aberrations</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>chromatic
                              aberration</indexterm></indexterm>
                        <indexterm>chromatic aberration<index-see-also>lens
                              correction</index-see-also></indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e13163">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module allows you to correct chromatic aberrations.
            </entry>
                                 <entry>
                                    <image href="modules/images/chromatic.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e13195">
                  <title>Usage</title>
                  <body>
                     <p>
      The module has no parameters. On activation it will automatically try to optimize away
      visible CA's.
    </p>
                     <p>
      The underlying model assumes as input an uncropped photographic image. The module is
      likely to fail when you zoom into the image, as in that case it will only receive parts of
      your photograph as input in darktable's pixelpipe. As a consequence, chromatic aberrations
      do not get corrected properly in the center view. This limitation only applies to
      interactive work, not to file export.
    </p>
                     <p>
      This module currently only works for images recorded with a Bayer sensor (which is the
      sensor used in the majority of cameras).
    </p>
                  </body>
                  
               </topic>
            </topic>
            <topic xml:lang="en-us" id="haze_removal">
               <title>Automatic haze removal</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>haze
                           removal</indexterm></indexterm>
                        <indexterm>haze removal</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e13232">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              The haze removal module is designed to automatically reduce the effect of dust and
              haze in the air, which often reduces the color contrast in landscape photographs.
              In general, this module may be employed to give pictures a color boost
              specifically in low-contrast image regions.
            </entry>
                                 <entry>
                                    <image href="modules/images/hazeremoval.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                     <p>
      The higher the haze density in the air and the longer the distance between the camera and
      the photographed object the less colorful the object appears in the image. Haze absorbs
      light approaching from the objects into the direction of the camera but it is also a
      source of diffusive background light. Thus the haze removal module estimates for each
      image region the amount of haze in the scene first and then removes the diffusive
      background light according to its local strength and recovers the original object light.
    </p>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e13267">
                  <title>Usage</title>
                  <body>
                     <p>
      The haze removal module has two controls that determine the amount of haze reduction and
      limit the distance up to which haze is removed. Setting both controls to unity maximizes
      the amount of haze removal but this is also likely to produce some artifacts. Removing the
      atmospheric light entirely may render the image flat and may result in an unnatural
      looking style. Optimal values are typically below unity and these are rather image
      dependent but also a matter of personal aesthetic preferences.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="strength.d12e13275">
                     <title>strength</title>
                     <body>
                        <p>
        The strength parameter controls the amount of haze removal. Setting it to unity, the
        module removes 100 percent of the detected haze between the camera and up to the
        specified distance; see below. Negative values for the strength increase the amount of
        haze in the image.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="distance.d12e13284">
                     <title>distance</title>
                     <body>
                        <p>
        This parameter limits the distance up to which haze is removed. For small values, haze
        removal is restricted to the foreground of the image. Haze is removed from the
        foreground to the far background if the distance parameter is set to unity. In case of a
        negative strength the distance control has no effect.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="defringe">
               <title>Defringe</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>defringe</indexterm></indexterm>
                        <indexterm>defringe</indexterm>
                        <indexterm>purple fringing</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e13321">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module is designed to remove purple or any other color of fringing which
              often results from Longitudinal Chromatic Aberrations (LCA), also known as Axial
              Chromatic Aberrations.
            </entry>
                                 <entry>
                                    <image href="modules/images/defringe.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e13353">
                  <title>Usage</title>
                  <body>
                     <p>
      This module helps removing fringe via edge-detection. Where pixels are detected as a
      fringe, it rebuilds the color from lower-saturated neighboring pixels.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="operationMode.d12e13361">
                     <title>operation mode</title>
                     <body>
                        <p>
        Set the operation mode for detecting fringes. <q>global average</q> is usually
        the fastest but might show slightly incorrect previews in high magnification. It might
        also protect the wrong regions of color too much or too little by comparison with local
        averaging. <q>local average</q> is slower because it computes local color
        references for every pixel, which might protect color better than global average and
        allows for rebuilding color where actually required. The <q>static</q> method
        does not use a color reference but directly uses the threshold as given by the user.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="edgeDetectionRadius.d12e13379">
                     <title>edge detection radius</title>
                     <body>
                        <p>
        Set the spatial extent of the gaussian blur used for an edge detection. The algorithm
        uses the difference of gaussian-blurred and original image as an indicator for edges (a
        special case of the <q>difference of gaussians</q> edge detection). Try
        increasing this value if you either want a stronger detection of the fringes or the
        thickness of the fringe edges is too high.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="threshold.d12e13391">
                     <title>threshold</title>
                     <body>
                        <p>
        Sets the threshold over which the edge of a pixel is counted as a <q>fringe</q>.
        The colors of the affected pixels will be rebuild from neighboring pixels. Try lowering
        this value if there is not enough fringe detected and try increasing this value if too
        many pixels are desaturated. You may additionally want to play around with the edge
        detection radius.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
         </topic>
         <topic xml:lang="en-us" id="effect_group">
            <title>Effect group</title>
            <body>
               <p>
    In the effect group you will find modules with a more artistic touch.
  </p>
            </body>
            <topic xml:lang="en-us" id="watermark">
               <title>Watermark</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>watermark</indexterm></indexterm>
                        <indexterm>watermark</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e13434">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              The watermark module provides a way to render a vector-based overlay onto your
              image. Watermarks are standard SVG documents and can be designed using
              <xref href="http://www.inkscape.org" format="html" scope="external"> 
                                       <i>Inkscape</i>
                                    </xref>.
            </entry>
                                 <entry>
                                    <image href="modules/images/watermark.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                     <p>
      The SVG processor of darktable also substitutes strings within the SVG document, which
      gives the opportunity to include image dependent information in the watermark such as
      aperture, exposure time and other metadata.
    </p>
                     <p>
      User-designed watermarks are placed into the directory $HOME/.config/darktable/watermarks.
      Once in place, use the reload button at the right of the watermark file name to update the
      list of available watermarks to use.
    </p>
                     <p>
      Here follows a list of available variable strings that is supported for substitution
      within the svg document. Beside this list you can also use the variable strings defined
      in export selected module.
      <table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="2">
                              <tbody>
                                 <row>
                                    <entry>
                $(DARKTABLE.NAME)
              </entry>
                                    <entry>
                The application name
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(DARKTABLE.VERSION)
              </entry>
                                    <entry>
                The version of darktable
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(WATERMARK_TEXT)
              </entry>
                                    <entry>
                A short free text (max. 63 characters)
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(WATERMARK_COLOR)
              </entry>
                                    <entry>
                The color to use for $WATERMARK_TEXT
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(WATERMARK_FONT_FAMILY)
              </entry>
                                    <entry>
                The font family to use for $WATERMARK_TEXT
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(WATERMARK_FONT_STYLE)
              </entry>
                                    <entry>
                The font style (normal, oblique, italic)
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(WATERMARK_FONT_WEIGHT)
              </entry>
                                    <entry>
                The font weight (boldness)
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(IMAGE.ID)
              </entry>
                                    <entry>
                The unique image id within current library
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(IMAGE.FILENAME)
              </entry>
                                    <entry>
                The image filename
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(IMAGE.BASENAME)
              </entry>
                                    <entry>
                The image file basename
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(IMAGE.EXIF)
              </entry>
                                    <entry>
                The image Exif string
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(EXIF.DATE)
              </entry>
                                    <entry>
                The image date
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(EXIF.DATE.SECOND)
              </entry>
                                    <entry>
                Seconds from the image Exif data
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(EXIF.DATE.MINUTE)
              </entry>
                                    <entry>
                Minutes from the image Exif data
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(EXIF.DATE.HOUR)
              </entry>
                                    <entry>
                Hours from the image Exif data (24h)
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(EXIF.DATE.HOUR_AMPM)
              </entry>
                                    <entry>
                Hours from the image Exif data (12h, AM/PM)
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(EXIF.DATE.DAY)
              </entry>
                                    <entry>
                Day of month from the image Exif data (01 .. 31)
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(EXIF.DATE.MONTH)
              </entry>
                                    <entry>
                Month from the image Exif data (01 .. 12)
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(EXIF.DATE.SHORT_MONTH)
              </entry>
                                    <entry>
                Month from the image Exif data localized (Jan, Feb, .. Dec)
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(EXIF.DATE.LONG_MONTH)
              </entry>
                                    <entry>
                Month from the image Exif data localized (January, February, .. December)
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(EXIF.DATE.SHORT_YEAR)
              </entry>
                                    <entry>
                Abbreviated year from the image Exif data (2013 is "13")
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(EXIF.DATE.LONG_YEAR)
              </entry>
                                    <entry>
                Full year from the image Exif data
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(DATE)
              </entry>
                                    <entry>
                Current system date
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(DATE.SECOND)
              </entry>
                                    <entry>
                Current system time seconds
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(DATE.MINUTE)
              </entry>
                                    <entry>
                Current system time minutes
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(DATE.HOUR)
              </entry>
                                    <entry>
                Current system time hours (24h)
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(DATE.HOUR_AMPM)
              </entry>
                                    <entry>
                Current system time hours (12, AP/PM)
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(DATE.DAY)
              </entry>
                                    <entry>
                Current system time day of month (01 .. 31)
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(DATE.MONTH)
              </entry>
                                    <entry>
                Current system time month (01 .. 12)
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(DATE.SHORT_MONTH)
              </entry>
                                    <entry>
                Current system time month localized (Jan, Feb, .. Dec)
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(DATE.LONG_MONTH)
              </entry>
                                    <entry>
                Current system time month localized (January, February, .. December)
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(DATE.SHORT_YEAR)
              </entry>
                                    <entry>
                Current system time year (abbreviated)
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(DATE.LONG_YEAR)
              </entry>
                                    <entry>
                Current system time year
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(EXIF.MAKER)
              </entry>
                                    <entry>
                The maker of camera model
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(EXIF.MODEL)
              </entry>
                                    <entry>
                The camera model
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(EXIF.LENS)
              </entry>
                                    <entry>
                The specific lens used
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(Xmp.dc.creator)
              </entry>
                                    <entry>
                The creator string
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(Xmp.dc.publisher)
              </entry>
                                    <entry>
                The publisher string
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(Xmp.dc.title)
              </entry>
                                    <entry>
                The title of the image
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(Xmp.dc.description)
              </entry>
                                    <entry>
                The description of the image.  This is the field to use when you're looking for the user-specified text that some cameras add at shoot time to exif field <q>User Comment</q> (also called <q>Exif.Photo.UserComment</q>).
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(Xmp.dc.rights)
              </entry>
                                    <entry>
                The rights assigned to the image
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(GPS.LATITUDE)
              </entry>
                                    <entry>
                The image latitude coordinate (N/S 0 .. 90)
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(GPS.LONGITUDE)
              </entry>
                                    <entry>
                The image longitude coordinate (E/W 0 .. 180)
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(GPS.ELEVATION)
              </entry>
                                    <entry>
                The image elevation level (meters)
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                $(GPS.LOCATION)
              </entry>
                                    <entry>
                All three coordinates (latitude, longitude, elevation)
              </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table>
                     </p>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e13907">
                  <title>Usage</title>
                  <topic xml:lang="en-us" id="marker.d12e13912">
                     <title>marker</title>
                     <body>
                        <p>
        Choose the watermark of interest. You can use the reload button next to the combobox to
        update the list with all newly added watermarks.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="text.d12e13921">
                     <title>text</title>
                     <body>
                        <p>
        A free text field with up to 63 characters which gets printed if the corresponding
        watermark references it. An example is supplied as <filepath>simple-text.svg</filepath>.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="textColor.d12e13933">
                     <title>text color</title>
                     <body>
                        <p>
        This field shows the text color. Clicking on the colored field will open a color
        selector dialog which offers you a choice of commonly used colors, or allows to define a
        color in RGB color space.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="textFont.d12e13942">
                     <title>text font</title>
                     <body>
                        <p>
        This field lets you select the text font. Clicking on the field opens a dialog box which
        shows the fonts available to your system. Fonts can be searched by name and a preview of
        each available font is shown next to the font name; you may specify your own sample
        text. The font defaults to <q>DejaVu Sans Book</q>.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="opacity.d12e13954">
                     <title>opacity</title>
                     <body>
                        <p>
        Set the opacity of the watermark's rendering.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="scale.d12e13964">
                     <title>scale</title>
                     <body>
                        <p>
        Scale the watermark pixel-independently.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="rotate.d12e13973">
                     <title>rotate</title>
                     <body>
                        <p>
        Set the rotation angle of the watermark.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="scaleOn.d12e13982">
                     <title>scale on</title>
                     <body>
                        <p>
        Defines the reference for the scale parameter. The default setting <q>image</q>
        scales the watermark relative to the horizontal image size. Alternatively you can scale
        the watermark relative to the <q>larger border</q> and <q>smaller
        border</q>, respectively.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="alignment.d12e14000">
                     <title>alignment</title>
                     <body>
                        <p>
        Use these controls to align the watermark to any edge or center of the image.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="xOffset.d12e14009">
                     <title>x offset</title>
                     <body>
                        <p>
        Pixel-independent offset relative to the choice of alignment on the x-axis.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="yOffset.d12e14018">
                     <title>y offset</title>
                     <body>
                        <p>
        Pixel-independent offset relative to the choice of alignment on the y-axis.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="framing">
               <title>Framing</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>framing</indexterm></indexterm>
                        <indexterm>framing</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e14049">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module is an artistic feature to generate a frame around your image. The
              frame consists of a border with a user defined color and a frame line inside that
              border, which has another user defined color. There are various options for you to
              control the geometry of your frame.
            </entry>
                                 <entry>
                                    <image href="modules/images/framing.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e14081">
                  <title>Usage</title>
                  <topic xml:lang="en-us" id="borderSize.d12e14086">
                     <title>border size</title>
                     <body>
                        <p>
        This slider controls the size of the frame in percent of the underlying full image.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="aspect.d12e14095">
                     <title>aspect</title>
                     <body>
                        <p>
        With this combobox you can choose between different aspect ratios for the final output
        of this module, i.e. underlying image plus frame.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="orientation.d12e14104">
                     <title>orientation</title>
                     <body>
                        <p>
        If you select a non-square aspect ratio this combobox defines the
        orientation – portrait or landscape. Set to <q>auto</q> if you want
        darktable to select the most reasonable orientation based on the underlying image.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="horizontalPosition.d12e14116">
                     <title>horizontal position</title>
                     <body>
                        <p>
        Select from a set of pre-defined ratios where you want your underlying image be
        positioned on the horizontal axis. You can also right click and enter your own ratio as
        <q>x/y</q>.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="verticalPosition.d12e14128">
                     <title>vertical position</title>
                     <body>
                        <p>
        Select from a set of pre-defined ratios where you want your underlying image be
        positioned on the vertical axis. You can also right click and enter your own ratio as
        <q>x/y</q>.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="frameLineSize.d12e14141">
                     <title>frame line size</title>
                     <body>
                        <p>
        The percentage of the frame line size relative to the border size at its smallest part.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="frameLineOffset.d12e14150">
                     <title>frame line offset</title>
                     <body>
                        <p>
        Where the frame line is positioned relative to the underlying image. Select a value of 0
        for a frame line touching the image, 100% for a frame line touching the outer border
        limits.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="borderColor.d12e14159">
                     <title>border color</title>
                     
                     <prolog>
                        <metadata><keywords>
                              <indexterm>color picker</indexterm>
                           </keywords></metadata>
                        
                     </prolog>
                     <body>
                        <p>
        A color selector which allows to define a color for the border. Clicking on the colored
        field will open a color selector dialog which offers you a choice of commonly used
        colors, or allows to define a color in RGB color space.
      </p>
                        <p>
        You can also activate a color picker by pressing
        <image href="../images/darkroom_module_icon_picker.png" align="center"/>
        and take a color probe from your image. You can switch between point and area sampling
        mode from within the global color picker panel (see
        <xref href="#global_color_picker"/>).
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="frameLineColor.d12e14183">
                     <title>frame line color</title>
                     <body>
                        <p>
        A color selector which allows to define a color for the frame. Clicking on the colored
        field will open a color selector dialog which offers you a choice of commonly used
        colors, or allows to define a color in RGB color space.
      </p>
                        <p>
        You can also activate a color picker by pressing
        <image href="../images/darkroom_module_icon_picker.png" align="center"/>
        and take a color probe from your image. You can switch between point and area sampling
        mode from within the global color picker panel (see
        <xref href="#global_color_picker"/>).
      </p>
                     </body>
                     
                  </topic>
               </topic>
               <topic xml:lang="en-us" id="examples.d12e14202">
                  <title>Examples</title>
                  <body>
                     <p>
                        <table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="2">
                              <colspec colwidth="4*"/>
                              <colspec colwidth="6*"/>
                              
                              <tbody>
                                 <row>
                                    <entry>
                                       <image href="modules/images/framing_ex1.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                Example image with a user defined frame.
              </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table>
                     </p>
                  </body>
                  
               </topic>
            </topic>
            <topic xml:lang="en-us" id="splittoning">
               <title>split-toning</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>split-toning</indexterm></indexterm>
                        <indexterm>split-toning</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e14258">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              darktable's split-toning method creates a two color linear toning effect where the
              shadows and highlights are represented by two different colors. In the example
              image below you can see an original black and white image and one where a
              split-toning effect is applied with blue in shadows and a yellowish color in
              highlights.
            </entry>
                                 <entry>
                                    <image href="modules/images/splittoning.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                     <p>
      Compared to traditional split-toning our module has more parameters to influence its
      behavior. We have parameter <q>balance</q>, which offsets the 50% gray level in
      your image – at your choice – more to the shadows or more to the
      highlights. Additionally, with parameter <q>compression</q> you can compress
      toning in the shadows and highlights and leave a gap in the mid-tones, which remain
      untouched by the effect.
    </p>
                     <p>
      The split-toning module does not convert images to black and white and has limited benefits
      on color images. So, if you want to do traditional split-toning, use the
      <i>monochrome</i> module (see <xref href="#monochrome"/>) to make the
      image black and white before playing around with split-toning effect.
    </p>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e14307">
                  <title>Usage</title>
                  <topic xml:lang="en-us" id="shadowsAndHighlightsColor.d12e14312">
                     <title>shadows and highlights color</title>
                     <body>
                        <p>
        These controls are used to set the color of the split-toning effect, you select the
        desired color and saturation for both shadows and highlights. Clicking on the colored
        squares will open a color selector dialog which offers you a choice of commonly used
        colors, or allows to define a color in RGB color space.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="balance.d12e14321">
                     <title>balance</title>
                     <body>
                        <p>
        This parameter represents the ratio of toning between shadows and highlights. For a
        value of 50% half of the lightness range in image is used for shadows toning and the
        other half for highlights toning.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="compression.d12e14330">
                     <title>compression</title>
                     <body>
                        <p>
        Compression is a percentage of total lightness range that is not affected by color
        toning. Default value is set to 33%; this is not the default behavior of an original
        split-toning which would be 0% compression. The choice of 33% as a default is to invite
        you experimenting with these parameters and how it extends the original split-toning
        method.
      </p>
                     </body>
                     
                  </topic>
               </topic>
               <topic xml:lang="en-us" id="examples.d12e14340">
                  <title>Examples</title>
                  <body>
                     <p>
                        <table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="2">
                              <colspec colwidth="4*"/>
                              <colspec colwidth="6*"/>
                              
                              <tbody>
                                 <row>
                                    <entry>
                                       <image href="modules/images/splittoning_ex1.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                Original black and white image.
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                                       <image href="modules/images/splittoning_ex2.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                split-toning with blue shadows and yellow highlights.
              </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table>
                     </p>
                  </body>
                  
               </topic>
            </topic>
            <topic xml:lang="en-us" id="vignetting">
               <title>Vignetting</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>vignetting</indexterm></indexterm>
                        <indexterm>vignetting</indexterm>
                        <indexterm>artifact
                              mitigation<indexterm>banding</indexterm></indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e14418">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module is an artistic feature which creates vignetting (modification of the
              brightness/saturation at the borders).
            </entry>
                                 <entry>
                                    <image href="modules/images/vignetting.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e14450">
                  <title>Usage</title>
                  <body>
                     <p>
      The vignetting module has an extensive set of parameters to precisely tune its effect. It
      also will display graphical controls within the image if the module is in focus. Give it a
      try to get a feeling of how it works. On-screen controls and parameter sliders will stay
      in sync.
    </p>
                     <p>
      This module is known to provoke banding artifacts under certain conditions; you should
      consider to activate the <i>dithering</i> module (see
      <xref href="#dithering"/>).
    </p>
                  </body>
                  <topic xml:lang="en-us" id="scale.d12e14466">
                     <title>scale</title>
                     <body>
                        <p>
        Set the radius of the vignetting area.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="falloffStrength.d12e14475">
                     <title>fall-off strength</title>
                     <body>
                        <p>
        Sets the progressiveness of the fall-off. Higher values will cause a steeper transition.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="brightness.d12e14484">
                     <title>brightness</title>
                     <body>
                        <p>
        Sets the intensity of brightening (positive values) or darkening (negative values).
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="saturation.d12e14494">
                     <title>saturation</title>
                     <body>
                        <p>
        Controls how strong colors become when desaturated or saturated in the darkened or
        brightened vignetting area.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="horizontalCenter.d12e14503">
                     <title>horizontal center</title>
                     <body>
                        <p>
        Shifts the center of the vignetting area horizontally.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="verticalCenter.d12e14512">
                     <title>vertical center</title>
                     <body>
                        <p>
        Shifts the center of the vignetting area vertically.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="shape.d12e14521">
                     <title>shape</title>
                     <body>
                        <p>
        Influences the shape of the vignetting area. The default value of 1 causes a circular or
        elliptical area. Smaller values will shift the shape into a more square one; higher
        values turn it into a cross-like shape.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="automaticRatio.d12e14530">
                     <title>automatic ratio</title>
                     <body>
                        <p>
        Click this button to automatically adjust the width/height ratio of the vignetting area
        to the aspect ratio of the underlying image. The vignetting area will typically become
        elliptical.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="widthheightRatio.d12e14539">
                     <title>width/height ratio</title>
                     <body>
                        <p>
        Manually adjust the width/height ratio of the vignetting area.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="dithering.d12e14549">
                     <title>dithering</title>
                     <body>
                        <p>
        With this combobox you can activate random noise dithering to overcome banding artifacts
        caused by vignette gradients. Select <q>8-bit output</q> to prevent banding on
        monitor display and for JPEGs. When set to <q>16-bit output</q>, only a little
        dithering will be applied, just strong enough to compensate for banding on the fine
        grained 16-bit level. This feature is mostly obsoleted by our new module
        <i>dithering</i> (see <xref href="#dithering"/>).
      </p>
                     </body>
                     
                  </topic>
               </topic>
               <topic xml:lang="en-us" id="examples.d12e14571">
                  <title>Examples</title>
                  <body>
                     <p>
                        <table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="2">
                              <colspec colwidth="4*"/>
                              <colspec colwidth="6*"/>
                              
                              <tbody>
                                 <row>
                                    <entry>
                                       <image href="modules/images/vignetting_ex1.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                An image with vignetting and with graphical vignetting controls displayed.
              </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table>
                     </p>
                  </body>
                  
               </topic>
            </topic>
            <topic xml:lang="en-us" id="soften">
               <title>Soften</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>soften</indexterm></indexterm>
                        <indexterm>soften</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e14628">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module is an artistic feature that creates a softened image, commonly known
              as the Orton effect.
            </entry>
                                 <entry>
                                    <image href="modules/images/soften.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e14660">
                  <title>Usage</title>
                  <body>
                     <p>
      Michael Orton achieved his results on slide film by using two exposures of the same scene:
      one well exposed and one overexposed; he then used a darkroom technique to blend those
      into a final image where the overexposed image was blurred.
    </p>
                     <p>
      This module is almost a copy of Orton's analogue process into the digital domain. You can
      control brightness and blur with the provided parameters; we also add a control for
      saturation of the overexposured image for more play.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="size.d12e14671">
                     <title>size</title>
                     <body>
                        <p>
        Set the size of blur of the overexposed image in the process, the bigger the softer.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="saturation.d12e14680">
                     <title>saturation</title>
                     <body>
                        <p>
        Set the saturation of the overexposed image.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="brightness.d12e14689">
                     <title>brightness</title>
                     <body>
                        <p>
        Expressed in [EV], the brightness slider selects the increase in brightness.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="mix.d12e14699">
                     <title>mix</title>
                     <body>
                        <p>
        Controls the mix of the overexposed image and the overall effect.
      </p>
                     </body>
                     
                  </topic>
               </topic>
               <topic xml:lang="en-us" id="examples.d12e14709">
                  <title>Examples</title>
                  <body>
                     <p>
                        <table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="2">
                              <colspec colwidth="4*"/>
                              <colspec colwidth="6*"/>
                              
                              <tbody>
                                 <row>
                                    <entry>
                                       <image href="modules/images/soften_ex1.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                This is the original image, use it as reference for the changes below...
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                                       <image href="modules/images/soften_ex2.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                In this image I used the default values, and added 0.33EV to brightness for a
                little more light in the soft layer.
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                                       <image href="modules/images/soften_ex3.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                This version is the same as above but with 25% saturation.
              </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table>
                     </p>
                  </body>
                  
               </topic>
            </topic>
            <topic xml:lang="en-us" id="grain">
               <title>Grain</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>grain</indexterm></indexterm>
                        <indexterm>grain</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e14791">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module is an artistic feature which simulates the grain of a film.
            </entry>
                                 <entry>
                                    <image href="modules/images/grain.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e14823">
                  <title>Usage</title>
                  <body>
                     <p>
      The grain is processed on the L channel from CIELAB.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="coarseness.d12e14831">
                     <title>coarseness</title>
                     <body>
                        <p>
        Set the grain size, which has been scaled to simulate an ISO number.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="strength.d12e14840">
                     <title>strength</title>
                     <body>
                        <p>
        Set the strength of the effect.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="highpass">
               <title>Highpass</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>highpass</indexterm></indexterm>
                        <indexterm>highpass</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e14871">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              Highpass acts as a high pass filter. The primary usage for this filter is in
              combination with a blending operator. Try out blend mode <q>soft light</q>
              to get highpass sharpening. Use the opacity slider to adjust the strength of the
              effect or use a <i>drawn mask</i> (see <xref href="#drawn_mask"/>)
              or <i>parametric mask</i> (see <xref href="#parametric_mask"/>) to
              limit the effect to only parts of your image.
            </entry>
                                 <entry>
                                    <image href="modules/images/highpass.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e14916">
                  <title>Usage</title>
                  <topic xml:lang="en-us" id="sharpen.d12e14921">
                     <title>sharpen</title>
                     <body>
                        <p>
        Set the sharpness. The higher, the more details.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="contrastBoost.d12e14930">
                     <title>contrast boost</title>
                     <body>
                        <p>
        Set the contrast boost.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="lowpass">
               <title>Lowpass</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>lowpass</indexterm></indexterm>
                        <indexterm>lowpass</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e14961">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              A lowpass filter (eg. gaussian blur) with additional control of the outcome both
              of contrast and saturation. The primary usage for lowpass filter is in combination
              with a <i>blending operator</i> (see
              <xref href="#blending_operators"/>). Try out the preset named <q>local
              contrast mask</q> with an <q>overlay</q> blending operation.
            </entry>
                                 <entry>
                                    <image href="modules/images/lowpass.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e15004">
                  <title>Usage</title>
                  <body>
                     <p>
      This module offers enormous artistic potential, albeit, with results that are sometimes
      difficult to predict.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="radius.d12e15012">
                     <title>radius</title>
                     <body>
                        <p>
        Set the radius of the blur.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="softenWith.d12e15021">
                     <title>soften with</title>
                     <body>
                        <p>
        This combobox defines the blur algorithm; you can choose between <q>gaussian</q>
        blur (default) and <q>bilateral</q> filter. The latter leads to an edge
        preserving blur. <q>gaussian</q> will blur all image channels: L, a and b.
        <q>bilateral</q> will only blur L channel.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="contrast.d12e15042">
                     <title>contrast</title>
                     <body>
                        <p>
        Changes the contrast. Negative values result in an inverted negative image. Higher
        absolute values increase contrast; lower absolute values reduce contrast. A value of
        zero leads to a neutral plane.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="brightness.d12e15051">
                     <title>brightness</title>
                     <body>
                        <p>
        Changes the brightness. Negative values result in a darker image. Positive values
        increase the image's brightness.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="saturation.d12e15061">
                     <title>saturation</title>
                     <body>
                        <p>
        Changes the color saturation. Negative values result in complementary colors by
        inverting the a/b-channels. Higher absolute values increase color saturation; lower
        absolute values reduce color saturation. A value of zero leads to a desaturated
        black&amp;white image.
      </p>
                     </body>
                     
                  </topic>
               </topic>
               <topic xml:lang="en-us" id="examples.d12e15071">
                  <title>Examples</title>
                  <body>
                     <p>
                        <table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="2">
                              <colspec colwidth="4*"/>
                              <colspec colwidth="6*"/>
                              
                              <tbody>
                                 <row>
                                    <entry>
                                       <image href="modules/images/lowpass_ex1.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                The original image, already heavily processed. The boat is almost a silhouette.
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                                       <image href="modules/images/lowpass_ex2.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                Bilateral blur with high radius. Desaturated, inverted and with high contrast.
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                                       <image href="modules/images/lowpass_ex3.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                Intermediate result after lowpass filter ...
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                                       <image href="modules/images/lowpass_ex4.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                ... and final image after this was applied with blend mode "vividlight".
              </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table>
                     </p>
                  </body>
                  
               </topic>
            </topic>
            <topic xml:lang="en-us" id="low_light">
               <title>Low light</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>lowlight</indexterm></indexterm>
                        <indexterm>lowlight</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e15166">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
                                    <p>
                The <i>low light</i> module allows one to simulate human lowlight
                vision, thus providing ability to make lowlight pictures look closer to reality.
                It can also be used to perform a day to night conversion.
              </p>

                                    <p>
                The idea is to calculate a
                <xref href="http://en.wikipedia.org/wiki/Scotopic_vision"
                                             format="html"
                                             scope="external">scotopic
                vision</xref> image which is perceived by rods rather than than cones in the
                eye under low light. Scotopic lightness then is mixed with photopic value
                (regular color image pixel) using some blending function. Also this module is
                able to simulate the
                <xref href="http://en.wikipedia.org/wiki/Purkinje_effect"
                                             format="html"
                                             scope="external">Purkinje
                effect</xref> by adding some blueness to the dark parts of the image.
              </p>
                                 </entry>
                                 <entry>
                                    <image href="modules/images/lowlight.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e15213">
                  <title>Usage</title>
                  <body>
                     <p>
      This module comes with several presets. Give them a try to get a better feeling how it
      works.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="curve.d12e15221">
                     <title>curve</title>
                     <body>
                        <p>
        The horizontal axis is about pixel lightness from dark (left) to bright (right). The
        vertical axis represents the kind of vision from night vision (bottom) to day vision
        (top)
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="blue.d12e15230">
                     <title>blue</title>
                     <body>
                        <p>
        Set the blue hint in shadows (Purkinje effect).
      </p>
                     </body>
                     
                  </topic>
               </topic>
               <topic xml:lang="en-us" id="examples.d12e15240">
                  <title>Examples</title>
                  <body>
                     <p>
                        <table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="2">
                              <colspec colwidth="4*"/>
                              <colspec colwidth="6*"/>
                              
                              <tbody>
                                 <row>
                                    <entry>
                                       <image href="modules/images/lowlight_ex1_1.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                Image 1. This is the original image.
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                                       <image href="modules/images/lowlight_ex1_2.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                Image 1. With low light module on.
              </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table>
                        <table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="2">
                              <colspec colwidth="6*"/>
                              <colspec colwidth="4*"/>
                              
                              <tbody>
                                 <row>
                                    <entry>
                Image 2. This is the original image.
              </entry>
                                    <entry>
                                       <image href="modules/images/lowlight_ex2_1.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                 </row>
                                 <row>
                                    <entry>
                Image 2. With low light module on.
              </entry>
                                    <entry>
                                       <image href="modules/images/lowlight_ex2_2.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table>
                     </p>
                  </body>
                  
               </topic>
            </topic>
            <topic xml:lang="en-us" id="bloom">
               <title>Bloom</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>bloom</indexterm></indexterm>
                        <indexterm>bloom</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e15348">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module takes highlights, blurs them and then blends (screen blend lightness)
              with the original to create a soft blooms over the image, hence the name of the
              effect. There are numerous ways to use this module depending on the image's actual
              scenery lighting.
            </entry>
                                 <entry>
                                    <image href="modules/images/bloom.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e15380">
                  <title>Usage</title>
                  <body>
                     <p>
      Starting from the default settings change the strength value for a pleasant look, then
      change the size to control the spread of light.
    </p>
                  </body>
                  <topic xml:lang="en-us" id="size.d12e15388">
                     <title>size</title>
                     <body>
                        <p>
        Represents the spatial extent of the bloom effect.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="threshold.d12e15397">
                     <title>threshold</title>
                     <body>
                        <p>
        Set the threshold for the increase in brightness.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="strength.d12e15406">
                     <title>strength</title>
                     <body>
                        <p>
        Set the strength of overlightning for the effect.
      </p>
                     </body>
                     
                  </topic>
               </topic>
               <topic xml:lang="en-us" id="examples.d12e15416">
                  <title>Examples</title>
                  <body>
                     <p>
                        <table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="2">
                              <colspec colwidth="4*"/>
                              <colspec colwidth="6*"/>
                              
                              <tbody>
                                 <row>
                                    <entry>
                                       <image href="modules/images/bloom_ex1.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                This is the original image, use it as reference for the changes below...
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                                       <image href="modules/images/bloom_ex2.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                Here we have chosen to use a size of 10%, which is a rather small radius for the
                soft light spread. We boosted up the strength to 50% for a more exaggerated
                effect.
              </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table>
                     </p>
                  </body>
                  
               </topic>
            </topic>
            <topic xml:lang="en-us" id="colorize">
               <title>Colorize</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>colorize</indexterm></indexterm>
                        <indexterm>colorize</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e15486">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module is an artistic feature that adds a solid layer of color to your image.
            </entry>
                                 <entry>
                                    <image href="modules/images/colorize.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e15518">
                  <title>Usage</title>
                  <body>
                     <p>
      Several parameters control the effect of this module. Much more versatility can be reached
      if you apply blending and masks. (see <xref href="#blending"/>).
    </p>
                  </body>
                  <topic xml:lang="en-us" id="hue.d12e15528">
                     <title>hue</title>
                     <body>
                        <p>
        Selects the hue of the color layer.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="saturation.d12e15537">
                     <title>saturation</title>
                     <body>
                        <p>
        Selects the color saturation of shadow tones.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="lightness.d12e15546">
                     <title>lightness</title>
                     <body>
                        <p>
        Selects the lightness of the color layer.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="sourceMix.d12e15555">
                     <title>source mix</title>
                     <body>
                        <p>
        This slider controls how the lightness of the input image is mixed in. If you set this
        to zero a uniformly colored plane will result.
      </p>
                     </body>
                     
                  </topic>
               </topic>
            </topic>
            <topic xml:lang="en-us" id="color_mapping">
               <title>Color mapping</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>color
                           mapping</indexterm></indexterm>
                        <indexterm>color mapping</indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e15586">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module transfers the look and feel from one image onto another. It
              statistically analyses the color characteristics of a source image and a target
              image. The colors of the source image are then mapped to corresponding colors of
              the target image.
            </entry>
                                 <entry>
                                    <image href="modules/images/colormapping.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e15618">
                  <title>Usage</title>
                  <body>
                     <p>
      To use this module two steps are required.
    </p>
                     <p>
      First you open the source image in darkroom mode and acquire its color characteristics by
      pressing the <q>acquire as source</q> button. A set of color clusters is generated
      and displayed in the <q>source clusters</q> area. Each cluster is represented by a
      set of color swatches with the mean value in the center surrounded by swatches indicating
      the color variance within that cluster. The clusters are sorted in ascending order by
      their weight, i.e. the number of pixels that contribute to the clusters.
    </p>
                     <p>
      Next you open your target image in darkroom mode. darktable has remembered the previously
      collected source clusters; if they are not yet displayed, press the
      <image href="../images/darkroom_module_icon_reset.png" align="center"/>
      button. You now press the <q>acquire as target</q> button to generate a
      corresponding set of color clusters for your target image, which gets displayed in the
      <q>target clusters</q> area.
    </p>
                     <p>
      When both source and target clusters are collected an automatic color mapping is applied
      to the target image. In its default settings the overall effect is quite exaggerated. A
      set of sliders gives you control of the effect's strength. You can also use blending
      operator <q>normal</q> to tame the effect (see
      <xref href="#blending_operators"/>). As the <i>color mapping</i> module
      comes early in the pixelpipe, you can finetune the colors with modules like <i>tone
      curve</i> (see <xref href="#tone_curve"/>) or <i>color
      correction</i> (see <xref href="#color_correction"/>).
    </p>
                  </body>
                  <topic xml:lang="en-us" id="acquireAsSourcetarget.d12e15670">
                     <title>acquire as source/target</title>
                     <body>
                        <p>
        Press these buttons to generate color clusters for the source and target image,
        respectively. The processing takes a few seconds during which the GUI remains
        unresponsive.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="numberOfClusters.d12e15680">
                     <title>number of clusters</title>
                     <body>
                        <p>
        Sets the number of color clusters to use. If you change this parameter all collected
        color clusters are reset and need to be acquired anew.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="colorDominance.d12e15689">
                     <title>color dominance</title>
                     <body>
                        <p>
        This parameter controls the mapping between source and target clusters. At the lowest
        value mapping is based on color proximity. This typically leads to very subtle effects
        on the target image. At the maximum value mapping is based on the relative weight of the
        color clusters – dominant colors of the source image are mapped to dominant
        colors of the target image. This typically leads to a very bold effect. In-between
        values incrementally shift between the extremes.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="histogramEqualization.d12e15698">
                     <title>histogram equalization</title>
                     <body>
                        <p>
        Besides mapping of color characteristics this module can modify the target image's
        contrast by matching its histogram with the histogram of the source image. This slider
        controls the extent of the effect.
      </p>
                     </body>
                     
                  </topic>
               </topic>
               <topic xml:lang="en-us" id="examples.d12e15708">
                  <title>Examples</title>
                  <body>
                     <p>
                        <table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="2">
                              <colspec colwidth="4*"/>
                              <colspec colwidth="6*"/>
                              
                              <tbody>
                                 <row>
                                    <entry>
                                       <image href="modules/images/colormapping_ex1.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                The source image taken shortly after sunset under front lighting conditions.
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                                       <image href="modules/images/colormapping_ex2.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                The target image taken in the afternoon with a partly clouded sky. Our goal is
                to transfer the evening atmosphere of the source image.
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                                       <image href="modules/images/colormapping_ex3.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                The target image with color mapping applied. A number of 2 clusters was used.
                <q>color dominance</q> is set to 100% for a bold but still credible
                effect. <q>histogram equalization</q> is set to 80%.
              </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table>
                     </p>
                  </body>
                  
               </topic>
            </topic>
            <topic xml:lang="en-us" id="graduated_density">
               <title>Graduated Density</title>
               
               <prolog>
                  <metadata><keywords>
                        <indexterm>modules<indexterm>graduated
                              density</indexterm></indexterm>
                        <indexterm>graduated density</indexterm>
                        <indexterm>artifact
                              mitigation<indexterm>banding</indexterm></indexterm>
                     </keywords></metadata>
                  
               </prolog>
               <topic xml:lang="en-us" id="overview.d12e15805">
                  <title>Overview</title>
                  <body>
                     <table frame="none">
                        <tgroup colsep="0" rowsep="0" cols="2">
                           <colspec colwidth="6*"/>
                           <colspec colwidth="4*"/>
                           
                           <tbody>
                              <row>
                                 <entry>
              This module aims at simulating a graduated density filter, in order to correct
              exposure and color in a progressive manner.
            </entry>
                                 <entry>
                                    <image href="modules/images/graduatedneutraldensity.png"
                                           align="center"
                                           placement="break"/>
                                 </entry>
                              </row>
                           </tbody>
                        </tgroup>
                     </table>
                  </body>
                  
               </topic>
               <topic xml:lang="en-us" id="usage.d12e15837">
                  <title>Usage</title>
                  <body>
                     <p>
      The module uses a gradient to modify the exposure and the color cast of the image in a
      non-homogeneously manner.
    </p>
                     <p>
      This module is known to provoke banding artifacts under certain conditions; you should
      consider to activate the <i>dithering</i> module (see
      <xref href="#dithering"/>).
    </p>
                  </body>
                  <topic xml:lang="en-us" id="density.d12e15853">
                     <title>density</title>
                     <body>
                        <p>
        Set the density of the filter in [ev]. A low value underexposes slightly whereas a high
        value creates a strong filter.
      </p>
                        <p>
        It is expressed as [ev] that is equivalent to <i>f-stops</i>. Lens filters
        are often referred as ND2, ND4, ND8 and so on. Each time you add an [ev] you double the
        ND. So ND2 is 1 ev, ND4 is 2 ev, and so on. You can also express it in optical density
        or transmittance. The table below sums up the different approach for the most common
        filters:
        <table frame="none">
                              <tgroup colsep="0" rowsep="0" cols="4"><!-- topic/colspec  not supplied within  topic/tgroup -->
                                 <tbody>
                                    <row>
                                       <entry>
                                          <i>ND</i>
                                       </entry>
                                       <entry>
                  [ev] or f-stop
                </entry>
                                       <entry>
                  absorbance
                </entry>
                                       <entry>
                  transmittance
                </entry>
                                    </row>
                                    <row>
                                       <entry>
                                          <i>ND2</i>
                                       </entry>
                                       <entry>
                  -1
                </entry>
                                       <entry>
                  0.3
                </entry>
                                       <entry>
                  50%
                </entry>
                                    </row>
                                    <row>
                                       <entry>
                                          <i>ND4</i>
                                       </entry>
                                       <entry>
                  -2
                </entry>
                                       <entry>
                  0.6
                </entry>
                                       <entry>
                  25%
                </entry>
                                    </row>
                                    <row>
                                       <entry>
                                          <i>ND8</i>
                                       </entry>
                                       <entry>
                  -3
                </entry>
                                       <entry>
                  0.9
                </entry>
                                       <entry>
                  12.5%
                </entry>
                                    </row>
                                    <row>
                                       <entry>
                                          <i>ND400</i>
                                       </entry>
                                       <entry>
                  -9
                </entry>
                                       <entry>
                  2.7
                </entry>
                                       <entry>
                  0.195%
                </entry>
                                    </row>
                                 </tbody>
                              </tgroup>
                           </table>
                        </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="compression.d12e15967">
                     <title>compression</title>
                     <body>
                        <p>
        Set progressiveness of the gradient. A low value creates a smooth transition, whereas a
        high value makes the transition abrupt.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="hue.d12e15976">
                     <title>hue</title>
                     <body>
                        <p>
        Set the hue to add a color cast to the gradient.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="saturation.d12e15986">
                     <title>saturation</title>
                     <body>
                        <p>
        Set the saturation to add a color cast to the gradient.
      </p>
                     </body>
                     
                  </topic>
                  <topic xml:lang="en-us" id="position.d12e15995">
                     <title>position</title>
                     <body>
                        <p>
                           <table frame="none">
                              <tgroup colsep="0" rowsep="0" cols="2">
                                 <colspec colwidth="6*"/>
                                 <colspec colwidth="4*"/>
                                 
                                 <tbody>
                                    <row>
                                       <entry>
                  You can set the position of the gradient directly on the image by moving the
                  white line. For fine tuning, you can also use the rotation slider. Negative
                  values turn clockwise.
                </entry>
                                       <entry>
                                          <image href="modules/images/graduatedneutraldensity_canvas.png"
                                                 align="center"
                                                 placement="break"/>
                                       </entry>
                                    </row>
                                 </tbody>
                              </tgroup>
                           </table>
                        </p>
                     </body>
                     
                  </topic>
               </topic>
               <topic xml:lang="en-us" id="examples.d12e16032">
                  <title>Examples</title>
                  <body>
                     <p>
      Here is an example that shows various options of darktable's graduated density filter:
    </p>
                     <p>
                        <table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="2">
                              <colspec colwidth="4*"/>
                              <colspec colwidth="6*"/>
                              
                              <tbody>
                                 <row>
                                    <entry>
                                       <image href="modules/images/graduatedneutraldensity_ex1.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                This is the original image with a pretty overexposed sky, use it as reference
                for the changes below...
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                                       <image href="modules/images/graduatedneutraldensity_ex2.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                And now we have added a neutral ND8 filter which does a pretty good job on the
                image..
              </entry>
                                 </row>
                                 <row>
                                    <entry>
                                       <image href="modules/images/graduatedneutraldensity_ex3.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                    <entry>
                And at last, we added an orange colored filter rotating it -180 degrees,
                applying it on water/trees for a more artistic use of the filter.
              </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table>
                     </p>
                     <p>
      darktable's graduated density filter is a powerful tool. Nevertheless, hardware filters
      have some advantages over a pure software solution. With a physical GND filter you can in
      fact reduce the dynamic range of your scene to make it better fit the limits of your
      camera sensor.
    </p>
                     <p>
                        <table frame="none">
                           <tgroup colsep="0" rowsep="0" cols="2">
                              <colspec colwidth="6*"/>
                              <colspec colwidth="4*"/>
                              
                              <tbody>
                                 <row>
                                    <entry>
                In this example a hardware GND filter (Hitech ND0.6, soft edge) helped to
                prevent over-exposure in the sky and tree tops, while at the same time getting a
                well exposed image of the ground. A rather disturbing element is the decay of
                brightness in the tree trunks from bottom to top.
              </entry>
                                    <entry>
                                       <image href="modules/images/graduatedneutraldensity_ex4.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                 </row>
                                 <row>
                                    <entry>
                darktable's graduated density filter together with the parametric mask feature
                (see <xref href="#parametric_mask"/>) comes in handy. We can add a brightness
                gradient that is just inverted in relation to the hardware filter. As we only
                want to compensate the unnatural decay of brightness in the tree trunks, we
                combine the module with a suited blend mask.
              </entry>
                                    <entry>
                                       <image href="modules/images/graduatedneutraldensity_ex5.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                 </row>
                                 <row>
                                    <entry>
                The resulting image.
              </entry>
                                    <entry>
                                       <image href="modules/images/graduatedneutraldensity_ex6.png"
                                              align="center"
                                              placement="break"/>
                                    </entry>
                                 </row>
                              </tbody>
                           </tgroup>
                        </table>
                     </p>
                     <p>
      Tip: If you know you intend to use the graduated density filter before actually making a
      shot with your camera you might want to underexpose by one or two thirds of an f-stop to
      make sure detail remains in the highlights. When all detail has truly been blown out the
      graduated density filter cannot produce a pleasing results, this is a limitation that is
      inherent to digital postprocessing. For instructions on how to intentionally underexpose,
      please consult your camera's manual, look for <q>exposure compensation</q>.
    </p>
                  </body>
                  
               </topic>
            </topic>
         </topic>
      </topic>
      <topic xml:lang="en-us" id="examples">
         <title>Examples</title>
         <topic xml:lang="en-us" id="converting_to_black_and_white">
            <title>Converting to black and white</title>
            <topic xml:lang="en-us" id="overview.d12e16178">
               <title>Overview</title>
               <body>
                  <table frame="none">
                     <tgroup colsep="0" rowsep="0" cols="2">
                        <colspec colwidth="6*"/>
                        <colspec colwidth="4*"/>
                        
                        <tbody>
                           <row>
                              <entry>
              Black and white conversion can be achieved in several ways with darktable. Indeed,
              darktable comes with a lot of modules, especially for color manipulation. In this
              manual, I will show you 4 ways to perform a black and white conversion.
            </entry>
                              <entry>
                                 <image href="examples/images/blackandwhite.png"
                                        align="center"
                                        placement="break"/>
                              </entry>
                           </row>
                        </tbody>
                     </tgroup>
                  </table>
               </body>
               
            </topic>
            <topic xml:lang="en-us" id="theObviousWayMonochromeModule.d12e16210">
               <title>The obvious way: monochrome module</title>
               <body>
                  <p>
      To perform the conversion, just activate the <i>monochrome</i> module
      (<xref href="#monochrome"/>). You can then simulate a color filter, by dragging the
      circle above the colors you want to filter. Filter size can be modified via scrolling the
      mouse wheel.
    </p>
               </body>
               
            </topic>
            <topic xml:lang="en-us" id="theSimpleWayColorCorrectionModule.d12e16224">
               <title>The simple way: color correction module</title>
               <body>
                  <p>
      To perform such conversion we use the <i>color correction</i> module
      (<xref href="#color_correction"/>).
    </p>
                  <ol>
                     <li> Activate the color correction module </li>
                     <li> Use the bottom slider to set saturation to zero </li>
                  </ol>
               </body>
               
            </topic>
            <topic xml:lang="en-us" id="theLabWayColorContrastModule.d12e16249">
               <title>The LAB way: color contrast module</title>
               <body>
                  <p>
      To perform such conversion we use the <i>color contrast</i> module
      (<xref href="#color_contrast"/>).
    </p>
                  <ol>
                     <li> Activate the color contrast module </li>
                     <li> Set both steepness sliders to zero </li>
                  </ol>
               </body>
               
            </topic>
            <topic xml:lang="en-us" id="theArtisticWayColorZonesModule.d12e16274">
               <title>The artistic way: color zones module</title>
               <body>
                  <p>
      To perform the conversion we use the <i>color zone</i> module
      (<xref href="#color_zones"/>).
    </p>
                  <ol>
                     <li> Activate the color zones module </li>
                     <li> By default, the active tabbed control is set to <q>saturation</q> whereas
                        the <q>select by</q> combobox is set to <q>hue</q>. This means that color
                        are selected according to their hue (horizontal scale) and you can change
                        for each hue its <q>saturation</q> (vertical scale). You simply need to set
                        all points to the minimum of the vertical scale to de-saturate every hue. </li>
                     <li> But now if you want, you can keep some hues a little bit saturated, so
                        your image will be all black and white but some hue. A classical use for
                        portrait is to keep red hue saturated in order to make the lips standing
                        out. <p> You can also use one of the available presets that perform black
                           and white conversion, keeping some hues saturated. </p></li>
                  </ol>
               </body>
               
            </topic>
            <topic xml:lang="en-us" id="theSophisticatedWayChannelMixerModule.d12e16319">
               <title>The sophisticated way: channel mixer module</title>
               <body>
                  <p>
      To perform the conversion we use the <i>channel mixer</i> module
      (<xref href="#channel_mixer"/>).
    </p>
                  <ol>
                     <li> Activate the channel mixer module </li>
                     <li> Select the gray output channel </li>
                     <li> Set the proportion of each color, the sum having to equal 1 if you want to
                        keep your global lightness. </li>
                  </ol>
               </body>
               
            </topic>
         </topic>
         <topic xml:lang="en-us" id="cross_processing">
            <title>Cross-processing</title>
            <topic xml:lang="en-us" id="overview.d12e16354">
               <title>Overview</title>
               <body>
                  <table frame="none">
                     <tgroup colsep="0" rowsep="0" cols="2">
                        <colspec colwidth="6*"/>
                        <colspec colwidth="4*"/>
                        
                        <tbody>
                           <row>
                              <entry>
              Cross-processing is an analog processing technique where slide film (normally
              developed thanks to an E6 solution) is processed in chemicals used for processing
              print film (C41). The resulting images get skewed colors usually a cyan hue and
              increased contrast and saturation.
            </entry>
                              <entry>
                                 <image href="examples/images/crossprocessing.png"
                                        align="center"
                                        placement="break"/>
                              </entry>
                           </row>
                        </tbody>
                     </tgroup>
                  </table>
                  <p>
      The standard way for doing digital cross-processing is to use a channel curve tool but
      darktable lacks this tool for the moment and another way to accommodate the effect is
      used.
    </p>
               </body>
               
            </topic>
            <topic xml:lang="en-us" id="procedure.d12e16389">
               <title>Procedure</title>
               <body>
                  <p>
      This procedure uses tone curve, channel mixer and split-toning modules.
    </p>
                  <ol>
                     <li> Image preparation <p> Prepare the image for the cross process steps by
                           adjusting the base settings such as exposure, whitebalance etc. for a
                           correctly looking image. </p></li>
                     <li> Boost contrast <p> Select the medium contrast curve preset for <i>tone
                              curve</i> module (<xref href="#tone_curve"/>) to boost the overall
                           contrast in the image. You might later return here to tune the curve for
                           better result. </p></li>
                     <li> Color cast  This step changes the color cast as the base for the effect
                        using the <i>channel mixer</i> module (<xref href="#channel_mixer"/>). You
                        might later again return to this and finetune the colorcast of the final
                        result. <ol>
                           <li> Enable the channel mixer module </li>
                           <li> Select the blue channel and set the blue color value to 0.8 </li>
                           <li> Select the red channel and change the blue color value to 0.1 </li>
                           <li> Select the green channel and change the blue color value to 0.1
                           </li>
                        </ol></li>
                     <li> split-toning <p> We use <i>split-toning</i> (<xref href="#splittoning"/>)
                           to add some more coloring to the result for cyan/blue shadows and yellow
                           highlight. </p><ol>
                           <li> Enable the split-toning module </li>
                           <li> Select a cyan/blue tone for shadows and set saturation around 50% </li>
                           <li> Select a yellow/orange tone for highlights and set saturation around
                              70% </li>
                           <li> Set compression to 10% </li>
                           <li> Use the balance slider to tune the split-toning effect. This differs
                              on every image due to it's exposure, motive etc. </li>
                        </ol></li>
                  </ol>
               </body>
               
            </topic>
         </topic>
         <topic xml:lang="en-us" id="cyan_toned_images">
            <title>Cyan toned image</title>
            <topic xml:lang="en-us" id="overview.d12e16492">
               <title>Overview</title>
               <body>
                  <table frame="none">
                     <tgroup colsep="0" rowsep="0" cols="2">
                        <colspec colwidth="6*"/>
                        <colspec colwidth="4*"/>
                        
                        <tbody>
                           <row>
                              <entry>
              Cyan is a nice color touchup for black and white images, this example guides you
              through how to make this with darktable and how to control the tone. You can
              choose any tone of your like for this tutorial...
            </entry>
                              <entry>
                                 <image href="examples/images/cyantone.png"
                                        align="center"
                                        placement="break"/>
                              </entry>
                           </row>
                        </tbody>
                     </tgroup>
                  </table>
               </body>
               
            </topic>
            <topic xml:lang="en-us" id="procedure.d12e16524">
               <title>Procedure</title>
               <body>
                  <p>
      This procedure uses monochrome, channel mixer and split-toning modules.
    </p>
                  <ol>
                     <li> Image preparation <p> Prepare the image for the cyan toned steps by
                           adjusting the base settings such as exposure,black level, contrast etc.
                           for a correctly looking image. </p></li>
                     <li> Black and white <p> Enable the <i>monochrome</i> module (<xref
                              href="#monochrome"/>) to make the image black and white. </p></li>
                     <li> Add color tone <p> This step selects the base tone of the image using
                              <i>channel mixer</i> (<xref href="#channel_mixer"/>), we are going for
                           cyan tone but you can choose any tone that you like here. </p><ol>
                           <li> Enable the channel mixer module </li>
                           <li> Select the red channel destination and set the red color value to
                              0.7 </li>
                           <li> Select the green channel destination and set the green color value
                              to 1.15 </li>
                           <li> Select the blue channel destination and set the blue color value to
                              1.15 </li>
                        </ol><p> As you notice we mix blue and green color to get a cyan tone, we
                           substract 0.3 from the red channel and add them to blue and green.
                        </p></li>
                     <li> split-toning <p> The result of the previous step does also add a color
                           cast on highlights that we actually want to have white for a prettier
                           result. We also want to add some blue color cast to the shadows in order
                           to emphasis them. Module <i>split-toning</i> (<xref href="#splittoning"
                           />) can accomplish this. </p><ol>
                           <li> Enable the split-toning module </li>
                           <li> Select a blue/cyan tone for shadows and set saturation around 50% </li>
                           <li> Set highlights saturation to zero, to remove saturation on
                              highlights </li>
                           <li> Set compression to zero </li>
                           <li> Use the balance slider to tune the effect, our example uses a
                              balance of 70/30 </li>
                        </ol></li>
                  </ol>
               </body>
               
            </topic>
         </topic>
         <topic xml:lang="en-us" id="red_eyes">
            <title>Removal of red-eye effect</title>
            
            <prolog>
               <metadata><keywords>
                     <indexterm>red-eye removal</indexterm>
                  </keywords></metadata>
               
            </prolog>
            <topic xml:lang="en-us" id="overview.d12e16636">
               <title>Overview</title>
               <body>
                  <table frame="none">
                     <tgroup colsep="0" rowsep="0" cols="2">
                        <colspec colwidth="6*"/>
                        <colspec colwidth="4*"/>
                        
                        <tbody>
                           <row>
                              <entry>
                                 <p>
                The red-eye effect in photography is the common appearance of red pupils in
                color photographs of eyes. It occurs when using a photographic flash very close
                to the camera lens (as with most cameras with built-in flash), in ambient low
                light.
              </p>

                                 <p>
                We use the channel mixer module to reduce the red color of the pupil. To limit
                the processing to the pupils we have to apply two masks.
              </p>
                              </entry>
                              <entry>
                                 <image href="examples/images/red_eyes_01.png"
                                        align="center"
                                        placement="break"/>
                              </entry>
                           </row>
                        </tbody>
                     </tgroup>
                  </table>
               </body>
               
            </topic>
            <topic xml:lang="en-us" id="masking.d12e16674">
               <title>Masking</title>
               <body>
                  <table frame="none">
                     <tgroup colsep="0" rowsep="0" cols="2">
                        <colspec colnum="1" colname="col1" colwidth="6*"/>
                        <colspec colnum="2" colname="col2" colwidth="4*"/>
                        
                        <tbody>
                           <row>
                              <entry morerows="1">
                                 <ol>
                                    <li> Enable the channel mixer module (see <xref
                                          href="#channel_mixer"/>). </li>
                                    <li> Activate blending <p> Modules with blending support exhibit
                                          an additional combobox <q>blend</q> at the bottom of their
                                          GUI. Blending is activated with this combobox. Set value
                                          to <q>drawn mask</q>. Additional controls are displayed
                                          which allow you to draw a mask. </p></li>
                                    <li> Masking the pupil <p> Clicking the <image
                                             href="../images/shape_circle.png" align="center"/> symbol
                                          adds a circle shape. </p><p> Click into the canvas to
                                          place the circle. Left-click and drag the circle to the
                                          position of the first pupil. Use the scroll-wheel of your
                                          mouse while in the circle to change the diameter. Scroll
                                          within the circle border to minimize the width of the
                                          gradual decay. </p><p> Alternatively you can use an
                                          elliptical shape. See <xref href="#drawn_mask"/> for
                                          further details. </p></li>
                                    <li> Repeat step 3. <p> Clicking the <image
                                             href="../images/shape_circle.png" align="center"/> symbol
                                          adds another circle shape. </p><p> Mark the second pupil.
                                       </p></li>
                                 </ol>
                              </entry>
                              <entry>
                                 <image href="examples/images/red_eyes_02.png"
                                        align="center"
                                        placement="break"/>
                              </entry>
                           </row>
                           <row>
                              <entry colname="col2">
                                 <image href="examples/images/red_eyes_03.png"
                                        align="center"
                                        placement="break"/>
                              </entry>
                           </row>
                        </tbody>
                     </tgroup>
                  </table>
               </body>
               
            </topic>
            <topic xml:lang="en-us" id="desaturation.d12e16771">
               <title>Desaturation</title>
               <body>
                  <table frame="none">
                     <tgroup colsep="0" rowsep="0" cols="2">
                        <colspec colnum="1" colname="col1" colwidth="6*"/>
                        <colspec colnum="2" colname="col2" colwidth="4*"/>
                        
                        <tbody>
                           <row>
                              <entry morerows="1">
                                 <ol>
                                    <li> Approach - Modifying the output channel <q>red</q>. <ol>
                                          <li> Set output channel <q>destination</q> to <q>red</q>
                                             (default) </li>
                                          <li> Set red color value to 0.00 </li>
                                          <li> Set green color value to 0.50 </li>
                                          <li> Set blue color value to 0.50 </li>
                                       </ol><p> You are free to experiment what gives you the most
                                          realistic pupil, but this is a good starting point.
                                          Another proposal is 0.10/0.60/0.30. The sum of the three
                                          values should be 1. </p></li>
                                 </ol>
                              </entry>
                              <entry>
                                 <image href="examples/images/red_eyes_04.png"
                                        align="center"
                                        placement="break"/>
                              </entry>
                           </row>
                           <row>
                              <entry colname="col2">
                                 <image href="examples/images/red_eyes_05.png"
                                        align="center"
                                        placement="break"/>
                              </entry>
                           </row>
                        </tbody>
                     </tgroup>
                  </table>
                  <table frame="none">
                     <tgroup colsep="0" rowsep="0" cols="2">
                        <colspec colnum="1" colname="col1" colwidth="6*"/>
                        <colspec colnum="2" colname="col2" colwidth="4*"/>
                        
                        <tbody>
                           <row>
                              <entry morerows="1">
                                 <ol>
                                    <li> Approach - Modifying the output channel <q>gray</q>. <ol>
                                          <li> Set output channel <q>destination</q> to <q>gray</q>
                                          </li>
                                          <li> Set red color value to 0.24 </li>
                                          <li> Set green color value to 0.68 </li>
                                          <li> Set blue color value to 0.08 </li>
                                       </ol><p> You are free to experiment what gives you the most
                                          realistic pupil, but this is a good starting point. The
                                          sum of the three values should be 1. </p></li>
                                 </ol>
                              </entry>
                              <entry>
                                 <image href="examples/images/red_eyes_06.png"
                                        align="center"
                                        placement="break"/>
                              </entry>
                           </row>
                           <row>
                              <entry colname="col2">
                                 <image href="examples/images/red_eyes_07.png"
                                        align="center"
                                        placement="break"/>
                              </entry>
                           </row>
                        </tbody>
                     </tgroup>
                  </table>
               </body>
               
            </topic>
         </topic>
      </topic>
   </topic>
</dita>
